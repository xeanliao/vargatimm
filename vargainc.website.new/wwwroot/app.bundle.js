/*! For license information please see app.bundle.js.LICENSE.txt */
(self.webpackChunkvargainc_timm_website=self.webpackChunkvargainc_timm_website||[]).push([[143],{9522:(e,t,a)=>{"use strict";a.d(t,{Z:()=>y}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(1152)),l=a.n(o),i=a(6486),r=a(3609),c=a.n(r);function u(e,t,a){this.extend(u,google.maps.OverlayView),this.map_=e,this.markers_=[],this.clusters_=[],this.sizes=[53,56,66,78,90],this.styles_=[],this.ready_=!1;var n=a||{};this.gridSize_=n.gridSize||60,this.minClusterSize_=n.minimumClusterSize||2,this.maxZoom_=n.maxZoom||null,this.styles_=n.styles||[],this.imagePath_=n.imagePath||this.MARKER_CLUSTER_IMAGE_PATH_,this.imageExtension_=n.imageExtension||this.MARKER_CLUSTER_IMAGE_EXTENSION_,this.zoomOnClick_=!0,null!=n.zoomOnClick&&(this.zoomOnClick_=n.zoomOnClick),this.averageCenter_=!1,null!=n.averageCenter&&(this.averageCenter_=n.averageCenter),this.setupStyles_(),this.setMap(e),this.prevZoom_=this.map_.getZoom();var s=this;google.maps.event.addListener(this.map_,"zoom_changed",(function(){var e=s.map_.getZoom();s.prevZoom_!=e&&(s.prevZoom_=e,s.resetViewport())})),google.maps.event.addListener(this.map_,"idle",(function(){s.redraw()})),t&&t.length&&this.addMarkers(t,!1)}function m(e){this.markerClusterer_=e,this.map_=e.getMap(),this.gridSize_=e.getGridSize(),this.minClusterSize_=e.getMinClusterSize(),this.averageCenter_=e.isAverageCenter(),this.center_=null,this.markers_=[],this.bounds_=null,this.clusterIcon_=new p(this,e.getStyles(),e.getGridSize())}function p(e,t,a){e.getMarkerClusterer().extend(p,google.maps.OverlayView),this.styles_=t,this.padding_=a||0,this.cluster_=e,this.center_=null,this.map_=e.getMap(),this.div_=null,this.sums_=null,this.visible_=!1,this.setMap(this.map_)}a(2345),u.prototype.MARKER_CLUSTER_IMAGE_PATH_="../images/m",u.prototype.MARKER_CLUSTER_IMAGE_EXTENSION_="png",u.prototype.extend=function(e,t){return function(e){for(var t in e.prototype)this.prototype[t]=e.prototype[t];return this}.apply(e,[t])},u.prototype.onAdd=function(){this.setReady_(!0)},u.prototype.draw=function(){},u.prototype.setupStyles_=function(){if(!this.styles_.length)for(var e,t=0;e=this.sizes[t];t++)this.styles_.push({url:this.imagePath_+(t+1)+"."+this.imageExtension_,height:e,width:e})},u.prototype.fitMapToMarkers=function(){for(var e,t=this.getMarkers(),a=new google.maps.LatLngBounds,n=0;e=t[n];n++)a.extend(e.getPosition());this.map_.fitBounds(a)},u.prototype.setStyles=function(e){this.styles_=e},u.prototype.getStyles=function(){return this.styles_},u.prototype.isZoomOnClick=function(){return this.zoomOnClick_},u.prototype.isAverageCenter=function(){return this.averageCenter_},u.prototype.getMarkers=function(){return this.markers_},u.prototype.getTotalMarkers=function(){return this.markers_.length},u.prototype.setMaxZoom=function(e){this.maxZoom_=e},u.prototype.getMaxZoom=function(){return this.maxZoom_},u.prototype.calculator_=function(e,t){for(var a=0,n=e.length,s=n;0!==s;)s=parseInt(s/10,10),a++;return{text:n,index:a=Math.min(a,t)}},u.prototype.setCalculator=function(e){this.calculator_=e},u.prototype.getCalculator=function(){return this.calculator_},u.prototype.addMarkers=function(e,t){for(var a,n=0;a=e[n];n++)this.pushMarkerTo_(a);t||this.redraw()},u.prototype.pushMarkerTo_=function(e){if(e.isAdded=!1,e.draggable){var t=this;google.maps.event.addListener(e,"dragend",(function(){e.isAdded=!1,t.repaint()}))}this.markers_.push(e)},u.prototype.addMarker=function(e,t){this.pushMarkerTo_(e),t||this.redraw()},u.prototype.removeMarker_=function(e){var t=-1;if(this.markers_.indexOf)t=this.markers_.indexOf(e);else for(var a,n=0;a=this.markers_[n];n++)if(a==e){t=n;break}return-1!=t&&(e.setMap(null),this.markers_.splice(t,1),!0)},u.prototype.removeMarker=function(e,t){var a=this.removeMarker_(e);return!(t||!a||(this.resetViewport(),this.redraw(),0))},u.prototype.removeMarkers=function(e,t){for(var a,n=!1,s=0;a=e[s];s++){var o=this.removeMarker_(a);n=n||o}if(!t&&n)return this.resetViewport(),this.redraw(),!0},u.prototype.setReady_=function(e){this.ready_||(this.ready_=e,this.createClusters_())},u.prototype.getTotalClusters=function(){return this.clusters_.length},u.prototype.getMap=function(){return this.map_},u.prototype.setMap=function(e){this.map_=e},u.prototype.getGridSize=function(){return this.gridSize_},u.prototype.setGridSize=function(e){this.gridSize_=e},u.prototype.getMinClusterSize=function(){return this.minClusterSize_},u.prototype.setMinClusterSize=function(e){this.minClusterSize_=e},u.prototype.getExtendedBounds=function(e){var t=this.getProjection(),a=new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()),n=new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()),s=t.fromLatLngToDivPixel(a);s.x+=this.gridSize_,s.y-=this.gridSize_;var o=t.fromLatLngToDivPixel(n);o.x-=this.gridSize_,o.y+=this.gridSize_;var l=t.fromDivPixelToLatLng(s),i=t.fromDivPixelToLatLng(o);return e.extend(l),e.extend(i),e},u.prototype.isMarkerInBounds_=function(e,t){return t.contains(e.getPosition())},u.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers_=[]},u.prototype.resetViewport=function(e){for(var t,a=0;t=this.clusters_[a];a++)t.remove();var n;for(a=0;n=this.markers_[a];a++)n.isAdded=!1,e&&n.setMap(null);this.clusters_=[]},u.prototype.repaint=function(){var e=this.clusters_.slice();this.clusters_.length=0,this.resetViewport(),this.redraw(),window.setTimeout((function(){for(var t,a=0;t=e[a];a++)t.remove()}),0)},u.prototype.redraw=function(){this.createClusters_()},u.prototype.distanceBetweenPoints_=function(e,t){if(!e||!t)return 0;var a=(t.lat()-e.lat())*Math.PI/180,n=(t.lng()-e.lng())*Math.PI/180,s=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(t.lat()*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2);return 2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371},u.prototype.addToClosestCluster_=function(e){for(var t,a=4e4,n=null,s=(e.getPosition(),0);t=this.clusters_[s];s++){var o=t.getCenter();if(o){var l=this.distanceBetweenPoints_(o,e.getPosition());l<a&&(a=l,n=t)}}n&&n.isMarkerInClusterBounds(e)?n.addMarker(e):((t=new m(this)).addMarker(e),this.clusters_.push(t))},u.prototype.createClusters_=function(){if(this.ready_)for(var e,t=new google.maps.LatLngBounds(this.map_.getBounds().getSouthWest(),this.map_.getBounds().getNorthEast()),a=this.getExtendedBounds(t),n=0;e=this.markers_[n];n++)!e.isAdded&&this.isMarkerInBounds_(e,a)&&this.addToClosestCluster_(e)},m.prototype.isMarkerAlreadyAdded=function(e){if(this.markers_.indexOf)return-1!=this.markers_.indexOf(e);for(var t,a=0;t=this.markers_[a];a++)if(t==e)return!0;return!1},m.prototype.addMarker=function(e){if(this.isMarkerAlreadyAdded(e))return!1;if(this.center_){if(this.averageCenter_){var t=this.markers_.length+1,a=(this.center_.lat()*(t-1)+e.getPosition().lat())/t,n=(this.center_.lng()*(t-1)+e.getPosition().lng())/t;this.center_=new google.maps.LatLng(a,n),this.calculateBounds_()}}else this.center_=e.getPosition(),this.calculateBounds_();e.isAdded=!0,this.markers_.push(e);var s=this.markers_.length;if(s<this.minClusterSize_&&e.getMap()!=this.map_&&e.setMap(this.map_),s==this.minClusterSize_)for(var o=0;o<s;o++)this.markers_[o].setMap(null);return s>=this.minClusterSize_&&e.setMap(null),this.updateIcon(),!0},m.prototype.getMarkerClusterer=function(){return this.markerClusterer_},m.prototype.getBounds=function(){for(var e,t=new google.maps.LatLngBounds(this.center_,this.center_),a=this.getMarkers(),n=0;e=a[n];n++)t.extend(e.getPosition());return t},m.prototype.remove=function(){this.clusterIcon_.remove(),this.markers_.length=0,delete this.markers_},m.prototype.getSize=function(){return this.markers_.length},m.prototype.getMarkers=function(){return this.markers_},m.prototype.getCenter=function(){return this.center_},m.prototype.calculateBounds_=function(){var e=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(e)},m.prototype.isMarkerInClusterBounds=function(e){return this.bounds_.contains(e.getPosition())},m.prototype.getMap=function(){return this.map_},m.prototype.updateIcon=function(){var e=this.map_.getZoom(),t=this.markerClusterer_.getMaxZoom();if(t&&e>t)for(var a,n=0;a=this.markers_[n];n++)a.setMap(this.map_);else if(this.markers_.length<this.minClusterSize_)this.clusterIcon_.hide();else{var s=this.markerClusterer_.getStyles().length,o=this.markerClusterer_.getCalculator()(this.markers_,s);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.setSums(o),this.clusterIcon_.show()}},p.prototype.triggerClusterClick=function(e){var t=this.cluster_.getMarkerClusterer();google.maps.event.trigger(t,"clusterclick",this.cluster_,e),t.isZoomOnClick()&&this.map_.fitBounds(this.cluster_.getBounds())},p.prototype.onAdd=function(){if(this.div_=document.createElement("DIV"),this.visible_){var e=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(e),this.div_.innerHTML=this.sums_.text}this.getPanes().overlayMouseTarget.appendChild(this.div_);var t=this,a=!1;google.maps.event.addDomListener(this.div_,"click",(function(e){a||t.triggerClusterClick(e)})),google.maps.event.addDomListener(this.div_,"mousedown",(function(){a=!1})),google.maps.event.addDomListener(this.div_,"mousemove",(function(){a=!0}))},p.prototype.getPosFromLatLng_=function(e){var t=this.getProjection().fromLatLngToDivPixel(e);return"object"==typeof this.iconAnchor_&&2===this.iconAnchor_.length?(t.x-=this.iconAnchor_[0],t.y-=this.iconAnchor_[1]):(t.x-=parseInt(this.width_/2,10),t.y-=parseInt(this.height_/2,10)),t},p.prototype.draw=function(){if(this.visible_){var e=this.getPosFromLatLng_(this.center_);this.div_.style.top=e.y+"px",this.div_.style.left=e.x+"px"}},p.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},p.prototype.show=function(){if(this.div_){var e=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(e),this.div_.style.display=""}this.visible_=!0},p.prototype.remove=function(){this.setMap(null)},p.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),this.div_.parentNode.removeChild(this.div_),this.div_=null)},p.prototype.setSums=function(e){this.sums_=e,this.text_=e.text,this.index_=e.index,this.div_&&(this.div_.innerHTML=e.text),this.useStyle()},p.prototype.useStyle=function(){var e=Math.max(0,this.sums_.index-1);e=Math.min(this.styles_.length-1,e);var t=this.styles_[e];this.url_=t.url,this.height_=t.height,this.width_=t.width,this.textColor_=t.textColor,this.anchor_=t.anchor,this.textSize_=t.textSize,this.backgroundPosition_=t.backgroundPosition,this.iconAnchor_=t.iconAnchor},p.prototype.setCenter=function(e){this.center_=e},p.prototype.createCss=function(e){var t=[];t.push("background-image:url("+this.url_+");");var a=this.backgroundPosition_?this.backgroundPosition_:"0 0";t.push("background-position:"+a+";"),"object"==typeof this.anchor_?("number"==typeof this.anchor_[0]&&this.anchor_[0]>0&&this.anchor_[0]<this.height_?t.push("height:"+(this.height_-this.anchor_[0])+"px; padding-top:"+this.anchor_[0]+"px;"):"number"==typeof this.anchor_[0]&&this.anchor_[0]<0&&-this.anchor_[0]<this.height_?t.push("height:"+this.height_+"px; line-height:"+(this.height_+this.anchor_[0])+"px;"):t.push("height:"+this.height_+"px; line-height:"+this.height_+"px;"),"number"==typeof this.anchor_[1]&&this.anchor_[1]>0&&this.anchor_[1]<this.width_?t.push("width:"+(this.width_-this.anchor_[1])+"px; padding-left:"+this.anchor_[1]+"px;"):t.push("width:"+this.width_+"px; text-align:center;")):t.push("height:"+this.height_+"px; line-height:"+this.height_+"px; width:"+this.width_+"px; text-align:center;");var n=this.textColor_?this.textColor_:"black",s=this.textSize_?this.textSize_:11;return t.push("cursor:pointer; top:"+e.y+"px; left:"+e.x+"px; color:"+n+"; position:absolute; font-size:"+s+"px; font-family:Arial,sans-serif; font-weight:bold"),t.join("")},window.MarkerClusterer=u,u.prototype.addMarker=u.prototype.addMarker,u.prototype.addMarkers=u.prototype.addMarkers,u.prototype.clearMarkers=u.prototype.clearMarkers,u.prototype.fitMapToMarkers=u.prototype.fitMapToMarkers,u.prototype.getCalculator=u.prototype.getCalculator,u.prototype.getGridSize=u.prototype.getGridSize,u.prototype.getExtendedBounds=u.prototype.getExtendedBounds,u.prototype.getMap=u.prototype.getMap,u.prototype.getMarkers=u.prototype.getMarkers,u.prototype.getMaxZoom=u.prototype.getMaxZoom,u.prototype.getStyles=u.prototype.getStyles,u.prototype.getTotalClusters=u.prototype.getTotalClusters,u.prototype.getTotalMarkers=u.prototype.getTotalMarkers,u.prototype.redraw=u.prototype.redraw,u.prototype.removeMarker=u.prototype.removeMarker,u.prototype.removeMarkers=u.prototype.removeMarkers,u.prototype.resetViewport=u.prototype.resetViewport,u.prototype.repaint=u.prototype.repaint,u.prototype.setCalculator=u.prototype.setCalculator,u.prototype.setGridSize=u.prototype.setGridSize,u.prototype.setMaxZoom=u.prototype.setMaxZoom,u.prototype.onAdd=u.prototype.onAdd,u.prototype.draw=u.prototype.draw,m.prototype.getCenter=m.prototype.getCenter,m.prototype.getSize=m.prototype.getSize,m.prototype.getMarkers=m.prototype.getMarkers,p.prototype.onAdd=p.prototype.onAdd,p.prototype.draw=p.prototype.draw,p.prototype.onRemove=p.prototype.onRemove;const d=u;var h,g=a(8896),f=a(8300),v=null;const y=s().createBackboneClass({mixins:[g.Z,f.Z],getInitialState:function(){return{disableDefaultUI:!1,scrollwheel:!0,disableDoubleClickZoom:!1}},onWindowResize:function(){var e=c()(window).height()-c()(this.refs.mapArea).position().top;c()("#google-map").css({position:"relative",top:0,left:0,right:"auto",bottom:"auto",width:"100%",height:e}),google.maps.event.trigger(this.getGoogleMap(),"resize")},componentDidMount:function(){c()(window).on("resize",c().proxy(this.onWindowResize,this)),this.onWindowResize(),this.drawGtu();var e=this.getCollection(),t=(0,i.sortBy)(e.models,(function(e){var t=0;return e.get("HaveLocation")||(t+=1e7),e.get("IsAssign")&&(t+=1e6),parseInt(e.get("Id")),t})),a=(0,i.map)(t,(function(e){return{id:e.get("Id"),text:e.get("Code")}}));a=(0,i.concat)({id:-1,text:"Please select GTU to show on map"},a),c()("#gtuFilter").select2({placeholder:"Please input the GTU code to search",tags:!1,multiple:!1,data:a}),this.getGoogleMap(),c()("#gtuFilter").on("change",c().proxy((function(){var e=c()("#gtuFilter").val();e>0&&this.gotoMarker(parseInt(e))}),this)),h=new google.maps.InfoWindow},showGTUInfo:function(e){var t=this.getGoogleMap();h.setContent(this.buildContent(e.gtuId)),h.open(t,e)},gotoMarker:function(e){var t=this.getGoogleMap(),a=v.getMarkers(),n=(new google.maps.LatLngBounds,find(a,(function(t){return t.gtuId==e}))),s=this;console.log("search",e,n.gtuId,n.getPosition().lat(),n.getPosition().lng()),n?(t.setCenter(n.getPosition()),t.setZoom(22),setTimeout((function(){s.showGTUInfo(n)}),1e3)):this.alert("You searched GTU do not find the last position")},componentWillUnmount:function(){try{this.clearMap(),(0,i.each)(gtuLocation,(function(e){e.setMap(null)})),google.maps.event.clearInstanceListeners(googleMap)}catch(e){console.log("google map clear error",e)}c()("#google-map").css({visibility:"hidden"})},buildContent:function(e){var t=this.getCollection().get(e),a=s().createElement("ul",{className:"menu vertical"},s().createElement("li",null,s().createElement("h5",null,t.get("Code"))),s().createElement("li",null,"IsAssign: ",t.get("IsAssign")?"YES":"NO"),s().createElement("li",null,"IsOnline: ",t.get("IsOnline")?"YES":"NO"),s().createElement("li",{style:{display:t.get("IsAssign")?"inherit":"none"}},"Team: ",t.get("Company")),s().createElement("li",{style:{display:t.get("IsAssign")?"inherit":"none"}},"Auditor: ",t.get("Auditor")),s().createElement("li",{style:{display:t.get("IsAssign")?"inherit":"none"}},"Role: ",t.get("Role")));return l().renderToStaticMarkup(a)},drawGtu:function(){var e=this.getGoogleMap(),t=this.getCollection(),a=new google.maps.LatLngBounds,n=[],s=this;(0,i.each)(t.models,(function(e){if(e.get("HaveLocation")){var t=new google.maps.LatLng(e.get("Latitude"),e.get("Longitude"));a.extend(t);var o=new google.maps.Marker({position:t});o.gtuId=e.get("Id"),o.addListener("click",(function(){s.showGTUInfo(o)})),n.push(o)}})),v=new d(e,n),e.fitBounds(a)},render:function(){return s().createElement("div",null,s().createElement("div",{className:"section row"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"section-header"},s().createElement("div",{className:"small-10 small-centered columns"},s().createElement("select",{id:"gtuFilter"}))))),s().createElement("div",{ref:"mapArea"}))}})},7434:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var n=a(7588),s=a.n(n);const o=s().createClass({displayName:"dashboard",render:function(){return s().createElement("div",{className:"section row"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"section-header"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 column"},s().createElement("h5",null,"Administration")),s().createElement("div",{className:"small-12 column"},s().createElement("nav",{"aria-label":"You are here:",role:"navigation"},s().createElement("ul",{className:"breadcrumbs"},s().createElement("li",null,s().createElement("a",{href:"#"},"Control Center")),s().createElement("li",null,s().createElement("span",{className:"show-for-sr"},"Current: ")," Administration"))))))),s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"row",style:{marginTop:"120px"}},s().createElement("div",{className:"small-7 small-centered"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 column"},s().createElement("div",{className:"callout secondary"},s().createElement("a",{href:"#frame/Users.aspx"},s().createElement("span",null,"User Management")))),s().createElement("div",{className:"small-12 column"},s().createElement("div",{className:"callout secondary"},s().createElement("a",{href:"#campaign/import"},s().createElement("span",null,"Import Campaign"))))),s().createElement("div",{className:"row small-up-2 medium-up-2 large-up-2"},s().createElement("div",{className:"column"},s().createElement("div",{className:"callout secondary"},s().createElement("a",{href:"#frame/NonDeliverables.aspx"},s().createElement("span",null,"Non-Deliverables")))),s().createElement("div",{className:"column"},s().createElement("div",{className:"callout secondary"},s().createElement("a",{href:"#frame/GtuAdmin.aspx?AssignNameToGTUFlag=true"},s().createElement("span",null,"GTU Management")))),s().createElement("div",{className:"column"},s().createElement("div",{className:"callout secondary"},s().createElement("a",{href:"#admin/gtu"},s().createElement("span",null,"GTU Available List")))),s().createElement("div",{className:"column"},s().createElement("div",{className:"callout secondary"},s().createElement("a",{href:"#frame/AdminGtuToBag.aspx"},s().createElement("span",null,"GTU bag Management ")))),s().createElement("div",{className:"column"},s().createElement("div",{className:"callout secondary"},s().createElement("a",{href:"#frame/AdminGtuBagToAuditor.aspx"},s().createElement("span",null,"Assign GTU-Bags to Auditors")))),s().createElement("div",{className:"column"},s().createElement("div",{className:"callout secondary"},s().createElement("a",{href:"#frame/AdminDistributorCompany.aspx"},s().createElement("span",null,"Distributor Management")))))))))}})},8896:(e,t,a)=>{"use strict";a.d(t,{Z:()=>h});var n=a(2316),s=a.n(n),o=a(7588),l=a.n(o),i=a(3360),r=a.n(i),c=a(6624),u=a.n(c),m=a(6486),p=a(3609),d=a.n(p);a(9690);const h={getDefaultProps:function(){return{registeredTopic:{},registeredEvents:[]}},on:function(e,t,a){d()("body").on(e,t,a),this.props.registeredEvents.push(e)},subscribe:function(e){var t,a=(t=2==arguments.length&&(0,m.isString)(arguments[0])&&(0,m.isFunction)(arguments[1])?{channel:"View",topic:arguments[0],callback:arguments[1]}:(0,m.assign)({channel:"View",topic:"undefined"},e)).channel+".*/-+-*."+t.topic;this.props.registeredTopic[a]&&this.props.registeredTopic[a].unsubscribe();var n=r().subscribe(t);this.props.registeredTopic[a]=n},unsubscribe:function(e){var t="View.*/-+-*."+e;this.props.registeredTopic[t]&&(this.props.registeredTopic[t].unsubscribe(),(0,m.unset)(this.props.registeredTopic,t))},publish:function(){var e;e=1==arguments.length&&(0,m.isString)(arguments[0])?{channel:"View",topic:arguments[0],data:null}:4==arguments.length&&(0,m.isString)(arguments[0])&&(0,m.isFunction)(arguments[1])&&arguments[2]instanceof s().Model&&(0,m.isObject)(arguments[3])?{channel:"View",topic:arguments[0],data:{view:arguments[1],params:{model:arguments[2]},options:arguments[3]}}:4==arguments.length&&(0,m.isString)(arguments[0])&&(0,m.isFunction)(arguments[1])&&arguments[2]instanceof s().Collection&&(0,m.isObject)(arguments[3])?{channel:"View",topic:arguments[0],data:{view:arguments[1],params:{collection:arguments[2]},options:arguments[3]}}:3==arguments.length&&(0,m.isString)(arguments[0])&&(0,m.isFunction)(arguments[1])&&arguments[2]instanceof s().Model?{channel:"View",topic:arguments[0],data:{view:arguments[1],params:{model:arguments[2]}}}:3==arguments.length&&(0,m.isString)(arguments[0])&&(0,m.isFunction)(arguments[1])&&arguments[2]instanceof s().Collection?{channel:"View",topic:arguments[0],data:{view:arguments[1],params:{collection:arguments[2]}}}:2==arguments.length&&(0,m.isString)(arguments[0])&&(0,m.isFunction)(arguments[1])?{channel:"View",topic:arguments[0],data:{view:arguments[1]}}:arguments.length>1&&!(0,m.isFunction)(arguments[0])?{channel:"View",topic:arguments[0],data:arguments[1]}:arguments[0],r().publish((0,m.assign)({channel:"View",topic:"undefined"},e))},componentWillUnmount:function(){(0,m.each)(this.props.registeredTopic,(function(e){e.unsubscribe()})),(0,m.each)(this.props.registeredEvents,(function(e){d()("body").off(e)}))},scrollTop:function(e){d()(".off-canvas-wrapper-inner").stop().animate({scrollTop:d()(e).offset().top},600)},confirm:function(e){var t=this;return new(u())((function(a,n){var s=function(){t.publish("showDialogModal"),n(new Error("user cancel"))};(0,m.isString)(e)&&(e=(e=e.replace("\r","").split("\n")).map((function(e){return l().createElement("p",null,e)})));var o=l().createElement("div",{className:"row"},l().createElement("div",{className:"small-12 columns"},l().createElement("p",null," "),l().createElement("h5",null,e),l().createElement("p",null," ")),l().createElement("div",{className:"small-12 columns"},l().createElement("div",{className:"button-group float-right"},l().createElement("a",{href:"javascript:;",className:"button success tiny",onClick:function(){t.publish("showDialogModal"),a()}},"Okay")),l().createElement("div",{className:"button-group float-right"},l().createElement("a",{href:"javascript:;",className:"button tiny",onClick:s},"Cancel"))),l().createElement("button",{onClick:s,className:"close-button","data-close":!0,"aria-label":"Close reveal",type:"button"},l().createElement("span",{"aria-hidden":"true"},"×")));t.publish("showDialogModal",{view:o})}))},alert:function(e){var t=this;(0,m.isString)(e)&&(e=(e=e.replace("\r","").split("\n")).map((function(e){return l().createElement("p",null,e)})));var a=function(){t.publish("showDialogModal")},n=l().createElement("div",{className:"row"},l().createElement("div",{className:"small-12 columns"},l().createElement("p",null," "),l().createElement("h5",null,e),l().createElement("p",null," ")),l().createElement("div",{className:"small-12 columns"},l().createElement("div",{className:"button-group float-right"},l().createElement("a",{href:"javascript:;",className:"button tiny",onClick:a},"Okay"))),l().createElement("button",{onClick:a,className:"close-button","data-close":!0,"aria-label":"Close reveal",type:"button"},l().createElement("span",{"aria-hidden":"true"},"×")));this.publish("showDialogModal",{view:n})}}},2413:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(3609)),l=a.n(o),i=a(6486),r=a(8896);const c=s().createBackboneClass({mixins:[r.Z],onSearch:function(){var e="//timm.vargainc.com/"+this.refs.sourceUrl.value+"/api/campaign";if(_.isEmpty(e))this.alert("Please input source url");else{var t=this,a=this.getCollection();a.reset(),l().ajax({url:e,method:"GET",dataType:"json",cache:!1,success:function(n){var s=(0,i.map)(n,(function(e){return{Id:e.Id,ClientName:e.ClientName,ClientCode:e.ClientCode,Date:e.Date,AreaDescription:e.AreaDescription}}));(0,i.isEmpty)(s)&&(a.add(s),t.setState({srcUrl:e}))}})}},onImportFailed:function(){this.alert("copy campaign failed. please contact us!")},onImport:function(e){console.log(e);var t=(0,i.trimEnd)(this.state.srcUrl,"/")+"/"+e+"/export",a=this;l().getJSON(t).then((function(e){return l().post("../api/campaign/import",e).then((function(e){return e&&e.success?(a.alert("copy success. please refresh control center!"),Promise.resolve()):Promise.reject(new Error("server method failed"))}))})).catch((function(){a.onImportFailed()}))},render:function(){var e=this;return s().createElement("div",{className:"section row"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"section-header"},s().createElement("div",{className:"row","data-equalizer":!0},s().createElement("div",{className:"small-12 column"},s().createElement("h5",null,"Import Campaign")),s().createElement("div",{className:"small-8 column"},s().createElement("nav",{"aria-label":"You are here:",role:"navigation"},s().createElement("ul",{className:"breadcrumbs"},s().createElement("li",null,s().createElement("a",{href:"#"},"Control Center")),s().createElement("li",null,s().createElement("span",{className:"show-for-sr"},"Current: ")," Import Campaign")))),s().createElement("div",{className:"small-12 column"},s().createElement("div",{className:"input-group"},s().createElement("input",{ref:"sourceUrl",className:"input-group-field",type:"text",placeholder:"Please input server address and query campaign from this server."}),s().createElement("div",{className:"input-group-button"},s().createElement("input",{onClick:this.onSearch,type:"button",className:"button",value:"Query"})))))),s().createElement("div",{className:"scroll-list-section-body"},s().createElement("div",{className:"row scroll-list-header"},s().createElement("div",{className:"small-2 columns"},"ClientName"),s().createElement("div",{className:"small-4 columns"},"ClientCode"),s().createElement("div",{className:"small-2 columns"},"Date"),s().createElement("div",{className:"small-2 columns"},"AreaDescription"),s().createElement("div",{className:"small-2 columns"},"Action")),this.getCollection().map((function(t){return s().createElement("div",{key:t.get("Id"),className:"row scroll-list-item"},s().createElement("div",{className:"small-2 columns"},t.get("ClientName")),s().createElement("div",{className:"small-4 columns"},t.get("ClientCode")),s().createElement("div",{className:"small-2 columns"},moment(t.get("Date"),moment.ISO_8601).format("MMM DD, YYYY")),s().createElement("div",{className:"small-2 columns"},t.get("AreaDescription")),s().createElement("div",{className:"small-2 columns"},s().createElement("button",{class:"button",onClick:e.onImport.bind(e,t.get("Id"))},"Import")))})))))}})},4018:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(381)),l=a.n(o),i=a(6486),r=a(3609),c=a.n(r),u=a(8896);a(1167);const m=s().createBackboneClass({mixins:[u.Z],componentDidMount:function(){var e=this,t=this.getModel();t.get("Date")||t.set("Date",new Date),$(".fdatepicker").fdatepicker({format:"yyyy-mm-dd"}).on("changeDate",(function(t){e.getModel().set("Date",t.date)})),$("form").foundation()},onSave:function(e){e.preventDefault(),e.stopPropagation();var t=this;this.getModel().save(null,{success:function(e,a){a&&a.success?(t.publish("camapign/refresh"),t.onClose()):t.setState({error:"opps! something wrong. please contact us!"})},error:function(){t.setState({error:"opps! something wrong. please contact us!"})}})},onClose:function(){$(".fdatepicker").off("changeDate").fdatepicker("remove"),this.publish("showDialog")},onChange:function(e){this.getModel().set(e.currentTarget.name,e.currentTarget.value)},render:function(){var e=this.getModel(),t=e.get("Id")?"Edit Campaign":"New Campaign",a=e.get("AreaDescription"),n=e.get("Date"),o=n?l()(n).format("YYYY-MM-DD"):"",i=!(!this.state||!this.state.error),r=i?this.state.error:"";return s().createElement("form",{"data-abide":!0,onSubmit:this.onSave},s().createElement("h3",null,t),s().createElement("div",{"data-abide-error":!0,className:"alert callout",style:{display:i?"block":"none"}},s().createElement("p",null,s().createElement("i",{className:"fa fa-exclamation-circle"})," ",r)),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Client Name",s().createElement("input",{onChange:this.onChange,name:"ClientName",type:"text",defaultValue:e.get("ClientName"),required:!0}),s().createElement("span",{className:"form-error"},"it is required."))),s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Contact Name",s().createElement("input",{onChange:this.onChange,name:"ContactName",type:"text",defaultValue:e.get("ContactName"),required:!0}))),s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Client Code",s().createElement("input",{onChange:this.onChange,name:"ClientCode",type:"text",defaultValue:e.get("ClientCode"),required:!0}))),s().createElement("fieldset",{className:"small-12 columns"},s().createElement("label",null,"Total Type"),s().createElement("input",{type:"radio",onChange:this.onChange,name:"AreaDescription",checked:"APT + HOME"==a,value:"APT + HOME",id:"apthome"}),s().createElement("label",{htmlFor:"apthome"},"APT + HOME"),s().createElement("input",{type:"radio",onChange:this.onChange,name:"AreaDescription",checked:"APT ONLY"==a,value:"APT ONLY",id:"aptonly"}),s().createElement("label",{htmlFor:"aptonly"},"APT ONLY"),s().createElement("input",{type:"radio",onChange:this.onChange,name:"AreaDescription",checked:"HOME ONLY"==a,value:"HOME ONLY",id:"homeonly"}),s().createElement("label",{htmlFor:"homeonly"},"HOME ONLY")),s().createElement("div",{className:"small-12 medium-12 large-4 columns end"},s().createElement("label",null,"Date",s().createElement("input",{className:"fdatepicker",onChange:this.onChange,name:"Date",type:"date",readOnly:!0,value:o,required:!0})))),s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"button-group float-right"},s().createElement("button",{type:"submit",className:"success button"},"Save"),s().createElement("a",{href:"javascript:;",className:"button",onClick:this.onClose},"Cancel"))),s().createElement("button",{onClick:this.onClose,className:"close-button","data-close":!0,"aria-label":"Close reveal",type:"button"},s().createElement("span",{"aria-hidden":"true"},"×")))}});var p=a(4179);const d=s().createBackboneClass({mixins:[u.Z],onUserSelected:function(e){this.setState({selectedUser:e})},onDbUserSelected:function(e){this.setState({selectedUser:e}),this.publish("campaign/publish",e)},onClose:function(){this.publish("showDialog")},onProcess:function(){this.state&&this.state.selectedUser&&this.publish("campaign/publish",this.state.selectedUser)},render:function(){return s().createElement("div",null,s().createElement("h5",null,"Campaign Publish"),s().createElement("span",null,"Assign to"),s().createElement(p.Z,{onSelect:this.onUserSelected,onDbSelect:this.onDbUserSelected,group:"distribution"}),s().createElement("div",{className:"float-right"},s().createElement("button",{className:"success button",onClick:this.onProcess},"Okay"),s().createElement("a",{href:"javascript:;",className:"button",onClick:this.onClose},"Cancel")))}}),h=s().createBackboneClass({mixins:[u.Z],menuKey:"campaign-menu-ddl-",getDefaultProps:function(){return{address:null,icon:null,name:null}},componentDidMount:function(){c()("#"+this.menuKey+this.getModel().get("Id")).foundation()},onCopy:function(e){e.preventDefault(),e.stopPropagation(),c()(e.currentTarget).closest(".dropdown-pane").foundation("close");var t=this.getModel();t.copy().then((function(e){if(e&&e.success){var a=new Model(e.data);t.collection.add(a,{at:0})}}))},onEdit:function(e){e.preventDefault(),e.stopPropagation(),c()(e.currentTarget).closest(".dropdown-pane").foundation("close");var t=this.getModel().clone(),a=s().createElement(m,{model:t});this.publish("showDialog",{view:a})},onDelete:function(e){e.preventDefault(),e.stopPropagation(),c()(e.currentTarget).closest(".dropdown-pane").foundation("close");var t=this;this.confirm("are you sure want delete this campaign?").then((function(){t.getModel().destroy({wait:!0,success:function(){t.publish("camapign/refresh")}})}))},onPublishToDMap:function(e){e.preventDefault(),e.stopPropagation();var t=this.getModel(),a=this;a.publish("showDialog",{view:s().createElement(d,null)}),this.unsubscribe("campaign/publish"),this.subscribe("campaign/publish",(function(e){t.publishToDMap(e).then((function(e){a.publish("showDialog"),e&&e.success?a.publish("camapign/refresh"):a.alert(e.error)}))}))},onOpenMoreMenu:function(e){e.preventDefault(),e.stopPropagation()},onCloseMoreMenu:function(e,t){t.preventDefault(),t.stopPropagation(),c()("#"+this.menuKey+e).foundation("close")},renderMoreMenu:function(e){var t=this.menuKey+e;return s().createElement("span",null,s().createElement("button",{className:"button cirle","data-toggle":t,onClick:this.onOpenMoreMenu},s().createElement("i",{className:"fa fa-ellipsis-h"})),s().createElement("div",{id:t,className:"dropdown-pane bottom","data-dropdown":!0,"data-close-on-click":"true","data-auto-focus":"false",onClick:this.onCloseMoreMenu.bind(null,e)},s().createElement("ul",{className:"vertical menu"},s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onEdit},s().createElement("i",{className:"fa fa-edit"}),s().createElement("span",null,"Edit"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onCopy},s().createElement("i",{className:"fa fa-copy"}),s().createElement("span",null,"Copy"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onDelete},s().createElement("i",{className:"fa fa-trash"}),s().createElement("span",null,"Delete"))))))},onGotoCMap:function(e){window.location.hash="frame/campaign.aspx?cid="+e},render:function(){var e=this.getModel(),t=e.get("Date"),a=t?l()(t).format("MMM DD, YYYY"):"";return s().createElement("div",{className:"row scroll-list-item",onClick:this.onGotoCMap.bind(null,e.get("Id"))},s().createElement("div",{className:"hide-for-small-only medium-2 columns"},e.get("ClientName")),s().createElement("div",{className:"small-12 medium-5 columns"},e.get("ClientCode")),s().createElement("div",{className:"hide-for-small-only medium-2 columns"},a),s().createElement("div",{className:"small-12 medium-3 columns"},s().createElement("span",{className:"show-for-large"},e.get("AreaDescription")),s().createElement("div",{className:"float-right tool-bar"},s().createElement("button",{onClick:this.onPublishToDMap,className:"button"},s().createElement("i",{className:"fa fa-upload"}),s().createElement("small",null,"Publish")),this.renderMoreMenu(e.get("Id")))))}});var g=a(1149);const f=s().createBackboneClass({mixins:[u.Z],getInitialState:function(){return{orderByFiled:null,orderByAsc:!1,search:null,filterField:null,filterValues:[]}},componentDidMount:function(){var e=this;this.subscribe("camapign/refresh",(function(){e.getCollection().fetch()})),this.subscribe("search",(function(t){e.setState({search:t,filterField:null,filterValues:[]})})),c()("#campaign-filter-ddl-ClientName, #campaign-filter-ddl-ClientCode, #campaign-filter-ddl-Date, #campaign-filter-ddl-AreaDescription").foundation()},onNew:function(){var e=new g.Z,t=s().createElement(m,{model:e});this.publish("showDialog",{view:t})},onOrderBy:function(e,t){t.preventDefault(),t.stopPropagation(),this.state.orderByFiled==e?this.setState({orderByAsc:!this.state.orderByAsc}):this.setState({orderByFiled:e,orderByAsc:!0})},onFilter:function(e,t){t.preventDefault(),t.stopPropagation();var a=c()(":checked",t.currentTarget),n=(0,i.map)(a,(function(e){return c()(e).val()}));this.setState({filterField:n.length>0?e:null,filterValues:n.length>0?n:[],search:null}),c()("#campaign-filter-ddl-"+e).foundation("close")},onClearFilter:function(e,t){t.preventDefault(),t.stopPropagation(),this.setState({filterField:null,filterValues:[],search:null}),c()("#campaign-filter-ddl-"+e).foundation("close"),c()(t.currentTarget).closest("form").get(0).reset()},renderHeader:function(e,t){var a=this.getCollection(),n=null,o=null,r=null;if(a=a?a.toArray():[],n=this.state.orderByFiled==e?this.state.orderByAsc?s().createElement("i",{className:"fa fa-sort-up active"}):s().createElement("i",{className:"fa fa-sort-down active"}):s().createElement("i",{className:"fa fa-sort"}),n=s().createElement("a",{onClick:this.onOrderBy.bind(null,e)}," ",n),this.state.filterField&&this.state.filterField==e&&(o=s().createElement("a",{"data-toggle":"campaign-filter-ddl-"+e}," ",s().createElement("i",{className:"fa fa-filter active"}))),a){var c=(0,i.map)(a,(function(t){var a=t.get(e),n=l()(a,l().ISO_8601);return n.isValid()?n.format("MMM DD, YYYY"):a})),u=(0,i.uniq)(c).sort();r=s().createElement("div",{id:"campaign-filter-ddl-"+e,className:"dropdown-pane bottom",style:{width:"auto"},"data-dropdown":!0,"data-close-on-click":"true","data-auto-focus":"false"},s().createElement("form",{onSubmit:this.onFilter.bind(this,e)},s().createElement("ul",{className:"vertical menu"},u.map((function(t,a){return s().createElement("li",{key:e+a},s().createElement("input",{id:e+a,name:e,type:"checkbox",value:t}),s().createElement("label",{htmlFor:e+a},t))}))),s().createElement("button",{className:"button tiny success",type:"submit"},"Filter"),s().createElement("button",{className:"button tiny warning",type:"reset",onClick:this.onClearFilter.bind(this,e)},"Clear")))}return s().createElement("div",null,s().createElement("a",{"data-toggle":"campaign-filter-ddl-"+e},t),n,o,r)},getDataSource:function(){var e=this.getCollection();if(e=e?e.toArray():[],this.state.orderByFiled&&(e=(0,i.orderBy)(e,["attributes."+this.state.orderByFiled],[this.state.orderByAsc?"asc":"desc"])),this.state.search){var t=this.state.search.toLowerCase(),a=null;e=(0,i.filter)(e,(function(e){return a=(0,i.values)(e.attributes),(0,i.some)(a,(function(e){var a=l()(e,l().ISO_8601);return a.isValid()?a.format("MMM DD YYYY MMM DD, YYYY YYYY-MM-DD MM/DD/YYYY YYYY MM MMM DD").toLowerCase().indexOf(t)>-1:(0,i.toString)(e).toLowerCase().indexOf(t)>-1}))}))}else if(this.state.filterField&&this.state.filterValues){var n=this.state.filterField,s=this.state.filterValues;e=(0,i.filter)(e,(function(e){var t=e.get(n),a=l()(t,l().ISO_8601);return a.isValid()?(0,i.indexOf)(s,a.format("MMM DD, YYYY"))>-1:(0,i.indexOf)(s,t)>-1}))}return e},render:function(){var e=this.getDataSource();return s().createElement("div",{className:"section row"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"section-header"},s().createElement("div",{className:"row","data-equalizer":!0},s().createElement("div",{className:"small-12 column"},s().createElement("h5",null,"Campaign")),s().createElement("div",{className:"small-8 column"},s().createElement("nav",{"aria-label":"You are here:",role:"navigation"},s().createElement("ul",{className:"breadcrumbs"},s().createElement("li",null,s().createElement("a",{href:"#"},"Control Center")),s().createElement("li",null,s().createElement("span",{className:"show-for-sr"},"Current: ")," Campaign")))),s().createElement("div",{className:"small-4 column"},s().createElement("button",{onClick:this.onNew,className:"float-right section-button"},s().createElement("i",{className:"fa fa-plus"}),s().createElement("span",null,"New Campaign"))))),s().createElement("div",{className:"scroll-list-section-body"},s().createElement("div",{className:"row scroll-list-header"},s().createElement("div",{className:"hide-for-small-only medium-2 columns"},this.renderHeader("ClientName","Client Name")),s().createElement("div",{className:"small-12 medium-5 columns"},this.renderHeader("ClientCode","Client Code")),s().createElement("div",{className:"hide-for-small-only medium-2 columns"},this.renderHeader("Date","Date")),s().createElement("div",{className:"small-12 medium-3 columns"},s().createElement("span",{className:"show-for-large"},this.renderHeader("AreaDescription","Type")))),e.map((function(e){return s().createElement(h,{key:e.get("Id"),model:e})})))))}})},7269:(e,t,a)=>{"use strict";a.d(t,{Z:()=>C}),a(2316);var n=a(7588),s=a.n(n),o=(a(1152),a(456),a(9483),a(6624)),l=a.n(o),i=(a(4042),a(3664),a(4167),a(3609)),r=a.n(i),c=a(4184),u=a.n(c),m=a(6486),p=(a(2345),a(8552)),d=a(1859),h=a(6079),g=a(189),f=a(594),v=(a(5724),a(8896)),y=a(8742),E=a(3821),b=a(9147),M=a(5556),N=a(6779);const C=s().createBackboneClass({mixins:[v.Z],getInitialState:function(){return{activeTask:null,displayGtus:[],showOutOfBoundaryGtu:!0,displayMode:"cover",showAllDMap:!1,mergeTasks:[]}},componentDidMount:function(){var e=this,t=this;this.subscribe("Map.Popup.SetActiveTask",(function(e){var a=t.getModel(),n=a&&a.get("Tasks");if(n&&n.size&&n.size()>0){var s=(0,m.find)(n.models,(function(t){return t.get("Id")==e}));s&&t.onSwitchActiveTask.call(t,s)}})),this.subscribe("Map.Popup.MergeTask",(function(e){var a=t.getModel(),n=a&&a.get("Tasks");if(n&&n.size&&n.size()>0){var s=(0,m.find)(n.models,(function(t){return t.get("Id")==e}));s&&(t.state.mergeTasks.push(s),t.onMergeTask.call(t,s))}})),this.subscribe("Map.Popup.AbortMergeTask",(function(){t.setState({mergeTasks:[]},(function(){t.publish("Campaign.Monitor.DrawGtu",{tasks:[],displayGtus:[],displayMode:t.state.displayMode}),t.publish("Campaign.Monitor.ShowAllDMap",t.state.showAllDMap),t.publish("Campaign.Monitor.ShowOutOfBoundaryGtu",t.state.showOutOfBoundaryGtu)}))})),this.subscribe("Map.Popup.ConfirmMergeTask",(function(e){var a=t.getModel();if((e=a&&a.get("Tasks"))&&e.size&&2==t.state.mergeTasks.length){var n=(0,m.head)(t.state.mergeTasks),s=(0,m.last)(t.state.mergeTasks);s.mergeFrom(n.get("Id")).then((function(){t.state.mergeTasks=[],t.state.mergeTasks.push(s),t.onMergeTask.call(t,s)}))}})),this.subscribe("GTU.Assigned",(function(){e.publish("Campaign.Monitor.Reload")})),this.on("click.import.task",".btnImportTask",(function(e){e.preventDefault(),e.stopPropagation();var t=r()(this).attr("id");r()("#upload-file-"+t).click()})),this.subscribe("Map.GTU.Update",(function(){t.forceUpdate()})),this.subscribe("Global.Window.Click",(function(){t.onCloseDropDown(),t.onCloseMoreMenu()}))},initSelect2:function(e){var t=this;e&&(r()(e).select2(),r()(document).on("select2:select",(function(e){var a=(0,m.get)(e,"params.data.id"),n=t.getModel().get("Tasks");if(n.get){var s=n.get(a);t.onSwitchActiveTask.call(t,s)}})))},showTask:function(e){this.publish("Campaign.Monitor.ZoomToTask",e)},loadTask:function(e){var t=new d.Z({CampaignId:e.get("CampaignId"),SubMapId:e.get("SubMapId"),DMapId:e.get("DMapId"),Gtu:[]}),a=t.updateGtuAfterTime(null,{quite:!1}),n=new p.Z,s=n.fetchGtuWithStatusByTask(e.get("Id"),{quite:!1}).then((function(){return n.fetchGtuLocation(e.get("Id"),{quite:!1})}));return l().all([a,s]).then((function(){return e.set("dmap",t),e.set("gtuList",n),l().resolve()}))},onSwitchActiveTask:function(e){var t=this;this.loadTask(e).then((function(){return new(l())((function(a,n){var s=e.get("dmap").get("Gtu")||[];s=(0,m.map)(s,(function(e){return e.points&&e.points.length>0?e.points[0].Id:null})),t.setState({activeTask:e,displayGtus:s,displayMode:"cover"},(function(){return t.publish("Campaign.Monitor.ZoomToTask",e.get("Id")),t.publish("Campaign.Monitor.DrawGtu",{tasks:[e],displayGtus:s,displayMode:"cover"}),t.publish("Campaign.Monitor.ShowAllDMap",t.state.showAllDMap),r()(window).trigger("resize"),a()}))}))}))},onMergeTask:function(){var e=this,t=this;return l().all((0,m.map)(this.state.mergeTasks,(function(e){return t.loadTask(e)}))).then((function(){var a=[];return(0,m.each)(t.state.mergeTasks,(function(e){var t=e.get("dmap").get("Gtu");(0,m.each)(t,(function(e){e.points&&e.points.length>0&&a.push(e.points[0].Id)}))})),t.publish("Campaign.Monitor.DrawGtu",{tasks:e.state.mergeTasks,displayGtus:a,displayMode:"cover"}),t.publish("Campaign.Monitor.ShowAllDMap",!0),t.publish("Campaign.Monitor.ShowOutOfBoundaryGtu",!0),r()(window).trigger("resize"),l().resolve()}))},onOpenDropDown:function(e){e&&e.preventDefault(),e&&e.stopPropagation(),this.setState({taskDropdownActive:!0})},onCloseDropDown:function(e){e&&e.preventDefault(),e&&e.stopPropagation(),this.setState({taskDropdownActive:!1})},onOpenMoreMenu:function(e){e&&e.preventDefault(),e&&e.stopPropagation(),this.setState({taskMoreMenuActive:!0})},onCloseMoreMenu:function(e){e&&e.preventDefault(),e&&e.stopPropagation(),this.setState({taskMoreMenuActive:!1})},onStart:function(e){e.setStart()},onStop:function(e){e.setStop()},onPause:function(e){e.setPause()},onSwitchDisplayMode:function(e){var t=this;if(this.setState({displayMode:e},(function(){t.publish("Campaign.Monitor.DisplayMode",e)})),"marker"!=e){var a=[(0,m.head)(this.state.displayGtus)];this.setState({displayGtus:a},(function(){t.publish("Campaign.Monitor.SwitchGtu",a)}))}},onSwitchShowOutOfBoundaryGtu:function(){var e=this,t=!this.state.showOutOfBoundaryGtu;this.setState({showOutOfBoundaryGtu:t},(function(){e.publish("Campaign.Monitor.ShowOutOfBoundaryGtu",t)}))},onSwitchShowAllDMap:function(e){var t=this;this.setState({showAllDMap:e},(function(){t.publish("Campaign.Monitor.ShowAllDMap",e)}))},onAddEmployee:function(){var e=new h.Z,t=this;e.fetchCompany().done((function(){t.publish("showDialog",{view:E.Z,params:{model:new g.Z,company:e}})}))},onAssign:function(){var e=this.state.activeTask.get("gtuList"),t=this.state.activeTask.get("Id"),a=new h.Z,n=this;a.fetchForGtu().then((function(){n.publish("showDialog",{view:y.Z,params:{collection:e,user:a,taskId:t},options:{size:"full"}})}))},onReCenter:function(){this.publish("Campaign.Monitor.CenterToTask")},onReload:function(){this.publish("Campaign.Monitor.Reload")},onGotoGTU:function(e){this.publish("Campaign.Monitor.LocatGtu",e)},onSelectedGTU:function(e){var t,a=this;t="track"==this.state.displayMode?[e]:(0,m.xor)(this.state.displayGtus,[e]),this.setState({displayGtus:t},(function(){a.publish("Campaign.Monitor.SwitchGtu",t)}))},onFinished:function(e){var t=this;new f.Z({Id:e}).markFinished({success:function(a){if(a&&a.success){var n=t.getModel().get("Tasks");if(n){var s=n.get(e);s&&s.set("IsFinished",!0),t.forceUpdate(),t.publish("Campaign.Monitor.Redraw.FinishedTaskBoundary",e)}}else t.alert(a.error)}})},onEdit:function(e,t){var a=new f.Z({Id:e}),n=this;a.fetch().then((function(){n.publish("showDialog",{view:b.Z,params:{model:a}})}))},onOpenUploadFile:function(e){r()("#upload-file-"+e).click()},onShowUrlForDriver:function(){var e=this.getModel().get("Id");this.alert("".concat(window.location.protocol,":").concat(window.location.port,"//").concat(window.location.host).concat(window.location.pathname,"#driver/").concat(e))},renderTaskDropdown:function(){var e=this,t=this.getModel(),a=t&&t.get("Tasks")?t.get("Tasks").models:[];a=(0,m.filter)(a,(function(e){return!e.get("IsFinished")}));var n=u()({"is-dropdown-submenu-parent":!0,"opens-left":!0,"is-active":this.state.taskDropdownActive}),o=u()({menu:!0,submenu:!0,"is-dropdown-submenu":!0,"first-sub":!0,vertical:!0,"js-dropdown-active":this.state.taskDropdownActive});return s().createElement("ul",{className:"dropdown menu float-right"},s().createElement("li",{className:n},s().createElement("a",{href:"javascript:;",onClick:this.onOpenDropDown},"Switch Active Task"),s().createElement("ul",{className:o,onClick:this.onCloseDropDown},(0,m.map)(a,(function(t){return s().createElement("li",{key:t.get("Id")},s().createElement("a",{href:"javascript:;",onClick:e.onSwitchActiveTask.bind(e,t)},t.get("Name")))})))))},renderActiveTask:function(){if(!this.state.activeTask)return null;var e=this,t=this.state.activeTask,a=t.get("IsFinished"),n=t.get("gtuList")||[];return n.where&&(n=n.where((function(e){return a?e.get("WithData"):e.get("IsAssign")||e.get("WithData")}))),s().createElement("div",{className:"map-toolbar"},s().createElement("div",{className:"section row gtu-monitor expanded"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"row expanded"},s().createElement("div",{className:"small-12 medium-5 large-3 columns"},this.renderTaskController(t)),s().createElement("div",{className:"small-12 medium-7 large-9 columns"},this.renderTaskMoreMenu(t),s().createElement("button",{className:"button float-right",onClick:this.onReCenter},s().createElement("i",{className:"fa fa-crosshairs"}),s().createElement("span",null,"Center")),s().createElement("button",{className:"button float-right",onClick:this.onReload},s().createElement("i",{className:"fa fa-refresh"}),s().createElement("span",null,"Refresh")))))),s().createElement("div",{className:"row gtu expanded"},s().createElement("div",{className:"small-12 columns"},(0,m.map)(n,(function(t){return e.renderGtu(t)})))))},renderGtu:function(e){var t=null,a=null,n="button text-left btn-gtu",o=1==this.state.activeTask.get("Status"),l=(0,m.indexOf)(this.state.displayGtus,e.get("Id"))>-1,i=null;if(o)i=s().createElement("i",{className:"fa fa-stop"});else switch(e.get("Role")){case"Driver":i=s().createElement("i",{className:"fa fa-truck"});break;case"Walker":i=s().createElement("i",{className:"fa fa-street-view"});break;default:i=null}return l&&(n+=" active"),o||e.get("IsOnline")||(n+=" offline"),!o&&e.get("IsOnline")&&e.get("OutOfBoundary")&&(t=s().createElement("i",{className:"fa fa-bell faa-ring animated alert"})),!o&&e.get("WithData")&&(a=s().createElement("i",{className:"fa fa-warning alert"})),s().createElement("span",{className:"group",key:e.get("Id")},s().createElement("button",{className:n,style:{backgroundColor:l?e.get("UserColor"):"transparent"},onClick:this.onSelectedGTU.bind(null,e.get("Id"))},a,s().createElement("span",null,e.get("ShortUniqueID")),t),s().createElement("button",{className:"button location text-center",onClick:this.onGotoGTU.bind(null,e.get("Id")),style:{backgroundColor:e.get("UserColor")}},i))},renderTaskController:function(e){var t=u()("button",{hide:e.get("IsFinished")});switch(e.get("Status")){case 0:return s().createElement("div",null,s().createElement("button",{className:"button",onClick:this.onPause.bind(this,e)},s().createElement("i",{className:"fa fa-pause"}),"Pause"),s().createElement("button",{className:"button",onClick:this.onStop.bind(this,e)},s().createElement("i",{className:"fa fa-stop"}),"Stop"),s().createElement("button",{className:t,onClick:this.onFinished.bind(this,e.get("Id"))},s().createElement("i",{className:"fa fa-check"}),"Finish"));case 1:return s().createElement("div",null,s().createElement("button",{className:t,onClick:this.onFinished.bind(this,e.get("Id"))},s().createElement("i",{className:"fa fa-check"}),"Finish"));case 2:return s().createElement("div",null,s().createElement("button",{className:"button",onClick:this.onStart.bind(this,e)},s().createElement("i",{className:"fa fa-play"}),"Start"),s().createElement("button",{className:"button",onClick:this.onStop.bind(this,e)},s().createElement("i",{className:"fa fa-stop"}),"Stop"),s().createElement("button",{className:t,onClick:this.onFinished.bind(this,e.get("Id"))},s().createElement("i",{className:"fa fa-check"}),"Finish"));default:return s().createElement("div",null,s().createElement("button",{className:"button",onClick:this.onStart.bind(this,e)},s().createElement("i",{className:"fa fa-play"}),"Start"),s().createElement("button",{className:"button",onClick:this.onFinished.bind(this,e.get("Id"))},s().createElement("i",{className:"fa fa-check"}),"Finish"))}},renderTaskMoreMenu:function(e){if(1==e.get("Status"))var t=null;else t=s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onAssign.bind(this,e)},s().createElement("i",{className:"fa fa-users"})," ",s().createElement("span",null,"Assign GTU")));var a=u()({"is-dropdown-submenu-parent":!0,"opens-left":!0,"is-active":this.state.taskMoreMenuActive}),n=u()({menu:!0,submenu:!0,"is-dropdown-submenu":!0,"first-sub":!0,vertical:!0,"js-dropdown-active":this.state.taskMoreMenuActive}),o=e.get("Id");return s().createElement("ul",{className:"dropdown menu float-right"},s().createElement("li",{className:a},s().createElement("button",{className:"button cirle","data-toggle":"monitor-more-menu",onClick:this.onOpenMoreMenu},s().createElement("i",{className:"fa fa-ellipsis-h"})),s().createElement("ul",{className:n,onClick:this.onCloseMoreMenu},t,s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onAddEmployee},s().createElement("i",{className:"fa fa-user-plus"})," ",s().createElement("span",null,"New Employee"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onEdit.bind(this,o)},s().createElement("i",{className:"fa fa-edit"})," ",s().createElement("span",null,"Edit"))),s().createElement("li",{className:this.state.showAllDMap?"hide":""},s().createElement("a",{href:"javascript:;",onClick:this.onSwitchShowAllDMap.bind(this,!0)},s().createElement("i",{className:"fa fa-th-large"})," ",s().createElement("span",null,"Show Other DMap"))),s().createElement("li",{className:this.state.showAllDMap?"":"hide"},s().createElement("a",{href:"javascript:;",onClick:this.onSwitchShowAllDMap.bind(this,!1)},s().createElement("i",{className:"fa fa-square-o"})," ",s().createElement("span",null,"Hide Other DMap"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onSwitchDisplayMode.bind(this,"cover")},s().createElement("i",{className:"fa fa-map"})," ",s().createElement("span",null,"Show Coverage"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onSwitchDisplayMode.bind(this,"track")},s().createElement("i",{className:"fa fa-map-o"})," ",s().createElement("span",null,"Track Path"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onSwitchShowOutOfBoundaryGtu},s().createElement("i",{className:this.state.ShowOutOfBoundaryGtu?"fa fa-expand":"fa fa-compress"})," ",s().createElement("span",null,this.state.ShowOutOfBoundaryGtu?"Hide Out of Bounds":"Show Out of Bounds"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onShowUrlForDriver},s().createElement("i",{className:"fa fa-external-link-square"})," ",s().createElement("span",null,"URL for driver"))))))},render:function(){var e=this.getModel(),t=e&&e.get("Tasks")?e.get("Tasks").models:[];return t=(0,m.filter)(t,(function(e){return!e.get("IsFinished")})),t=(0,m.map)(t,(function(e){return e.get("Id")})),s().createElement("div",{className:"campaign-monitor"},s().createElement("div",{className:"section row expanded"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"section-header"},s().createElement("div",{className:"row expanded"},s().createElement("div",{className:"small-10 column"},s().createElement("nav",{"aria-label":"You are here:",role:"navigation"},s().createElement("ul",{className:"breadcrumbs"},s().createElement("li",null,e.getDisplayName()),s().createElement("li",null,s().createElement("span",{className:"show-for-sr"},"Current: ")," ",this.state.activeTask?this.state.activeTask.get("Name"):null)))),s().createElement("div",{className:"small-2 column"},this.renderTaskDropdown()))))),this.renderActiveTask(),s().createElement(N.Z,{model:this.getModel(),geo:this.props.geo,onSwitchActiveTask:this.onSwitchActiveTask}),s().createElement(M.Z,{tasks:t}))}})},3709:(e,t,a)=>{"use strict";a.d(t,{Z:()=>b}),a(2316);var n=a(7588),s=a.n(n),o=(a(1152),a(456),a(9483),a(6624)),l=a.n(o),i=(a(4042),a(3664),a(4167),a(3609)),r=a.n(i),c=a(4184),u=a.n(c),m=a(6486),p=(a(2345),a(8552)),d=a(1859),h=a(6079),g=a(189),f=(a(594),a(5724),a(8896)),v=a(8742),y=a(3821),E=(a(9147),a(5556),a(6779));const b=s().createBackboneClass({mixins:[f.Z],getInitialState:function(){return{activeTask:null,displayGtus:[],showOutOfBoundaryGtu:!0,displayMode:"cover",showAllDMap:!1,mergeTasks:[]}},componentDidMount:function(){var e=this;this.subscribe("Map.Popup.SetActiveTask",(function(t){var a=e.getModel(),n=a&&a.get("Tasks");if(n&&n.size&&n.size()>0){var s=(0,m.find)(n.models,(function(e){return e.get("Id")==t}));s&&e.onSwitchActiveTask.call(e,s)}})),this.subscribe("Map.Popup.MergeTask",(function(t){var a=e.getModel(),n=a&&a.get("Tasks");if(n&&n.size&&n.size()>0){var s=(0,m.find)(n.models,(function(e){return e.get("Id")==t}));s&&(e.state.mergeTasks.push(s),e.onMergeTask.call(e,s))}})),this.subscribe("Map.Popup.AbortMergeTask",(function(){e.setState({mergeTasks:[]},(function(){e.publish("Campaign.Monitor.DrawGtu",{tasks:[],displayGtus:[],displayMode:e.state.displayMode}),e.publish("Campaign.Monitor.ShowAllDMap",e.state.showAllDMap),e.publish("Campaign.Monitor.ShowOutOfBoundaryGtu",e.state.showOutOfBoundaryGtu)}))})),this.subscribe("Map.Popup.ConfirmMergeTask",(function(t){var a=e.getModel();if((t=a&&a.get("Tasks"))&&t.size&&2==e.state.mergeTasks.length){var n=(0,m.head)(e.state.mergeTasks),s=(0,m.last)(e.state.mergeTasks);s.mergeFrom(n.get("Id")).then((function(){e.state.mergeTasks=[],e.state.mergeTasks.push(s),e.onMergeTask.call(e,s)}))}})),this.on("click.import.task",".btnImportTask",(function(e){e.preventDefault(),e.stopPropagation();var t=r()(this).attr("id");r()("#upload-file-"+t).click()})),this.subscribe("Map.GTU.Update",(function(){e.forceUpdate()})),this.subscribe("Global.Window.Click",(function(){e.onCloseDropDown(),e.onCloseMoreMenu()}))},initSelect2:function(e){var t=this;e&&(r()(e).select2(),r()(document).on("select2:select",(function(e){var a=(0,m.get)(e,"params.data.id"),n=t.getModel().get("Tasks");if(n.get){var s=n.get(a);t.onSwitchActiveTask.call(t,s)}})))},showTask:function(e){this.publish("Campaign.Monitor.ZoomToTask",e)},loadTask:function(e){var t=new d.Z({CampaignId:e.get("CampaignId"),SubMapId:e.get("SubMapId"),DMapId:e.get("DMapId"),Gtu:[]}),a=t.updateGtuAfterTime(null,{quite:!1}),n=new p.Z,s=n.fetchGtuWithStatusByTask(e.get("Id"),{quite:!1}).then((function(){return n.fetchGtuLocation(e.get("Id"),{quite:!1})}));return l().all([a,s]).then((function(){return e.set("dmap",t),e.set("gtuList",n),l().resolve()}))},onSwitchActiveTask:function(e){var t=this;this.loadTask(e).then((function(){return new(l())((function(a,n){var s=e.get("dmap").get("Gtu")||[];s=(0,m.map)(s,(function(e){return e.points&&e.points.length>0?e.points[0].Id:null})),t.setState({activeTask:e,displayGtus:s,displayMode:"cover"},(function(){return t.publish("Campaign.Monitor.ZoomToTask",e.get("Id")),t.publish("Campaign.Monitor.DrawGtu",{tasks:[e],displayGtus:s,displayMode:"cover"}),t.publish("Campaign.Monitor.ShowAllDMap",t.state.showAllDMap),r()(window).trigger("resize"),a()}))}))}))},onMergeTask:function(){var e=this,t=this;return l().all((0,m.map)(this.state.mergeTasks,(function(e){return t.loadTask(e)}))).then((function(){var a=[];return(0,m.each)(t.state.mergeTasks,(function(e){var t=e.get("dmap").get("Gtu");(0,m.each)(t,(function(e){e.points&&e.points.length>0&&a.push(e.points[0].Id)}))})),t.publish("Campaign.Monitor.DrawGtu",{tasks:e.state.mergeTasks,displayGtus:a,displayMode:"cover"}),t.publish("Campaign.Monitor.ShowAllDMap",!0),t.publish("Campaign.Monitor.ShowOutOfBoundaryGtu",!0),r()(window).trigger("resize"),l().resolve()}))},onOpenDropDown:function(e){e&&e.preventDefault(),e&&e.stopPropagation(),this.setState({taskDropdownActive:!0})},onCloseDropDown:function(e){e&&e.preventDefault(),e&&e.stopPropagation(),this.setState({taskDropdownActive:!1})},onOpenMoreMenu:function(e){e&&e.preventDefault(),e&&e.stopPropagation(),this.setState({taskMoreMenuActive:!0})},onCloseMoreMenu:function(e){e&&e.preventDefault(),e&&e.stopPropagation(),this.setState({taskMoreMenuActive:!1})},onStart:function(e){e.setStart()},onStop:function(e){e.setStop()},onPause:function(e){e.setPause()},onSwitchDisplayMode:function(e){var t=this;if(this.setState({displayMode:e},(function(){t.publish("Campaign.Monitor.DisplayMode",e)})),"marker"!=e){var a=[(0,m.head)(this.state.displayGtus)];this.setState({displayGtus:a},(function(){t.publish("Campaign.Monitor.SwitchGtu",a)}))}},onSwitchShowOutOfBoundaryGtu:function(){var e=this,t=!this.state.showOutOfBoundaryGtu;this.setState({showOutOfBoundaryGtu:t},(function(){e.publish("Campaign.Monitor.ShowOutOfBoundaryGtu",t)}))},onSwitchShowAllDMap:function(e){var t=this;this.setState({showAllDMap:e},(function(){t.publish("Campaign.Monitor.ShowAllDMap",e)}))},onAddEmployee:function(){var e=new h.Z,t=this;e.fetchCompany().done((function(){t.publish("showDialog",{view:y.Z,params:{model:new g.Z,company:e}})}))},onAssign:function(){var e=this.state.activeTask.get("gtu"),t=this.state.activeTask.get("Id"),a=new h.Z,n=this;a.fetchForGtu().then((function(){n.publish("showDialog",{view:v.Z,params:{collection:e,user:a,taskId:t},options:{size:"full"}})}))},onReCenter:function(){this.publish("Campaign.Monitor.CenterToTask")},onReload:function(){this.publish("Campaign.Monitor.Reload")},onGotoGTU:function(e){this.publish("Campaign.Monitor.LocatGtu",e)},onSelectedGTU:function(e){var t,a=this;t="track"==this.state.displayMode?[e]:(0,m.xor)(this.state.displayGtus,[e]),this.setState({displayGtus:t},(function(){a.publish("Campaign.Monitor.SwitchGtu",t)}))},renderTaskDropdown:function(){var e=this,t=this.getModel(),a=t&&t.get("Tasks")?t.get("Tasks").models:[];a=(0,m.filter)(a,(function(e){return!e.get("IsFinished")}));var n=u()({"is-dropdown-submenu-parent":!0,"opens-left":!0,"is-active":this.state.taskDropdownActive}),o=u()({menu:!0,submenu:!0,"is-dropdown-submenu":!0,"first-sub":!0,vertical:!0,"js-dropdown-active":this.state.taskDropdownActive});return s().createElement("ul",{className:"dropdown menu float-right"},s().createElement("li",{className:n},s().createElement("a",{href:"javascript:;",onClick:this.onOpenDropDown},"Switch Active Task"),s().createElement("ul",{className:o,onClick:this.onCloseDropDown},(0,m.map)(a,(function(t){return s().createElement("li",{key:t.get("Id")},s().createElement("a",{href:"javascript:;",onClick:e.onSwitchActiveTask.bind(e,t)},t.get("Name")))})))))},renderActiveTask:function(){if(!this.state.activeTask)return null;var e=this,t=this.state.activeTask,a=t.get("IsFinished"),n=t.get("gtuList")||[];return n.where&&(n=n.where((function(e){return a?e.get("WithData"):e.get("IsAssign")||e.get("WithData")}))),s().createElement("div",{className:"map-toolbar"},s().createElement("div",{className:"section row gtu-monitor expanded"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"row expanded"},s().createElement("div",{className:"small-12 columns"},this.renderTaskMoreMenu(t),s().createElement("button",{className:"button float-right",onClick:this.onReCenter},s().createElement("i",{className:"fa fa-crosshairs"}),s().createElement("span",null,"Center")),s().createElement("button",{className:"button float-right",onClick:this.onReload},s().createElement("i",{className:"fa fa-refresh"}),s().createElement("span",null,"Refresh")))))),s().createElement("div",{className:"row gtu expanded"},s().createElement("div",{className:"small-12 columns"},(0,m.map)(n,(function(t){return e.renderGtu(t)})))))},renderGtu:function(e){var t=null,a=null,n="button text-left btn-gtu",o=1==this.state.activeTask.get("Status"),l=(0,m.indexOf)(this.state.displayGtus,e.get("Id"))>-1,i=null;if(o)i=s().createElement("i",{className:"fa fa-stop"});else switch(e.get("Role")){case"Driver":i=s().createElement("i",{className:"fa fa-truck"});break;case"Walker":i=s().createElement("i",{className:"fa fa-street-view"});break;default:i=null}return l&&(n+=" active"),o||e.get("IsOnline")||(n+=" offline"),!o&&e.get("IsOnline")&&e.get("OutOfBoundary")&&(t=s().createElement("i",{className:"fa fa-bell faa-ring animated alert"})),!o&&e.get("WithData")&&(a=s().createElement("i",{className:"fa fa-warning alert"})),s().createElement("span",{className:"group",key:e.get("Id")},s().createElement("button",{className:n,style:{backgroundColor:l?e.get("UserColor"):"transparent"},onClick:this.onSelectedGTU.bind(null,e.get("Id"))},a,s().createElement("span",null,e.get("ShortUniqueID")),t),s().createElement("button",{className:"button location text-center",onClick:this.onGotoGTU.bind(null,e.get("Id")),style:{backgroundColor:e.get("UserColor")}},i))},renderTaskMoreMenu:function(e){var t=u()({"is-dropdown-submenu-parent":!0,"opens-left":!0,"is-active":this.state.taskMoreMenuActive}),a=u()({menu:!0,submenu:!0,"is-dropdown-submenu":!0,"first-sub":!0,vertical:!0,"js-dropdown-active":this.state.taskMoreMenuActive});return e.get("Id"),s().createElement("ul",{className:"dropdown menu float-right"},s().createElement("li",{className:t},s().createElement("button",{className:"button cirle","data-toggle":"monitor-more-menu",onClick:this.onOpenMoreMenu},s().createElement("i",{className:"fa fa-ellipsis-h"})),s().createElement("ul",{className:a,onClick:this.onCloseMoreMenu},s().createElement("li",{className:this.state.showAllDMap?"hide":""},s().createElement("a",{href:"javascript:;",onClick:this.onSwitchShowAllDMap.bind(this,!0)},s().createElement("i",{className:"fa fa-th-large"})," ",s().createElement("span",null,"Show Other DMap"))),s().createElement("li",{className:this.state.showAllDMap?"":"hide"},s().createElement("a",{href:"javascript:;",onClick:this.onSwitchShowAllDMap.bind(this,!1)},s().createElement("i",{className:"fa fa-square-o"})," ",s().createElement("span",null,"Hide Other DMap"))),s().createElement("li",{className:"".concat("cover"==this.state.displayMode?"hide":"")},s().createElement("a",{href:"javascript:;",onClick:this.onSwitchDisplayMode.bind(this,"cover")},s().createElement("i",{className:"fa fa-map"})," ",s().createElement("span",null,"Show Coverage"))),s().createElement("li",{className:"".concat("track"==this.state.displayMode?"hide":"")},s().createElement("a",{href:"javascript:;",onClick:this.onSwitchDisplayMode.bind(this,"track")},s().createElement("i",{className:"fa fa-map-o"})," ",s().createElement("span",null,"Track Path"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onSwitchShowOutOfBoundaryGtu},s().createElement("i",{className:this.state.ShowOutOfBoundaryGtu?"fa fa-expand":"fa fa-compress"})," ",s().createElement("span",null,this.state.ShowOutOfBoundaryGtu?"Hide Out of Bounds":"Show Out of Bounds"))))))},render:function(){var e=this.getModel(),t=e&&e.get("Tasks")?e.get("Tasks").models:[];return t=(0,m.filter)(t,(function(e){return!e.get("IsFinished")})),t=(0,m.map)(t,(function(e){return e.get("Id")})),s().createElement("div",{className:"campaign-monitor"},s().createElement("div",{className:"section row expanded"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"section-header"},s().createElement("div",{className:"row expanded"},s().createElement("div",{className:"small-10 column"},s().createElement("nav",{"aria-label":"You are here:",role:"navigation"},s().createElement("ul",{className:"breadcrumbs"},s().createElement("li",null,e.getDisplayName()),s().createElement("li",null,s().createElement("span",{className:"show-for-sr"},"Current: ")," ",this.state.activeTask?this.state.activeTask.get("Name"):null)))),s().createElement("div",{className:"small-2 column"},this.renderTaskDropdown()))))),this.renderActiveTask(),s().createElement(E.Z,{model:this.getModel(),geo:this.props.geo,onSwitchActiveTask:this.onSwitchActiveTask}))}})},5556:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l}),a(2316);var n=a(7588),s=a.n(n),o=(a(1152),a(456),a(6486));const l=s().createClass({displayName:"importFiles",shouldComponentUpdate:function(){return!1},onImport:function(e,t){t.bubbles=!1;var a=t.currentTarget.files[0];0!=a.size?new TaskModel({Id:e}).importGtu(a).then((function(){alert("import success")})):alert("please select an not empty file!")},render:function(){var e=this,t=this,a=this.props.tasks||[];return s().createElement("div",null,(0,o.map)(a,(function(a){return s().createElement("input",{key:"file-import-".concat(a),type:"file",id:"upload-file-".concat(a),multiple:!0,style:{display:"none"},onChange:t.onImport.bind(e,a)})})))}})},6779:(e,t,a)=>{"use strict";a.d(t,{Z:()=>b}),a(2316);var n=a(7588),s=a.n(n),o=a(1152),l=a.n(o),i=(a(456),a(9483),a(6624)),r=a.n(i),c=a(4042),u=a.n(c),m=a(3664),p=a.n(m),d=(a(4167),a(3609)),h=a.n(d),g=a(4184),f=a.n(g),v=a(6486),y=(a(2345),a(8552),a(1859),a(6079),a(189),a(594),a(5724),a(8896));a(8742),a(3821),a(9147);const E=s().createBackboneClass({mixins:[y.Z],getInitialState:function(){return{inputText:"",placeHolder:"Please input Address or Zip code here",activeItem:null,searchTimeout:null}},search:function(){clearTimeout(this.state.searchTimeout);var e=this;this.state.searchTimeout=setTimeout((function(){var t=(0,v.trim)(e.state.inputText);t.length>0&&(/^\d+$/.test(t)?e.getCollection().fetchByZipcode(t):e.getCollection().fetchByAddress(t)).then((function(t){e.publish("Campaign.Monitor.GeoResult",t)}))}),500)},onInputChange:function(e){var t=this;this.setState({inputText:e.target.value},(function(){t.search()}))},onInputKeyUp:function(e){var t=this.getCollection()||[];if(0!=t.length)switch(e.key){case"ArrowUp":var a=t.indexOf(this.state.activeItem);a--,a=Math.max(0,a),this.onSelectItem(t.at(a)),e.preventDefault(),e.stopPropagation();break;case"ArrowDown":a=t.indexOf(this.state.activeItem),a++,a=Math.min(a,t.length-1),this.onSelectItem(t.at(a)),e.preventDefault(),e.stopPropagation();break;case"Enter":var n;n=null==this.state.activeItem?t.at(0):this.state.activeItem,this.onSelectItem(n),e.preventDefault(),e.stopPropagation()}},onSelectItem:function(e,t){var a=this;if(e){var n=this;this.setState({activeItem:e,inputText:e.get("place")},(function(){a.publish("Campaign.Monitor.FlyToLocation",e.get("latlng")),(0,v.isFunction)(t)&&t.call(n)}))}},clearUp:function(){var e=this,t="";this.state.activeItem&&(t=this.state.activeItem.get("text")),this.setState({activeItem:null,inputText:"",placeHolder:t},(function(){e.getCollection().reset(),h()(window).focus(),e.publish("Campaign.Monitor.GeoResult",{type:"FeatureCollection",features:[]})}))},stopClearUp:function(e){e.preventDefault(),e.stopPropagation()},render:function(){var e=this,t=this.getCollection()||[],a=f()("geocode",{active:t.length>1});return s().createElement("div",{className:a,onKeyUp:this.onInputKeyUp,onClick:this.stopClearUp},s().createElement("input",{type:"text",value:this.state.inputText,onKeyUp:this.onInputKeyUp,onChange:this.onInputChange,placeholder:this.state.placeHolder}),s().createElement("ul",{className:"accordion"},t.map((function(t,a){var n=f()("accordion-item",{active:e.state.activeItem==t});return s().createElement("li",{key:t.get("id"),className:n,onClick:e.onSelectItem.bind(e,t)},s().createElement("i",{className:"fa fa-stop"}),s().createElement("span",null,a+1)," ",t.get("place"))}))))},componentWillUnmount:function(){h()(window).off("click.geo")},componentDidMount:function(){var e=this;h()(window).on("click.geo",(function(){e.clearUp()}))}}),b=s().createBackboneClass({mixins:[y.Z],shouldComponentUpdate:function(){return!1},getInitialState:function(){return{tasks:[],gtuMarkerLayer:{},gtuTrackLayer:{},gtuLocationLayer:null,displayGtus:[],showOutOfBoundaryGtu:!0,taskBounds:{},mapCache:{},animations:{},popup:null,gtuMarkerFilter:["all"],trackBeginTime:0,gtuCount:{},displayMode:"cover",showAllDMap:!1}},onInit:function(e){var t=this;u().accessToken="pk.eyJ1IjoiZ2hvc3R1eiIsImEiOiJjaXczc2tmc3cwMDEyMm9tb29pdDRwOXUzIn0.KPSiOO6DWTY59x1zHdvYSA";var a=new(u().Map)({container:e,zoom:8,maxZoom:20,center:[-73.987378,40.744556],style:"//timm.vargainc.com/map/street.json"});t.registerTopic(a);var n=new(u().NavigationControl);a.addControl(n,"top-right"),a.on("load",(function(){a.addSource("google-road-tiles",{type:"raster",tiles:["//mt0.google.com/vt/lyrs=m&x={x}&y={y}&z={z}","//mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}","//mt2.google.com/vt/lyrs=m&x={x}&y={y}&z={z}","//mt3.google.com/vt/lyrs=m&x={x}&y={y}&z={z}"],tileSize:256}),a.addSource("google-satellite-tiles",{type:"raster",tiles:["//mt0.google.com/vt/lyrs=y&x={x}&y={y}&z={z}","//mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}","//mt2.google.com/vt/lyrs=y&x={x}&y={y}&z={z}","//mt3.google.com/vt/lyrs=y&x={x}&y={y}&z={z}"],tileSize:256}),a.addLayer({id:"google-road-tiles-layer",type:"raster",source:"google-road-tiles",minzoom:0,maxzoom:21,layout:{visibility:"visible"}}),a.addLayer({id:"google-satellite-tiles-layer",type:"raster",source:"google-satellite-tiles",minzoom:0,maxzoom:21,layout:{visibility:"none"}}),t.setState({map:a,mapContainer:e},t.initMapLayer)}))},initMapLayer:function(){this.state.map,this.addGeoLayer(),this.drawBoundary(),requestAnimationFrame(this.animate),h()(window).trigger("resize")},registerTopic:function(e){var t=this;this.subscribe("Campaign.Monitor.GeoResult",(function(t){var a=e.getSource("geo-source");a&&a.setData(t)})),this.subscribe("Campaign.Monitor.ZoomToTask",(function(e){t.flyToTask(e)})),this.subscribe("Campaign.Monitor.FlyToLocation",(function(e){t.flyToLocation(e)})),this.subscribe("Campaign.Monitor.DrawGtu",(function(e){t.setState({tasks:e.tasks,displayGtus:e.displayGtus,displayMode:e.displayMode,trackBeginTime:null},(function(){t.drawGtu(),window.clearInterval(t.state.reloadTimeout),t.setState({reloadTimeout:window.setInterval(t.reload,1e4)})}))})),this.subscribe("Campaign.Monitor.DisplayMode",(function(e){t.setState({displayMode:e,trackBeginTime:null},(function(){"track"==e&&t.animateGtuPath()}))})),this.subscribe("Campaign.Monitor.ShowOutOfBoundaryGtu",(function(e){t.setState({showOutOfBoundaryGtu:e},(function(){t.setGtuPointsFilter()}))})),this.subscribe("Campaign.Monitor.ShowAllDMap",(function(e){t.setState({showAllDMap:e},(function(){t.setDMapFilter()}))})),this.subscribe("Campaign.Monitor.SwitchGtu",(function(e){t.setState({displayGtus:e,trackBeginTime:null},(function(){t.setGtuPointsFilter()}))})),this.subscribe("Campaign.Monitor.LocatGtu",(function(a){var n=e.getSource("GTU-LastLocation");n&&(0,v.each)(n._data.features,(function(n){if((0,v.get)(n,"properties.gtuId")==a)return e.flyTo({center:[n.geometry.coordinates[0],n.geometry.coordinates[1]]}),t.state.popup&&t.state.popup.remove(),t.state.popup=new(u().Popup)({closeButton:!0,anchor:"bottom",offset:15}).setLngLat([n.geometry.coordinates[0],n.geometry.coordinates[1]]).setHTML((0,v.get)(n,"properties.displayName")).addTo(e),!1}))})),this.subscribe("Campaign.Monitor.CenterToTask",(function(){t.flyToTask((0,v.head)(t.state.tasks).get("Id"),!0)})),this.subscribe("Campaign.Monitor.Reload",(function(){t.reload()})),this.subscribe("Campaign.Monitor.Redraw.FinishedTaskBoundary",(function(e){var a=t.state.map.getSource("boundary-dmap");if(a){var n=(0,v.map)(a._data.features,(function(t){if((0,v.get)(t,"properties.TaskId")==e){(0,v.set)(t,"properties.IsFinished",!0);var a=(0,v.get)(t,"properties.Task");(0,v.set)(a,"properties.Task.IsFinished",!0)}return t}));a.setData({type:"FeatureCollection",features:n})}t.setDMapFilter()})),this.subscribe("Global.Window.Resize",(function(a){if(t.state.mapContainer){h()(".mapbox-wrapper").width("".concat(a.width,"px"));var n=a.height-h()(".title-bar").outerHeight()-h()(".section-header").outerHeight()-h()(".map-toolbar").outerHeight()-10;h()(".mapbox-wrapper").height("".concat(n,"px")),e.resize()}})),this.on("click.map.popup",".btnSetActiveTask",(function(){var e=h()(this).attr("id");return t.publish("Map.Popup.SetActiveTask",e),t.state.popup&&t.state.popup.remove(),!1})),this.on("click.map.popup",".btnMergeTask",(function(){var e=h()(this).attr("id");return t.publish("Map.Popup.MergeTask",e),t.state.popup&&t.state.popup.remove(),!1})),this.on("click.map.popup",".btnAbortMergeTask",(function(){return t.publish("Map.Popup.AbortMergeTask"),t.state.popup&&t.state.popup.remove(),!1})),this.on("click.map.popup",".btnMergeTaskDone",(function(){return t.publish("Map.Popup.ConfirmMergeTask"),t.state.popup&&t.state.popup.remove(),!1})),e.on("click",(function(e){t.onTaskAreaClickHandler.call(t,e)}))},animate:function(e){var t=this.state.map;if(t){var a=this;e=parseInt(e),r().all((0,v.map)(this.state.animations,(function(n){return n.call(a,t,e)}))).then((function(){requestAnimationFrame(a.animate)}))}},addGeoLayer:function(){var e=this.state.map;e?(e.addSource("geo-source",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),e.addLayer({id:"geo-layer",source:"geo-source",type:"symbol",layout:{"icon-allow-overlap":!0,"icon-image":"za-provincial-2","icon-size":2,"text-field":"{serial}"},paint:{"text-color":"#ffffff"}})):console.error("map is not ready")},loadSubmapBoundary:function(e,t){return h().getJSON("../api/print/campaign/".concat(e,"/submap/").concat(t,"/boundary")).then((function(e){var t={type:"Feature",properties:{userColor:"rgb(".concat(e.color.r,", ").concat(e.color.g,", ").concat(e.color.b,")")},geometry:{type:"Polygon",coordinates:[(0,v.map)(e.boundary,(function(e){return[e.lng,e.lat]}))]}},a=p()(t);return a.properties=t.properties,r().resolve([t,a])}))},loadDMapBoundary:function(e){var t="../api/print/campaign/".concat(e.get("CampaignId"),"/submap/").concat(e.get("SubMapId"),"/dmap/").concat(e.get("DMapId"),"/boundary");return h().getJSON(t).then((function(t){var a={type:"Feature",properties:{userColor:"rgb(".concat(t.color.r,", ").concat(t.color.g,", ").concat(t.color.b,")"),Name:e.get("Name"),IsFinished:e.get("IsFinished"),TaskId:e.get("Id"),Task:e.toJSON()},geometry:{type:"Polygon",coordinates:[(0,v.map)(t.boundary,(function(e){return[e.lng,e.lat]}))]}},n=p()(a);return n.properties=a.properties,r().resolve([a,n])}))},drawBoundary:function(){var e=this.state.map;if(e){console.time("draw boundary"),this.publish("showLoading");var t=this,a=this.getModel(),n=a.get("Id"),s=a.get("Tasks"),o=(0,v.groupBy)(s.models,(function(e){return e.get("SubMapId")})),l=(0,v.keys)(o),i=new(u().LngLatBounds);return r().all([r().all((0,v.map)(l,(function(e){return t.loadSubmapBoundary(n,e)}))).then((function(t){var a=[];return(0,v.each)(t,(function(e){a.push(e[0]),a.push(e[1]),(0,v.each)(e[0].geometry.coordinates,(function(e){(0,v.each)(e,(function(e){i.extend([e[0],e[1]])}))}))})),e.addSource("boundary-submap",{type:"geojson",data:{type:"FeatureCollection",features:a}}),e.addLayer({id:"boundary-submap-layer",type:"line",source:"boundary-submap",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"black","line-width":{stops:[[10,1],[20,4]]}}}),r().resolve()})),r().all((0,v.map)(s.models,(function(e){return t.loadDMapBoundary(e)}))).then((function(t){var a=[];return(0,v.each)(t,(function(e){a.push(e[0]),a.push(e[1])})),e.addSource("boundary-dmap",{type:"geojson",data:{type:"FeatureCollection",features:a}}),e.addLayer({id:"boundary-dmap-finished-layer",type:"fill",filter:["all",["==","$type","Polygon"],["==","IsFinished",!0]],source:"boundary-dmap",paint:{"fill-pattern":"bg-red-x","fill-color":{property:"userColor",type:"identity"},"fill-opacity":.55}}),e.addLayer({id:"boundary-dmap-layer",type:"fill",filter:["all",["==","$type","Polygon"],["==","IsFinished",!1]],source:"boundary-dmap",paint:{"fill-color":{property:"userColor",type:"identity"},"fill-opacity":.25}}),e.addLayer({id:"boundary-dmap-line-layer",type:"line",filter:["==","$type","Polygon"],source:"boundary-dmap",paint:{"line-color":"black","line-width":{stops:[[10,1],[20,4]]},"line-opacity":.75}}),e.addLayer({id:"boundary-dmap-label-layer",type:"symbol",minzoom:12,filter:["==","$type","Point"],source:"boundary-dmap",layout:{"text-field":"{Name}","text-size":{stops:[[12,16],[20,36]]}},paint:{}}),e.addLayer({id:"boundary-dmap-merge-source-layer",type:"line",filter:["all",["==","$type","Polygon"]],source:"boundary-dmap",layout:{visibility:"none"},paint:{"line-color":" #3498db","line-width":6}}),e.addLayer({id:"boundary-dmap-merge-source-fill-layer",type:"fill",filter:["all",["==","$type","Polygon"]],source:"boundary-dmap",layout:{visibility:"none"},paint:{"fill-color":" #3498db","fill-opacity":.25}}),e.addLayer({id:"boundary-dmap-merge-target-layer",type:"line",filter:["all",["==","$type","Polygon"]],source:"boundary-dmap",layout:{visibility:"none"},paint:{"line-color":"#c0392b","line-width":6}}),e.addLayer({id:"boundary-dmap-merge-target-fill-layer",type:"fill",filter:["all",["==","$type","Polygon"]],source:"boundary-dmap",layout:{visibility:"none"},paint:{"fill-color":"#c0392b","fill-opacity":.25}}),r().resolve()}))]).then((function(){e.fitBounds(i),t.publish("hideLoading"),console.timeEnd("draw boundary")}))}console.error("map is not ready")},setDMapFilter:function(){var e=this.state.map;if(e){var t=(0,v.head)(this.state.tasks),a=t?t.get("Id"):null;!this.state.showAllDMap&&a?(e.setFilter("boundary-dmap-finished-layer",["all",["==","$type","Polygon"],["==","IsFinished",!0],["==","TaskId",a]]),e.setFilter("boundary-dmap-layer",["all",["==","$type","Polygon"],["==","IsFinished",!1],["==","TaskId",a]]),e.setFilter("boundary-dmap-line-layer",["all",["==","$type","Polygon"],["==","TaskId",a]]),e.setFilter("boundary-dmap-label-layer",["all",["==","$type","Point"],["==","TaskId",a]]),e.setLayoutProperty("boundary-submap-layer","visibility","none")):(e.setFilter("boundary-dmap-finished-layer",["all",["==","$type","Polygon"],["==","IsFinished",!0]]),e.setFilter("boundary-dmap-layer",["all",["==","$type","Polygon"],["==","IsFinished",!1]]),e.setFilter("boundary-dmap-line-layer",["all",["==","$type","Polygon"]]),e.setFilter("boundary-dmap-label-layer",["all",["==","$type","Point"]]),e.setLayoutProperty("boundary-submap-layer","visibility","visible"));var n=(0,v.map)(this.state.tasks,(function(e){return e.get("Id")}));n.length>1?(e.setFilter("boundary-dmap-finished-layer",["all",["==","$type","Polygon"],["==","IsFinished",!0],(0,v.concat)(["!in","TaskId"],n)]),(0,v.each)(["boundary-dmap-merge-source-layer","boundary-dmap-merge-source-fill-layer"],(function(t){e.setFilter(t,["all",["==","$type","Polygon"],["==","TaskId",n[0]]]),e.setLayoutProperty(t,"visibility","visible")})),(0,v.each)(["boundary-dmap-merge-target-layer","boundary-dmap-merge-target-fill-layer"],(function(t){e.setFilter(t,["all",["==","$type","Polygon"],["==","TaskId",n[1]]]),e.setLayoutProperty(t,"visibility","visible")}))):(e.setFilter("boundary-dmap-finished-layer",["all",["==","$type","Polygon"],["==","IsFinished",!0]]),(0,v.each)(["boundary-dmap-merge-source-layer","boundary-dmap-merge-source-fill-layer","boundary-dmap-merge-target-layer","boundary-dmap-merge-target-fill-layer"],(function(t){e.setLayoutProperty(t,"visibility","none")})))}else console.error("map is not ready")},buildTaskPopup:function(e){var t=this,a=null,n=null,o=null,i=e.IsFinished,r=(0,v.map)(t.state.tasks,(function(e){return e.get("Id")}));if(i)a=[s().createElement("span",{key:"finished"},"FINISHED")],o=0==t.state.tasks.length?s().createElement("div",{className:"small-7 small-centered columns"},s().createElement("div",{className:"button-group stacked-for-small",style:{marginTop:"20px"}},s().createElement("button",{id:e.Id,className:"button btnMergeTask"},"Merge From Here"))):1==t.state.tasks.length?(0,v.includes)(r,e.Id)?s().createElement("div",{className:"small-7 small-centered columns"},s().createElement("div",{className:"button-group stacked-for-small",style:{marginTop:"20px"}},s().createElement("button",{id:e.Id,className:"button btnAbortMergeTask"},"Abort Merge"))):s().createElement("div",{className:"small-10 small-centered columns"},s().createElement("div",{className:"button-group stacked-for-small",style:{marginTop:"20px"}},s().createElement("button",{id:e.Id,className:"button btnAbortMergeTask"},"Abort Merge"),s().createElement("button",{id:e.Id,className:"button btnMergeTask"},"Merge Preview"))):(0,v.includes)(r,e.Id)?s().createElement("div",{className:"small-10 small-centered columns"},s().createElement("div",{className:"button-group stacked-for-small",style:{marginTop:"20px"}},s().createElement("button",{id:e.Id,className:"button btnAbortMergeTask"},"Abort Merge"),s().createElement("button",{id:e.Id,className:"button btnMergeTaskDone"},"Confirm Merge"))):s().createElement("div",{className:"small-7 small-centered columns"},s().createElement("div",{className:"button-group stacked-for-small",style:{marginTop:"20px"}},s().createElement("button",{id:e.Id,className:"button btnAbortMergeTask"},"Abort Merge")));else switch(n=s().createElement("div",{className:"small-8 align-center columns"},s().createElement("div",{className:"button-group",style:{marginTop:"20px"}},s().createElement("button",{id:e.Id,className:"button btnSetActiveTask"},"GO"))),e.Status){case 0:a=[s().createElement("span",{key:"started"},"STARTED")];break;case 1:a=[s().createElement("span",{key:"stopped"},"STOPPED")];break;case 2:a=[s().createElement("span",{key:"peased"},"PEASED")];break;default:a=[s().createElement("span",{key:"started"},"NOT STARTED")]}var c=s().createElement("div",{className:"row align-center section",style:{minWidth:"320px"}},s().createElement("div",{className:"small-7 columns"},e.Name),s().createElement("div",{className:"small-5 columns text-right"},a),n,o);return l().renderToStaticMarkup(c)},onTaskAreaClickHandler:function(e){var t=this.state.map,a=(0,v.head)(t.queryRenderedFeatures(e.point,{layers:["boundary-dmap-layer","boundary-dmap-finished-layer","boundary-dmap-merge-source-fill-layer","boundary-dmap-merge-target-fill-layer"]}));if(a){var n=JSON.parse(a.properties.Task),s=this.buildTaskPopup(n);this.state.popup&&this.state.popup.remove(),this.state.popup=new(u().Popup)({closeButton:!1,anchor:"top"}).setLngLat(e.lngLat).setHTML(s).addTo(t)}},reload:function(){var e=this;if(this.state.tasks&&!this.state.reloading){var t=this;return new(r())((function(a,n){e.setState({reloading:!0},(function(){var e=[];(0,v.each)(t.state.tasks,(function(t){var a=t.get("dmap"),n=t.get("gtuList");e.push(a.updateGtuAfterTime(null,{quite:!0})),e.push(n.fetchGtuLocation(t.get("Id"),{quite:!0}))})),r().all(e).then((function(){t.publish("Map.GTU.Update"),t.setState({reloading:!1},(function(){return a()}))})).catch((function(){return n(new Error("unkown error in reload"))}))}))})).then((function(){return t.drawGtu(),r().resolve()}))}},drawGtu:function(){var e=this.state.map,t=this.state.tasks;if(e&&t){var a=[];(0,v.each)(t,(function(e){a=(0,v.concat)(a,e.get("dmap").get("Gtu"))})),this.drawGtuLocation(a),this.drawGtuPoints(a)}},drawGtuPoints:function(e){var t=this,a=this.state.map;if(a){var n={type:"FeatureCollection",features:[]};(0,v.each)(e,(function(e){(0,v.each)(e.points,(function(t,a){n.features.push({type:"Feature",properties:{userColor:e.color,GtuId:t.Id,Out:t.out,Serial:a},geometry:{type:"Point",coordinates:[t.lng,t.lat]}})})),t.state.gtuCount[e.points[0].Id]=e.points.length}));var s=a.getSource("gut-marker-source");null==s?(a.addSource("gut-marker-source",{type:"geojson",data:n}),a.addLayer({id:"gtu-marker-layer",type:"circle",source:"gut-marker-source",paint:{"circle-radius":{stops:[[4,2],[20,6]]},"circle-color":{property:"userColor",type:"identity"},"circle-stroke-width":1,"circle-stroke-color":"black"}},"GTU-LastLocation-Walker-Icon-Layer")):s.setData(n),this.setGtuPointsFilter()}},animateGtuPath:function(){var e=this;this.state.animations["gtu-marker-layer-animation"]=function(t,a){if(null!=this.state.trackBeginTime&&"cover"!=this.state.displayMode){var n=(0,v.clone)(this.state.gtuMarkerFilter),s=a-this.state.trackBeginTime,o=(0,v.head)(this.state.displayGtus),l=this.state.gtuCount[o]||0,i=parseInt(s/100);if(i>l)return n.push(["<=","Serial",l]),t.setFilter("gtu-marker-layer",n),void delete e.state.animations["gtu-marker-layer-animation"];n.push(["<","Serial",i%l]),t.setFilter("gtu-marker-layer",n)}else this.state.trackBeginTime=a}},setGtuPointsFilter:function(){var e=this.state.map,t=this;if(e){var a=["all"];this.state.showOutOfBoundaryGtu||a.push(["==","Out",!1]),a.push((0,v.concat)(["in","GtuId"],this.state.displayGtus)),this.setState({gtuMarkerFilter:a},(function(){"cover"==t.state.displayMode&&e.setFilter("gtu-marker-layer",a)}))}},drawGtuLocation:function(e){var t=this.state.map;if(t){var a=[];(0,v.each)(this.state.tasks,(function(e){e.get("gtuList").each((function(e){null!=e.get("Location")&&a.push(e)}))}));var n={type:"FeatureCollection",features:(0,v.map)(a,(function(e){var t=e.get("Location");return t&&t.lat&&t.lng?{type:"Feature",geometry:{type:"Point",coordinates:[t.lng,t.lat]},properties:{userColor:"#ff0000",role:e.get("Role"),gtuId:e.get("Id"),displayName:e.get("ShortUniqueID")}}:null}))},s=t.getSource("GTU-LastLocation");null==s?(t.addSource("GTU-LastLocation",{type:"geojson",data:n}),t.addLayer({filter:["all",["==","role","Walker"]],id:"GTU-LastLocation-Walker-Icon-Layer",source:"GTU-LastLocation",type:"symbol",layout:{"icon-image":"walker","icon-size":.75,"icon-offset":[-2,-25],"icon-allow-overlap":!0},paint:{}}),t.addLayer({filter:["all",["!=","role","Walker"]],id:"GTU-LastLocation-Trunk-Icon-Layer",source:"GTU-LastLocation",type:"symbol",layout:{"icon-image":"truck","icon-size":.75,"icon-offset":[-2,-25],"icon-allow-overlap":!0},paint:{}})):s.setData(n)}},flyToTask:function(e,t){var a=this.state.map;if(a){var n=a.getSource("boundary-dmap"),s=(0,v.head)((0,v.filter)(n._data.features,(function(t){return(0,v.get)(t,"properties.TaskId")==e&&"Polygon"==(0,v.get)(t,"geometry.type")})));if(s){var o=new(u().LngLatBounds);if((0,v.each)(s.geometry.coordinates,(function(e){(0,v.each)(e,(function(e){o.extend([e[0],e[1]])}))})),t){var l=a.getZoom();a.flyTo({center:o.getCenter(),zoom:l})}else a.fitBounds(o)}}},flyToLocation:function(e){var t=this.state.map;if(t){var a=t.getZoom();t.flyTo({center:e,zoom:a})}},clearTask:function(){(0,v.each)(gtuMarkerLayer,(function(e){e&&e.remove&&e.remove()})),this.setState({gtuMarkerLayer:[]})},switchMapStyle:function(e){var t=this.state.map;t&&("streets"==e?(t.setLayoutProperty("google-road-tiles-layer","visibility","visible"),t.setLayoutProperty("google-satellite-tiles-layer","visibility","none")):(t.setLayoutProperty("google-road-tiles-layer","visibility","none"),t.setLayoutProperty("google-satellite-tiles-layer","visibility","visible")))},render:function(){return s().createElement("div",{className:"mapbox-wrapper"},s().createElement("div",{className:"mapbox-container",ref:this.onInit,style:{width:"100%",height:"100%"}}),s().createElement("div",{className:"map-overlay"},s().createElement("div",{className:"mapboxgl-ctrl-top-left"},s().createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group"},s().createElement("button",{className:"mapboxgl-ctrl-icon mapboxgl-ctrl-img mapboxgl-ctrl-stree",onClick:this.switchMapStyle.bind(this,"streets")}),s().createElement("button",{className:"mapboxgl-ctrl-icon mapboxgl-ctrl-img mapboxgl-ctrl-satellite",onClick:this.switchMapStyle.bind(this,"satellite")})))),s().createElement("div",{className:"map-top-center"},s().createElement(E,{collection:this.props.geo})))}})},6211:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var n=a(7588),s=a.n(n);const o=s().createClass({displayName:"taskStopMessagePage",render:function(){return s().createElement("div",{className:"row",style:{marginTop:"160px"}},s().createElement("div",{className:"small-8 small-offset-2 columns"},s().createElement("div",{className:"callout small alert text-center"},s().createElement("p",null),s().createElement("h5",null,s().createElement("strong",null,"Oh snap!")," This monitor page have been closed!"),s().createElement("p",null),s().createElement("p",null))))}})},3321:(e,t,a)=>{"use strict";a.d(t,{Z:()=>g}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(6486)),l=a(381),i=a.n(l),r=a(3609),c=a.n(r),u=a(8896),m=a(4179);const p=s().createBackboneClass({mixins:[u.Z],componentWillMount:function(){},onUserSelected:function(e){this.setState({selectedUser:e})},onDbUserSelected:function(e){this.setState({selectedUser:e}),this.publish("distribution/publish",e)},onClose:function(){this.publish("showDialog")},onProcess:function(){this.state&&this.state.selectedUser&&this.publish("distribution/publish",this.state.selectedUser)},render:function(){return s().createElement("div",null,s().createElement("h5",null,"Distribution Map Publish"),s().createElement("span",null,"Assign to"),s().createElement(m.Z,{onSelect:this.onUserSelected,onDbSelect:this.onDbUserSelected,group:"monitor"}),s().createElement("div",{className:"float-right"},s().createElement("button",{className:"success button",onClick:this.onProcess},"Okay"),s().createElement("a",{href:"javascript:;",className:"button",onClick:this.onClose},"Cancel")))}}),d=s().createBackboneClass({mixins:[u.Z],componentWillMount:function(){},onUserSelected:function(e){this.setState({selectedUser:e})},onDbUserSelected:function(e){this.setState({selectedUser:e}),this.publish("distribution/dismiss",e)},onClose:function(){this.publish("showDialog")},onProcess:function(){this.state&&this.state.selectedUser&&this.publish("distribution/dismiss",this.state.selectedUser)},render:function(){return s().createElement("div",null,s().createElement("h5",null,"Dismiss to Campaign"),s().createElement("span",null,"Assign to"),s().createElement(m.Z,{onSelect:this.onUserSelected,onDbSelect:this.onDbUserSelected,group:"campaign"}),s().createElement("div",{className:"float-right"},s().createElement("button",{className:"success button",onClick:this.onProcess},"Okay"),s().createElement("a",{href:"javascript:;",className:"button",onClick:this.onClose},"Cancel")))}}),h=s().createBackboneClass({mixins:[u.Z],getDefaultProps:function(){return{address:null,icon:null,name:null}},componentDidMount:function(){c()(".has-tip").foundation()},componentDidUpdate:function(){},onDismiss:function(e){e.preventDefault(),e.stopPropagation();var t=this,a=this.getModel(),n="Are you sure you would like to move \r\n".concat(a.getDisplayName(),"\r\nto Campaigns? Any changes that were made will be lost.");this.confirm(n).then((function(){t.publish("showDialog",{view:d}),t.unsubscribe("distribution/dismiss"),t.subscribe("distribution/dismiss",(function(e){a.dismissToCampaign(e,{success:function(e){t.publish("showDialog"),e&&e.success?t.publish("distribution/refresh"):alert("something wrong")}})}))}))},onPublishToMonitors:function(e){e.preventDefault(),e.stopPropagation();var t=this.getModel(),a=this;this.publish("showDialog",{view:p}),this.unsubscribe("distribution/publish"),this.subscribe("distribution/publish",(function(e){t.publishToMonitor(e,{success:function(e){a.publish("showDialog"),e&&e.success?a.publish("distribution/refresh"):alert(e.error)}})}))},onGotoDMap:function(e){window.location.hash="frame/DistributionMap.aspx?cid="+e},render:function(){var e=this.getModel(),t=e.get("Date"),a=t?i()(t).format("MMM DD, YYYY"):"";return s().createElement("div",{className:"row scroll-list-item",onClick:this.onGotoDMap.bind(null,e.get("Id"))},s().createElement("div",{className:"hide-for-small-only medium-2 columns"},e.get("ClientName")),s().createElement("div",{className:"small-12 medium-5 columns"},e.get("ClientCode")),s().createElement("div",{className:"hide-for-small-only medium-2 columns"},a),s().createElement("div",{className:"small-12 medium-3 columns"},s().createElement("span",{className:"show-for-large"},e.get("AreaDescription")),s().createElement("div",{className:"float-right tool-bar"},s().createElement("button",{onClick:this.onPublishToMonitors,className:"button"},s().createElement("i",{className:"fa fa-upload"}),s().createElement("small",null,"Publish")),s().createElement("button",{onClick:this.onDismiss,className:"button has-tip top",title:"dismiss","data-tooltip":!0,"aria-haspopup":"true","data-disable-hover":"false",tabIndex:"1"},s().createElement("i",{className:"fa fa-reply"})))))}}),g=s().createBackboneClass({mixins:[u.Z],getInitialState:function(){return{orderByFiled:null,orderByAsc:!1,search:null,filterField:null,filterValues:[]}},componentDidMount:function(){var e=this;this.subscribe("distribution/refresh",(function(){e.getCollection().fetchForDistribution()})),this.subscribe("search",(function(t){e.setState({search:t,filterField:null,filterValues:[]})})),c()("#distribution-filter-ddl-ClientName, #distribution-filter-ddl-ClientCode, #distribution-filter-ddl-Date, #distribution-filter-ddl-AreaDescription").foundation()},onOrderBy:function(e,t){t.preventDefault(),t.stopPropagation(),this.state.orderByFiled==e?this.setState({orderByAsc:!this.state.orderByAsc}):this.setState({orderByFiled:e,orderByAsc:!0})},onFilter:function(e,t){t.preventDefault(),t.stopPropagation();var a=c()(":checked",t.currentTarget),n=(0,o.map)(a,(function(e){return c()(e).val()}));this.setState({filterField:n.length>0?e:null,filterValues:n.length>0?n:[],search:null}),c()("#distribution-filter-ddl-"+e).foundation("close")},onClearFilter:function(e,t){t.preventDefault(),t.stopPropagation(),this.setState({filterField:null,filterValues:[],search:null}),c()("#distribution-filter-ddl-"+e).foundation("close"),c()(t.currentTarget).closest("form").get(0).reset()},renderHeader:function(e,t){var a=this.getCollection(),n=null,l=null,r=null;if(a=a?a.toArray():[],n=this.state.orderByFiled==e?this.state.orderByAsc?s().createElement("i",{className:"fa fa-sort-up active"}):s().createElement("i",{className:"fa fa-sort-down active"}):s().createElement("i",{className:"fa fa-sort"}),n=s().createElement("a",{onClick:this.onOrderBy.bind(null,e)}," ",n),this.state.filterField&&this.state.filterField==e&&(l=s().createElement("a",{"data-toggle":"distribution-filter-ddl-"+e}," ",s().createElement("i",{className:"fa fa-filter active"}))),a){var c=(0,o.map)(a,(function(t){var a=t.get(e),n=i()(a,i().ISO_8601);return n.isValid()?n.format("MMM DD, YYYY"):a})),u=(0,o.uniq)(c).sort();r=s().createElement("div",{id:"distribution-filter-ddl-"+e,className:"dropdown-pane bottom",style:{width:"auto"},"data-dropdown":!0,"data-close-on-click":"true","data-auto-focus":"false"},s().createElement("form",{onSubmit:this.onFilter.bind(this,e)},s().createElement("ul",{className:"vertical menu"},u.map((function(t,a){return s().createElement("li",{key:e+a},s().createElement("input",{id:e+a,name:e,type:"checkbox",value:t}),s().createElement("label",{htmlFor:e+a},t))}))),s().createElement("button",{className:"button tiny success",type:"submit"},"Filter"),s().createElement("button",{className:"button tiny warning",type:"reset",onClick:this.onClearFilter.bind(this,e)},"Clear")))}return s().createElement("div",null,s().createElement("a",{"data-toggle":"distribution-filter-ddl-"+e},t),n,l,r)},getDataSource:function(){var e=this.getCollection();if(e=e?e.toArray():[],this.state.orderByFiled&&(e=(0,o.orderBy)(e,["attributes."+this.state.orderByFiled],[this.state.orderByAsc?"asc":"desc"])),this.state.search){var t=this.state.search.toLowerCase(),a=null;e=(0,o.filter)(e,(function(e){return a=(0,o.values)(e.attributes),(0,o.some)(a,(function(e){var a=i()(e,i().ISO_8601);return a.isValid()?a.format("MMM DD YYYY MMM DD, YYYY YYYY-MM-DD MM/DD/YYYY YYYY MM MMM DD").toLowerCase().indexOf(t)>-1:(0,o.toString)(e).toLowerCase().indexOf(t)>-1}))}))}else if(this.state.filterField&&this.state.filterValues){var n=this.state.filterField,s=this.state.filterValues;e=(0,o.filter)(e,(function(e){var t=e.get(n),a=i()(t,i().ISO_8601);return a.isValid()?(0,o.indexOf)(s,a.format("MMM DD, YYYY"))>-1:(0,o.indexOf)(s,t)>-1}))}return e},render:function(){var e=this.getDataSource();return s().createElement("div",{className:"section row"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"section-header"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 column"},s().createElement("h5",null,"Distribution Maps")),s().createElement("div",{className:"small-12 column"},s().createElement("nav",{"aria-label":"You are here:",role:"navigation"},s().createElement("ul",{className:"breadcrumbs"},s().createElement("li",null,s().createElement("a",{href:"#"},"Control Center")),s().createElement("li",null,s().createElement("span",{className:"show-for-sr"},"Current: ")," Distribution Maps")))))),s().createElement("div",{className:"scroll-list-section-body"},s().createElement("div",{className:"row scroll-list-header"},s().createElement("div",{className:"hide-for-small-only medium-2 columns"},this.renderHeader("ClientName","Client Name")),s().createElement("div",{className:"small-12 medium-5 columns"},this.renderHeader("ClientCode","Client Code")),s().createElement("div",{className:"hide-for-small-only medium-2 columns"},this.renderHeader("Date","Date")),s().createElement("div",{className:"small-12 medium-3 columns"},s().createElement("span",{className:"show-for-large"},this.renderHeader("AreaDescription","Type")))),e.map((function(e){return s().createElement(h,{key:e.get("Id"),model:e})})))))}})},8742:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(3609)),l=a.n(o),i=(a(2345),a(5911),a(6486)),r=a(8896);const c=s().createBackboneClass({mixins:[r.Z],getInitialState:function(){return{editId:null}},componentDidMount:function(){this.getModel(),l()("form").foundation()},componentWillUpdate:function(e,t){null!=this.state.editId&&t.editId!=this.state.editId&&this.refs["userSelector-"+this.state.editId]&&l()(this.refs["userSelector-"+this.state.editId]).select2("destroy")},componentDidUpdate:function(e,t){null!=this.state.editId&&this.state.editId!=t.editId&&this.refs["userSelector-"+this.state.editId]&&l()(this.refs["userSelector-"+this.state.editId]).select2()},onClose:function(){this.publish("showDialog")},onAdd:function(e){this.setState({editId:e})},onSave:function(e){var t=this.props.taskId,a=this.getCollection().get(e),n=l()(this.refs.userColor).val(),s=l()(this.refs["userSelector-"+e]).val(),o=this;a.assignGTUToTask({Id:e,TaskId:t,UserColor:n,AuditorId:s}).done((function(){o.setState({editId:null}),o.publish("GTU.Assigned")}))},onCacnel:function(){this.setState({editId:null})},onRemove:function(e){var t=this;this.confirm("Are you sure you want to remove the assignment from GTU and Employee?").then((function(){var a=t.props.taskId;t.getCollection().get(e).unassignGTUFromTask(a,e)}))},renderEditForm:function(e){var t=this,a=(0,i.groupBy)(this.props.user.models,(function(e){return e.get("CompanyId")}));return s().createElement("tr",{key:e.get("Id")},s().createElement("td",{className:"text-center"},e.get("BagId")),s().createElement("td",{className:"text-center"},e.get("ShortUniqueID")),s().createElement("td",{className:"text-center"},s().createElement("input",{ref:"userColor",className:"color-block",type:"color",autocomplete:!0,defaultValue:"#"+Math.floor(16777215*Math.random()).toString(16)})),s().createElement("td",{colSpan:"2"},s().createElement("select",{ref:"userSelector-"+e.get("Id")},(0,i.map)(a,(function(e,t){return s().createElement("optgroup",{key:t,label:e[0].get("CompanyName")},e.map((function(e){return s().createElement("option",{key:e.get("UserId"),value:e.get("UserId")},e.get("UserName")," - ",e.get("Role"))})))})))),s().createElement("td",{className:"text-center"},e.get("IsOnline")?"Online":"Offline"),s().createElement("td",{className:"text-center"},s().createElement("button",{className:"button tiny",onClick:t.onSave.bind(t,e.get("Id"))},"Save"),s().createElement("button",{className:"button tiny alert",onClick:t.onCacnel},"Cancel")))},render:function(){var e=this.getCollection()||[],t=this;return e&&e.where&&(e=e.where((function(e){return 0==e.get("IsAssignedToOther")}))),s().createElement("div",null,s().createElement("h3",null,"Assign GTU"),s().createElement("div",{"data-abide-error":!0,className:"alert callout",style:{display:"none"}},s().createElement("p",null,s().createElement("i",{className:"fa fa-exclamation-circle"})," ","")),s().createElement("table",null,s().createElement("colgroup",null,s().createElement("col",{style:{width:"80px"}}),s().createElement("col",{style:{width:"160px"}}),s().createElement("col",{style:{width:"160px"}}),s().createElement("col",null),s().createElement("col",{style:{width:"160px"}}),s().createElement("col",{style:{width:"160px"}}),s().createElement("col",{style:{width:"150px"}})),s().createElement("thead",null,s().createElement("tr",null,s().createElement("th",{className:"text-center"},"Bag#"),s().createElement("th",{className:"text-center"},"GTU#"),s().createElement("th",{className:"text-center"},"Color"),s().createElement("th",{className:"text-center"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-6 column"},"Team"),s().createElement("div",{className:"small-6 column"},"Auditor"))),s().createElement("th",{className:"text-center"},"Role"),s().createElement("th",{className:"text-center"},"Status"),s().createElement("th",{className:"text-center"}))),s().createElement("tbody",null,e.map((function(e){var a=e.get("IsAssign"),n=e.get("Id"),o=s().createElement("button",{className:"button tiny",onClick:t.onAdd.bind(null,n)},s().createElement("i",{className:"fa fa-plus"})," Assign"),l=s().createElement("button",{className:"button alert tiny",onClick:t.onRemove.bind(null,n)},s().createElement("i",{className:"fa fa-remove"})," Remove"),i=e.get("UserColor")?s().createElement("div",{className:"color-block",style:{background:e.get("UserColor")}}):null,r=a?l:o;return e.get("Id")==t.state.editId?t.renderEditForm(e):s().createElement("tr",{key:e.get("Id")},s().createElement("td",{className:"text-center"},e.get("BagId")),s().createElement("td",{className:"text-center"},e.get("ShortUniqueID")),s().createElement("td",{className:"text-center"},i),s().createElement("td",null,s().createElement("div",{className:"row"},s().createElement("div",{className:"small-6 column"},e.get("Company")),s().createElement("div",{className:"small-6 column"},e.get("Auditor")))),s().createElement("td",{className:"text-center"},e.get("Role")),s().createElement("td",{className:"text-center"},e.get("IsOnline")?"Online":"Offline"),s().createElement("td",{className:"text-center"},r))})))),s().createElement("button",{onClick:this.onClose,className:"close-button","data-close":!0,"aria-label":"Close reveal",type:"button"},s().createElement("span",{"aria-hidden":"true"},"×")))}})},5230:(e,t,a)=>{"use strict";a.d(t,{Z:()=>h}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(381)),l=a.n(o),i=a(6486),r=a(3609),c=a.n(r),u=a(4042),m=a.n(u),p=a(8896),d=s().createClass({displayName:"MapContainer",mixins:[p.Z],shouldComponentUpdate:function(){return!1},componentWillUnmount:function(){this.state.map&&(this.state.map.off("click"),this.state.map.remove())},componentDidMount:function(){var e=this;this.subscribe("Map.Draw.CustomGTU",(function(t){e.drawGtu(),e.drawCustomGtu()})),this.subscribe("Map.Draw.Recenter",(function(t){e.recenter()}))},onInit:function(e){if(null!=e){var t=this;m().accessToken="pk.eyJ1IjoiZ2hvc3R1eiIsImEiOiJjaXczc2tmc3cwMDEyMm9tb29pdDRwOXUzIn0.KPSiOO6DWTY59x1zHdvYSA";var a=new(m().Map)({container:e,zoom:8,maxZoom:20,center:[-73.987378,40.744556],style:"//timm.vargainc.com/map/street.json"}),n=new(m().NavigationControl);a.addControl(n,"top-right"),a.on("load",(function(){a.addSource("google-road-tiles",{type:"raster",tiles:["//mt0.google.com/vt/lyrs=m&x={x}&y={y}&z={z}","//mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}","//mt2.google.com/vt/lyrs=m&x={x}&y={y}&z={z}","//mt3.google.com/vt/lyrs=m&x={x}&y={y}&z={z}"],tileSize:256}),a.addSource("google-satellite-tiles",{type:"raster",tiles:["//mt0.google.com/vt/lyrs=y&x={x}&y={y}&z={z}","//mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}","//mt2.google.com/vt/lyrs=y&x={x}&y={y}&z={z}","//mt3.google.com/vt/lyrs=y&x={x}&y={y}&z={z}"],tileSize:256}),a.addLayer({id:"google-road-tiles-layer",type:"raster",source:"google-road-tiles",minzoom:0,maxzoom:21,layout:{visibility:"visible"}}),a.addLayer({id:"google-satellite-tiles-layer",type:"raster",source:"google-satellite-tiles",minzoom:0,maxzoom:21,layout:{visibility:"none"}}),t.registerTopic(a),t.setState({map:a,mapContainer:e},t.initMapLayer)}))}},registerTopic:function(e){var t=this;e.on("click",(function(a){var n=e.queryRenderedFeatures(a.point,{layers:["gtu-new-layer"]});if(n&&n.length>0){var s=(0,i.first)(n);return console.log(s.properties.clientId),void t.publish("Map.GTU.Remove",s.properties.clientId)}var o=e.queryRenderedFeatures(a.point,{layers:["boundary-dmap-fill-layer"]});o&&o.length>0&&t.publish("Map.GTU.New",a.lngLat)}))},initMapLayer:function(){var e=this.state.map,t=this;this.drawBoundary(),this.drawGtu(),this.subscribe("Global.Window.Resize",(function(a){if(t.state.mapContainer){c()(".mapbox-wrapper").width("".concat(a.width,"px"));var n=a.height-c()(".title-bar").outerHeight()-c()(".section").outerHeight()-c()(".map-toolbar").outerHeight()-10;c()(".mapbox-wrapper").height("".concat(n,"px")),e.resize()}})),c()(window).trigger("resize")},drawBoundary:function(){var e=this,t=this.state.map;if(t){console.time("draw boundary"),this.publish("showLoading");var a=this.props.dmap.get("Boundary"),n=(this.props.dmap.get("Color"),new(m().LngLatBounds)),s={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}};(0,i.each)(a,(function(e){s.geometry.coordinates[0].push([e.lng,e.lat]),n.extend([e.lng,e.lat])})),t.addSource("boundary-dmap",{type:"geojson",data:{type:"FeatureCollection",features:[s]}}),t.addLayer({id:"boundary-dmap-fill-layer",type:"fill",source:"boundary-dmap",layout:{},paint:{"fill-opacity":0,"fill-color":"rgb(0, 0, 0)"}}),t.addLayer({id:"boundary-dmap-layer",type:"line",source:"boundary-dmap",layout:{"line-join":"round"},paint:{"line-color":"rgb(0, 0, 0)","line-width":{stops:[[10,1],[20,4]]}}}),t.fitBounds(n),this.setState({dmapBounds:n},(function(){e.publish("hideLoading"),console.timeEnd("draw boundary")}))}else console.error("map is not ready")},recenter:function(){if(this.state.map&&this.state.dmapBounds){var e=this.state.map.getZoom();this.state.map.flyTo({center:this.state.dmapBounds.getCenter(),zoom:e})}},drawGtu:function(){var e=this.state.map;if(e){console.time("draw gtu");var t=this.props.dmap.get("Gtu")||[],a={type:"geojson",data:{type:"FeatureCollection",features:[]}};(0,i.each)(t,(function(e){var t=e.color;(0,i.each)(e.points,(function(n){if(n.out)return!0;a.data.features.push({type:"Feature",properties:{cellId:n.cellId,userColor:t,gtuId:e.gtuId},geometry:{type:"Point",coordinates:[n.lng,n.lat]}})}))}));var n=e.getSource("gtu-source");n?n.setData(a.data):(e.addSource("gtu-source",a),e.addLayer({id:"gut-layer",type:"circle",source:"gtu-source",paint:{"circle-radius":{stops:[[4,2],[20,8]]},"circle-color":{property:"userColor",type:"identity"},"circle-stroke-width":1,"circle-stroke-color":"black"}})),console.timeEnd("draw gtu")}else console.error("map is not ready")},drawCustomGtu:function(){var e=this.state.map;if(e){var t=e.getSource("gtu-new-source");null==t?(e.addSource("gtu-new-source",{type:"geojson",data:{type:"FeatureCollection",features:(0,i.map)(this.props.customPoints,(function(e){return{type:"Feature",properties:{clientId:e.ClientId,userColor:e.Color,gtuId:e.GtuId},geometry:{type:"Point",coordinates:[e.Location.Longitude,e.Location.Latitude]}}}))}}),e.addLayer({id:"gtu-new-layer",type:"circle",source:"gtu-new-source",paint:{"circle-radius":{stops:[[4,2],[20,8]]},"circle-color":{property:"userColor",type:"identity"},"circle-stroke-width":4,"circle-stroke-color":"#000000"}})):t.setData({type:"FeatureCollection",features:(0,i.map)(this.props.customPoints,(function(e){return{type:"Feature",properties:{clientId:e.ClientId,userColor:e.Color,gtuId:e.GtuId},geometry:{type:"Point",coordinates:[e.Location.Longitude,e.Location.Latitude]}}}))})}else console.error("map is not ready")},switchMapStyle:function(e){var t=this.state.map;t&&("streets"==e?(t.setLayoutProperty("google-road-tiles-layer","visibility","visible"),t.setLayoutProperty("google-satellite-tiles-layer","visibility","none")):(t.setLayoutProperty("google-road-tiles-layer","visibility","none"),t.setLayoutProperty("google-satellite-tiles-layer","visibility","visible")))},render:function(){return s().createElement("div",{className:"mapbox-wrapper"},s().createElement("div",{className:"mapbox-container",ref:this.onInit,style:{width:"100%",height:"100%"}}),s().createElement("div",{className:"map-overlay"},s().createElement("div",{className:"mapboxgl-ctrl-top-left"},s().createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group"},s().createElement("button",{className:"mapboxgl-ctrl-icon mapboxgl-ctrl-img mapboxgl-ctrl-stree",onClick:this.switchMapStyle.bind(this,"streets")}),s().createElement("button",{className:"mapboxgl-ctrl-icon mapboxgl-ctrl-img mapboxgl-ctrl-satellite",onClick:this.switchMapStyle.bind(this,"satellite")})))),s().createElement("div",{className:"map-top-center"}))}});const h=s().createBackboneClass({mixins:[p.Z],componentDidMount:function(){var e=this;this.subscribe("Map.GTU.New",(function(t){e.onNewGtu.call(e,t)})),this.subscribe("Map.GTU.Remove",(function(t){e.onRemoveGtu.call(e,t)}))},getInitialState:function(){return{disableDefaultUI:!1,scrollwheel:!1,disableDoubleClickZoom:!0,activeGtu:null,customPoints:[]}},setActiveGtu:function(e){var t=this.props.gtu.get(e);this.setState({activeGtu:t})},onNewGtu:function(e){var t=this,a=this.state.activeGtu;if(a){var n=this.state.customPoints;n.push({ClientId:(0,i.uniqueId)(),TaskId:this.props.task.get("Id"),GtuId:a.get("Id"),Date:l()().format("YYYY-MM-DD HH:mm:ss"),Color:a.get("UserColor"),Location:{Latitude:e.lat,Longitude:e.lng}}),this.setState({customPoints:n},(function(){t.publish("Map.Draw.CustomGTU")}))}},onRemoveGtu:function(e){if(e){var t=this,a=(0,i.filter)(this.state.customPoints,(function(t){return t.ClientId!=e}));this.setState({customPoints:a},(function(){t.publish("Map.Draw.CustomGTU")}))}},onUnderGtu:function(){var e=this,t=(0,i.dropRight)(this.state.customPoints);this.setState({customPoints:t},(function(){e.publish("Map.Draw.CustomGTU")}))},onSaveGtu:function(){var e=this,t=(0,i.map)(this.state.customPoints,(function(e){return{GtuId:e.GtuId,Date:e.Date,Location:e.Location}}));Promise.all([this.props.task.addGtuDots(t)]).then((function(){return e.props.dmap.fetchGtuForEdit()})).then((function(){e.setState({customPoints:[]},(function(){e.publish("Map.Draw.CustomGTU")}))}))},onReCenter:function(){this.publish("Map.Draw.Recenter")},render:function(){var e=this,t=this.props.gtu.models||[];if((0,i.filter)(this.state.customPoints,(function(e){return"new"==e.status||"deleted"==e.status})),this.state.customPoints.length>0)a=s().createElement("button",{className:"button float-right",onClick:this.onUnderGtu},s().createElement("i",{className:"fa fa-undo"}),"Undo"),n=s().createElement("button",{className:"button float-right",onClick:this.onSaveGtu},s().createElement("i",{className:"fa fa-save"}),"Save");else var a=s().createElement("button",{className:"button float-right",disabled:!0,onClick:this.onUnderGtu},s().createElement("i",{className:"fa fa-undo"}),"Undo"),n=s().createElement("button",{className:"button float-right",disabled:!0,onClick:this.onSaveGtu},s().createElement("i",{className:"fa fa-save"}),"Save");return s().createElement("div",{className:"edit-gtu"},s().createElement("div",{className:"section row"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"section-header"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 column"},s().createElement("h5",null,"Edit GTU - ",this.props.task.get("Name"))),s().createElement("div",{className:"small-12 column"},s().createElement("nav",{"aria-label":"You are here:",role:"navigation"},s().createElement("ul",{className:"breadcrumbs"},s().createElement("li",null,s().createElement("a",{href:"#"},"Control Center")),s().createElement("li",null,s().createElement("a",{href:"#report/"+this.props.task.get("Id")},"Report")),s().createElement("li",null,s().createElement("span",{className:"show-for-sr"},"Current: ")," Edit GTU"))))))),s().createElement("div",{className:"small-12 medium-7 large-9 columns"},t.map((function(t){return s().createElement("button",{key:t.get("Id"),className:e.state.activeGtu==t?" button":"button",onClick:e.setActiveGtu.bind(null,t.get("Id"))},s().createElement("i",{className:e.state.activeGtu==t?"fa fa-map-marker":"fa fa-stop",style:{color:t.get("UserColor")}}),t.get("ShortUniqueID"))}))),s().createElement("div",{className:"small-12 medium-5 large-3 columns"},n,a,s().createElement("button",{className:"button float-right",onClick:this.onReCenter},s().createElement("i",{className:"fa fa-refresh"}),"ReCenter"))),s().createElement(d,{dmap:this.props.dmap,customPoints:this.state.customPoints}))}})},3179:(e,t,a)=>{"use strict";a.d(t,{Z:()=>D}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(381),a(3609)),l=a.n(o),i=a(6486),r=a(8573),c=a(6079),u=a(189),m=a(8896),p=a(8300),d=a(8742),h=a(3821),g=null,f=null,v=null,y=null,E=null,b=[],M={},N={},C=0,w=0,k=null;const D=s().createBackboneClass({mixins:[m.Z,p.Z],getInitialState:function(){return{disableDefaultUI:!1,scrollwheel:!1,disableDoubleClickZoom:!0,activeGtu:[],ShowOutOfBoundary:!1,displayMode:"cover",customPoints:[],maxDisplayCount:1e3,canDrawMap:!1,lastDisplayGtuIndex:null}},onWindowResize:function(){var e=l()(window).height()-l()(this.refs.mapArea).position().top;this.setMapHeight(e)},componentDidMount:function(){this.publish("showLoading"),l()(window).on("resize.gtu-monitor-view",l().proxy(this.onWindowResize,this)),this.onWindowResize();var e=this;this.getGoogleMap(),this.drawDmapBoundary().done((function(){e.drawGtu(),e.drawLastLocation();var t=(0,i.map)(e.props.gtu.where((function(e){return e.get("IsAssign")||e.get("WithData")})),(function(e){return e.get("Id")}));e.setState({activeGtu:t,canDrawMap:!0}),e.publish("hideLoading"),k=new google.maps.InfoWindow,window.clearInterval(f),f=window.setInterval(e.reload,3e4)})),l()("#monitor-more-menu").foundation()},componentWillUnmount:function(){var e=this.getGoogleMap();try{this.clearMap(),(0,i.each)(M,(function(e){e.setMap(null)})),y.setMap(null),google.maps.event.clearInstanceListeners(e),l()(document).off("resize.gtu-monitor-view")}catch(e){}},shouldComponentUpdate:function(e,t){var a=t.activeGtu,n=this.state.activeGtu,s=(0,i.xor)(a,n);return"track"==t.displayMode?window.clearInterval(f):(window.clearInterval(f),f=window.setInterval(this.reload,3e4)),this.state.ShowOutOfBoundary!=t.ShowOutOfBoundary?this.reload():(0,i.isEmpty)(s)?this.state.displayMode!=t.displayMode&&(this.clearMap(),this.reload()):this.reload(),!0},getCirclePath:function(e){return"M-".concat(e,",0a").concat(e,",").concat(e," 0 1,0 ").concat(2*e,",0a").concat(e,",").concat(e," 0 1,0 -").concat(2*e,",0")},drawDmapBoundary:function(){var e=l().Deferred(),t=this.props.dmap.get("Boundary"),a=this.props.dmap.get("Color"),n=this.getGoogleMap();return E=new google.maps.LatLngBounds,y=new google.maps.Polygon({paths:t,strokeColor:a,strokeOpacity:1,strokeWeight:6,fillOpacity:0,map:n}),(0,i.each)(t,(function(e){var t=new google.maps.LatLng(e.lat,e.lng);E.extend(t)})),google.maps.event.addListenerOnce(n,"tilesloaded",(function(){window.clearTimeout(null),e.resolve()})),n.fitBounds(E),e.resolve(),e},drawGtu:function(){if("cover"==this.state.displayMode){console.log("begin draw");var e=this,t=this.getGoogleMap(),a=!this.state.ShowOutOfBoundary,n=this.props.dmap.get("Gtu")||[],s=this.state.activeGtu;console.log("already draw gtu",b.length),(0,i.each)(b,(function(e){e.setMap(null)})),b=[],(0,i.each)(n,(function(n){if(-1==(0,i.indexOf)(s,n.gtuId))return!0;if(a)var o=(0,i.filter)(n.points,{out:!1});else o=n.points;var l=n.color;console.log("draw color: "+l+" gtu count:"+o.length),(0,i.each)(o,(function(a){a&&a.lat&&a.lng&&b.push(new r.Z({position:{lat:a.lat,lng:a.lng},icon:{path:e.getCirclePath(5),fillColor:l,fillOpacity:.8,strokeWeight:1,strokeOpacity:.9,strokeColor:"#000"},draggable:!1,map:t}))}))}))}},prepareGTUTrack:function(){var e=l().Deferred(),t=this.props.task.get("Id"),a=this.state.activeGtu;if(a&&1==a.length){var n=this.props.gtu.get(a[0]),s=n.get("track");(0,i.isEmpty)(s)?e=n.getTrack(t):e.resolve()}else e.resolve();return e},drawGTUTrack:function(){if("track"==this.state.displayMode){this.getGoogleMap();var e=this.state.activeGtu,t=this.props.gtu,a=this;this.prepareGTUTrack().then((function(){if(a.clearMap(),e&&1==e.length){C=0;var n=t.get(e[0]);a.changeToBestTrackView(n),a.animateDrawTrack(n)}}))}else window.cancelAnimationFrame(v)},changeToBestTrackView:function(e){var t=e.get("track"),a=this.getGoogleMap(),n=new google.maps.LatLngBounds;(0,i.each)(t,(function(e){n.extend(new google.maps.LatLng(e.lat,e.lng))})),a.fitBounds(n)},animateDrawTrack:function(e){if("track"==this.state.displayMode){if(w%10!=0)return w++,void(v=window.requestAnimationFrame(l().proxy((function(){this.animateDrawTrack(e)}),this)));w=1;var t=e.get("track");if(t&&!(C>=t.length)){var a=e.get("Id"),n=this.getGoogleMap();N[a]||(N[a]=[]);var s=new google.maps.Marker({position:t[C++],icon:{path:this.getCirclePath(6),fillColor:e.get("UserColor"),fillOpacity:1,strokeOpacity:1,strokeColor:"#000"},draggable:!1,map:n});N[a].push(s),v=window.requestAnimationFrame(l().proxy((function(){this.animateDrawTrack(e)}),this))}}},drawLastLocation:function(){var e=this.getGoogleMap(),t=1==this.props.task.get("Status"),a=this.props.gtu.where((function(e){return t?e.get("WithData"):e.get("IsAssign")||e.get("WithData")})),n=(0,i.map)(a,(function(e){return e.get("Id")})),s=(0,i.keys)(M)||[],o=(0,i.difference)(s,n);(0,i.each)(o,(function(e){M[e].setMap(null),delete M[e]})),(0,i.each)(a,(function(t){var a=t.get("Id"),n=t.get("Location");if(!n)return delete M[a],!0;M[a]?M[a].setPosition({lat:n.lat,lng:n.lng}):M[a]=new google.maps.Marker({position:{lat:n.lat,lng:n.lng},icon:{path:"Driver"==t.get("Role")?"M-10.8,1.3c-0.3,0.3-0.7,0.5-1.1,0.5c-0.4,0-0.8-0.2-1.1-0.5s-0.5-0.7-0.5-1.1s0.2-0.8,0.5-1.1s0.7-0.5,1.1-0.5c0.4,0,0.8,0.2,1.1,0.5c0.3,0.3,0.5,0.7,0.5,1.1C-10.3,0.7-10.4,1.1-10.8,1.3z M-15.2-6.6c0-0.1,0-0.2,0.1-0.3l2.5-2.5c0.1,0,0.2-0.1,0.3-0.1h2v3.3h-4.9V-6.6z M0.7,1.3C0.4,1.6-0.1,1.8-0.4,1.8s-0.8-0.2-1.1-0.5s-0.5-0.7-0.5-1.1s0.2-0.8,0.5-1.1c0.3-0.3,0.7-0.5,1.1-0.5s0.8,0.2,1.1,0.5c0.3,0.3,0.5,0.7,0.5,1.1C1.1,0.7,1,1.1,0.7,1.3z M4.2-14.1c-0.2-0.2-0.4-0.3-0.6-0.3h-13c-0.3,0-0.5,0.1-0.6,0.3c-0.1,0.2-0.3,0.3-0.3,0.6v2.4h-2c-0.2,0-0.5,0.1-0.7,0.2c-0.3,0.1-0.5,0.2-0.7,0.4l-2.5,2.5c-0.1,0.1-0.2,0.2-0.3,0.4c-0.1,0.1-0.1,0.2-0.2,0.4c0,0.1-0.1,0.3-0.1,0.5s0,0.3,0,0.4c0,0.1,0,0.3,0,0.5s0,0.4,0,0.4v4.1c-0.2,0-0.4,0.1-0.6,0.2s-0.2,0.4-0.2,0.6c0,0.1,0,0.2,0.1,0.3c0,0.1,0.1,0.2,0.2,0.2s0.2,0.1,0.2,0.1s0.2,0.1,0.3,0.1s0.2,0,0.3,0c0.1,0,0.2,0,0.3,0s0.3,0,0.3,0h0.8c0,0.9,0.3,1.7,1,2.3s1.4,1,2.3,1s1.7-0.3,2.3-1c0.6-0.6,1-1.4,1-2.3h4.9c0,0.9,0.3,1.7,1,2.3s1.4,1,2.3,1s1.7-0.3,2.3-1c0.6-0.6,1-1.4,1-2.3c0,0,0.1,0,0.3,0c0.2,0,0.3,0,0.3,0s0.1,0,0.3,0c0.1,0,0.2,0,0.3-0.1c0.1,0,0.1-0.1,0.2-0.1s0.1-0.1,0.2-0.2c0-0.1,0.1-0.2,0.1-0.3v-13C4.4-13.9,4.3-14,4.2-14.1z":"M-9-0.2c0,0.5,0.3,1,0.8,1.4S-7,2-6.1,2.2c0.9,0.3,1.8,0.4,2.8,0.6C-2.3,2.9-1.2,3-0.1,3S2,2.9,3.1,2.8c1-0.1,2-0.3,2.8-0.6c0.9-0.3,1.5-0.6,2-1s0.8-0.9,0.8-1.4c0-0.4-0.1-0.8-0.4-1.1C8-1.6,7.6-1.9,7.2-2.1c-0.5-0.2-1-0.4-1.5-0.6C5.2-2.8,4.7-3,4.1-3.1c-0.2,0-0.4,0-0.6,0.1C3.3-2.9,3.2-2.7,3.2-2.5s0,0.4,0.1,0.6s0.3,0.3,0.5,0.3c0.5,0.1,0.9,0.2,1.3,0.3c0.4,0.1,0.7,0.2,1,0.3c0.2,0.1,0.4,0.2,0.6,0.3C6.9-0.6,7-0.5,7-0.5c0.1,0.1,0.1,0.1,0.1,0.1c0,0.1-0.1,0.2-0.3,0.3C6.6,0,6.3,0.2,5.9,0.3S5,0.6,4.5,0.7S3.3,0.9,2.5,1C1.7,1.1,0.9,1.1,0,1.1s-1.7,0-2.5-0.1s-1.5-0.2-2-0.3s-1-0.3-1.4-0.4C-6.3,0.2-6.6,0-6.8-0.1s-0.3-0.2-0.3-0.3c0,0,0-0.1,0.1-0.1c0.1-0.1,0.2-0.1,0.3-0.2S-6.3-0.9-6.1-1c0.2-0.1,0.6-0.2,1-0.3c0.4-0.1,0.8-0.2,1.3-0.3c0.2,0,0.4-0.1,0.5-0.3c0.1-0.2,0.2-0.4,0.1-0.6c0-0.2-0.1-0.4-0.3-0.5c-0.2-0.1-0.4-0.2-0.6-0.1C-4.7-3-5.2-2.9-5.7-2.7s-1,0.3-1.5,0.6c-0.5,0.2-0.9,0.5-1.1,0.8S-9-0.6-9-0.2z M-4.2-11.4v4.8C-4.2-6.4-4.1-6.2-4-6c0.2,0.2,0.3,0.2,0.6,0.2h0.8V-1c0,0.2,0.1,0.4,0.2,0.6c0.2,0.2,0.3,0.2,0.6,0.2h3.2c0.2,0,0.4-0.1,0.6-0.2C2.2-0.6,2.2-0.7,2.2-1v-4.8H3c0.2,0,0.4-0.1,0.6-0.2c0.2-0.2,0.2-0.3,0.2-0.6v-4.8c0-0.4-0.2-0.8-0.5-1.1S2.6-13,2.2-13h-4.8c-0.4,0-0.8,0.2-1.1,0.5S-4.2-11.8-4.2-11.4z M-3-16.2c0,0.8,0.3,1.4,0.8,2s1.2,0.8,2,0.8s1.4-0.3,2-0.8s0.8-1.2,0.8-2c0-0.8-0.3-1.4-0.8-2c-0.5-0.6-1.2-0.8-2-0.8s-1.4,0.3-2,0.8S-3-17-3-16.2z",fillColor:t.get("UserColor"),fillOpacity:1,strokeOpacity:1,strokeWeight:1,strokeColor:"#fff"},draggable:!1,map:e})}))},clearMap:function(){try{(0,i.each)(b,(function(e){e&&e.setMap&&e.setMap(null)})),window.window.cancelAnimationFrame(v),C=0,(0,i.each)(N,(function(e){e&&(0,i.each)(e,(function(e){e&&e.setMap&&e.setMap(null)}))}))}catch(e){}},reload:function(){console.log("reload"),window.clearTimeout(g),g=window.setTimeout(l().proxy(this._reload,this),100)},_reload:function(){console.log("_reload");var e=this.props.dmap,t=this.props.gtu,a=this.props.task.get("Id"),n=this;"cover"==this.state.displayMode?l().when([e.updateGtuAfterTime(null,{quite:!0}).promise,t.fetchGtuLocation(a,{quite:!0}).promise]).done((function(){n.drawGtu(),n.drawLastLocation()})):(n.drawLastLocation(),n.drawGTUTrack())},onReCenter:function(){this.getGoogleMap().setCenter(E.getCenter())},onSelectedGTU:function(e){var t=(0,i.clone)(this.state.activeGtu);"cover"==this.state.displayMode?(0,i.indexOf)(t,e)>-1?(0,i.pull)(t,e):t.push(e):t=[e],this.setState({activeGtu:t})},onGotoGTU:function(e,t){t.preventDefault(),t.stopPropagation();var a=this.getGoogleMap(),n=this.props.gtu.get(e),s=n.get("Location"),o=M[n.get("Id")];s?(a.setCenter(n.get("Location")),k.setContent(n.get("ShortUniqueID")),k.open(a,o)):this.alert("showDialog","No Data")},onAssign:function(){var e=this.props.gtu,t=this.props.task.get("Id"),a=new c.Z,n=this;a.fetchForGtu().done((function(){n.publish("showDialog",{view:d.Z,params:{collection:e,user:a,taskId:t},options:{size:"full"}})}))},onAddEmployee:function(){var e=new c.Z,t=this;e.fetchCompany().done((function(){t.publish("showDialog",{view:h.Z,params:{model:new u.Z,company:e}})}))},onStart:function(){this.props.task.setStart()},onStop:function(){this.props.task.setStop()},onPause:function(){this.props.task.setPause()},onSwitchDisplayMode:function(){var e=(0,i.clone)(this.state.activeGtu),t=[];e&&e.length>0&&(t=[e[0]]),this.setState({activeGtu:"cover"==this.state.displayMode?t:e,displayMode:"cover"==this.state.displayMode?"track":"cover",lastDisplayGtuIndex:null})},onSwitchShowOutOfBoundaryPoints:function(){this.setState({ShowOutOfBoundary:!this.state.ShowOutOfBoundary,lastViewArea:null})},onCopyShareLink:function(){var e=window.location,t=e.pathname.substr(1),a=e.pathname.substr(0,t.indexOf("/")+1),n=this.props.task.get("PublicUrl"),s=e.protocol+"//"+window.location.host+a+"/monitor/#"+n;this.alert(s)},onOpenMoreMenu:function(e){e.preventDefault(),e.stopPropagation()},onCloseMoreMenu:function(){l()("#monitor-more-menu").foundation("close")},renderMoreMenu:function(){if(1==this.props.task.get("Status"))var e=null;else e=s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onAssign},s().createElement("i",{className:"fa fa-users"})," ",s().createElement("span",null,"Assign GTU")));return(0,i.isInteger)(this.props.task.get("Id"))?s().createElement("span",{className:"float-right"},s().createElement("button",{className:"button cirle","data-toggle":"monitor-more-menu",onClick:this.onOpenMoreMenu},s().createElement("i",{className:"fa fa-ellipsis-h"})),s().createElement("div",{id:"monitor-more-menu",className:"dropdown-pane bottom","data-dropdown":!0,"data-close-on-click":"true","data-auto-focus":"false",onClick:this.onCloseMoreMenu},s().createElement("ul",{className:"vertical menu"},e,s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onAddEmployee},s().createElement("i",{className:"fa fa-user-plus"})," ",s().createElement("span",null,"New Employee"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onSwitchDisplayMode},s().createElement("i",{className:"cover"==this.state.displayMode?"fa fa-map":"fa fa-map-o"})," ",s().createElement("span",null,"cover"==this.state.displayMode?"Track Path":"Show Coverage"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onSwitchShowOutOfBoundaryPoints},s().createElement("i",{className:this.state.ShowOutOfBoundary?"fa fa-expand":"fa fa-compress"})," ",s().createElement("span",null,this.state.ShowOutOfBoundary?"Hide Out of Bounds":"Show Out of Bounds"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onCopyShareLink},s().createElement("i",{className:"fa fa-link"})," ",s().createElement("span",null,"URL for Distribution drivers")))))):s().createElement("span",{className:"float-right"},s().createElement("button",{className:"button cirle","data-toggle":"monitor-more-menu",onClick:this.onOpenMoreMenu},s().createElement("i",{className:"fa fa-ellipsis-h"})),s().createElement("div",{id:"monitor-more-menu",className:"dropdown-pane bottom","data-dropdown":!0,"data-close-on-click":"true","data-auto-focus":"false",onClick:this.onCloseMoreMenu},s().createElement("ul",{className:"vertical menu"},s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onSwitchDisplayMode},s().createElement("i",{className:"cover"==this.state.displayMode?"fa fa-map":"fa fa-map-o"})," ",s().createElement("span",null,"cover"==this.state.displayMode?"Track Path":"Show Coverage"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onSwitchShowOutOfBoundaryPoints},s().createElement("i",{className:this.state.ShowOutOfBoundary?"fa fa-expand":"fa fa-compress"})," ",s().createElement("span",null,this.state.ShowOutOfBoundary?"Hide Out of Bounds":"Show Out of Bounds"))))))},renderGtu:function(e){var t=null,a=null,n="button text-left",o=1==this.props.task.get("Status"),l=(0,i.indexOf)(this.state.activeGtu,e.get("Id"))>-1,r=null;if(o)r=s().createElement("i",{className:"fa fa-stop"});else switch(e.get("Role")){case"Driver":r=s().createElement("i",{className:"fa fa-truck"});break;case"Walker":r=s().createElement("i",{className:"fa fa-street-view"});break;default:r=null}return l&&(n+=" active"),o||e.get("IsOnline")||(n+=" offline"),!o&&e.get("IsOnline")&&e.get("OutOfBoundary")&&(t=s().createElement("i",{className:"fa fa-bell faa-ring animated alert"})),!o&&e.get("WithData")&&(a=s().createElement("i",{className:"fa fa-warning alert"})),s().createElement("span",{className:"group",key:e.get("Id")},s().createElement("button",{className:n,style:{backgroundColor:l?e.get("UserColor"):"transparent"},onClick:this.onSelectedGTU.bind(null,e.get("Id"))},a,r,"  ",s().createElement("span",null,e.get("ShortUniqueID")),"  ",t),s().createElement("button",{className:"button location",onClick:this.onGotoGTU.bind(null,e.get("Id"))},s().createElement("i",{className:"location fa fa-crosshairs",style:{color:"black"}})))},renderController:function(){var e=this.props.task;if(!(0,i.isInteger)(this.props.task.get("Id")))switch(e.get("Status")){case 0:return s().createElement("h5",null,"STARTED");case 1:return s().createElement("h5",null,"STOPPED");case 2:return s().createElement("h5",null,"PEASED");default:return null}switch(e.get("Status")){case 0:return s().createElement("div",null,s().createElement("button",{className:"button",onClick:this.onPause},s().createElement("i",{className:"fa fa-pause"}),"Pause"),s().createElement("button",{className:"button",onClick:this.onStop},s().createElement("i",{className:"fa fa-stop"}),"Stop"));case 1:return s().createElement("h5",null,"STOPPED");case 2:return s().createElement("div",null,s().createElement("button",{className:"button",onClick:this.onStart},s().createElement("i",{className:"fa fa-play"}),"Start"),s().createElement("button",{className:"button",onClick:this.onStop},s().createElement("i",{className:"fa fa-stop"}),"Stop"));default:return s().createElement("div",null,s().createElement("button",{className:"button",onClick:this.onStart},s().createElement("i",{className:"fa fa-play"}),"Start"))}},render:function(){var e=this,t=1==this.props.task.get("Status"),a=this.props.gtu.where((function(e){return t?e.get("WithData"):e.get("IsAssign")||e.get("WithData")}));return s().createElement("div",null,s().createElement("div",{className:"section row gtu-monitor"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"section-header"},s().createElement("div",{className:"small-12 medium-5 large-3 columns"},this.renderController()),s().createElement("div",{className:"small-12 medium-7 large-9 columns"},this.renderMoreMenu(),s().createElement("button",{className:"button float-right",onClick:this.onReCenter},s().createElement("i",{className:"fa fa-crosshairs"}),s().createElement("span",null,"Center")),s().createElement("button",{className:"button float-right",onClick:this.reload},s().createElement("i",{className:"fa fa-refresh"}),s().createElement("span",null,"Refresh")))))),s().createElement("div",{className:"row gtu"},s().createElement("div",{className:"small-12 columns"},a.map((function(t){return e.renderGtu(t)})))),s().createElement("div",{ref:"mapArea"}))}})},4241:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(7588),s=a.n(n),o=a(8896);const l=s().createClass({displayName:"loading",mixins:[o.Z],getDefaultProps:function(){return{text:"LOADING"}},render:function(){return s().createElement("div",{className:"loading"},s().createElement("div",{className:"gear one"},s().createElement("svg",{id:"blue",viewBox:"0 0 100 100",fill:"#94DDFF"},s().createElement("path",{d:"M97.6,55.7V44.3l-13.6-2.9c-0.8-3.3-2.1-6.4-3.9-9.3l7.6-11.7l-8-8L67.9,20c-2.9-1.7-6-3.1-9.3-3.9L55.7,2.4H44.3l-2.9,13.6      c-3.3,0.8-6.4,2.1-9.3,3.9l-11.7-7.6l-8,8L20,32.1c-1.7,2.9-3.1,6-3.9,9.3L2.4,44.3v11.4l13.6,2.9c0.8,3.3,2.1,6.4,3.9,9.3      l-7.6,11.7l8,8L32.1,80c2.9,1.7,6,3.1,9.3,3.9l2.9,13.6h11.4l2.9-13.6c3.3-0.8,6.4-2.1,9.3-3.9l11.7,7.6l8-8L80,67.9      c1.7-2.9,3.1-6,3.9-9.3L97.6,55.7z M50,65.6c-8.7,0-15.6-7-15.6-15.6s7-15.6,15.6-15.6s15.6,7,15.6,15.6S58.7,65.6,50,65.6z"}))),s().createElement("div",{className:"gear two"},s().createElement("svg",{id:"pink",viewBox:"0 0 100 100",fill:"#FB8BB9"},s().createElement("path",{d:"M97.6,55.7V44.3l-13.6-2.9c-0.8-3.3-2.1-6.4-3.9-9.3l7.6-11.7l-8-8L67.9,20c-2.9-1.7-6-3.1-9.3-3.9L55.7,2.4H44.3l-2.9,13.6      c-3.3,0.8-6.4,2.1-9.3,3.9l-11.7-7.6l-8,8L20,32.1c-1.7,2.9-3.1,6-3.9,9.3L2.4,44.3v11.4l13.6,2.9c0.8,3.3,2.1,6.4,3.9,9.3      l-7.6,11.7l8,8L32.1,80c2.9,1.7,6,3.1,9.3,3.9l2.9,13.6h11.4l2.9-13.6c3.3-0.8,6.4-2.1,9.3-3.9l11.7,7.6l8-8L80,67.9      c1.7-2.9,3.1-6,3.9-9.3L97.6,55.7z M50,65.6c-8.7,0-15.6-7-15.6-15.6s7-15.6,15.6-15.6s15.6,7,15.6,15.6S58.7,65.6,50,65.6z"}))),s().createElement("div",{className:"gear three"},s().createElement("svg",{id:"yellow",viewBox:"0 0 100 100",fill:"#FFCD5C"},s().createElement("path",{d:"M97.6,55.7V44.3l-13.6-2.9c-0.8-3.3-2.1-6.4-3.9-9.3l7.6-11.7l-8-8L67.9,20c-2.9-1.7-6-3.1-9.3-3.9L55.7,2.4H44.3l-2.9,13.6      c-3.3,0.8-6.4,2.1-9.3,3.9l-11.7-7.6l-8,8L20,32.1c-1.7,2.9-3.1,6-3.9,9.3L2.4,44.3v11.4l13.6,2.9c0.8,3.3,2.1,6.4,3.9,9.3      l-7.6,11.7l8,8L32.1,80c2.9,1.7,6,3.1,9.3,3.9l2.9,13.6h11.4l2.9-13.6c3.3-0.8,6.4-2.1,9.3-3.9l11.7,7.6l8-8L80,67.9      c1.7-2.9,3.1-6,3.9-9.3L97.6,55.7z M50,65.6c-8.7,0-15.6-7-15.6-15.6s7-15.6,15.6-15.6s15.6,7,15.6,15.6S58.7,65.6,50,65.6z"}))),s().createElement("div",{className:"lil-circle"}),s().createElement("div",{className:"text"},this.props.text))}})},9147:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(8896)),l=a(381),i=a.n(l);a(1167);const r=s().createBackboneClass({mixins:[o.Z],componentDidMount:function(){var e=this;this.getModel(),$(".fdatepicker").fdatepicker({format:"yyyy-mm-dd"}).on("changeDate",(function(t){e.getModel().set("Date",t.date)})),$("form").foundation()},onSave:function(e){var t=this;this.getModel().save(null,{success:function(e,a){a&&a.success?t.onClose():t.setState({error:"opps! something wrong. please contact us!"})},error:function(){t.setState({error:"opps! something wrong. please contact us!"})}}),e.preventDefault(),e.stopPropagation()},onClose:function(){$(".fdatepicker").off("changeDate").fdatepicker("remove"),this.publish("showDialog")},onChange:function(e){this.getModel().set(e.currentTarget.name,e.currentTarget.value)},render:function(){var e,t,a=this.getModel(),n=a.get("Date"),o=n?i()(n).format("YYYY-MM-DD"):"",l=a.get("Telephone");if(l){var r=l.split("@");e=r[0],t="@"+r[1]}var c=!(!this.state||!this.state.error),u=c?this.state.error:"";return s().createElement("form",{"data-abide":!0,onSubmit:this.onSave},s().createElement("h3",null,"Edit Task"),s().createElement("div",{"data-abide-error":!0,className:"alert callout",style:{display:c?"block":"none"}},s().createElement("p",null,s().createElement("i",{className:"fa fa-exclamation-circle"})," ",u)),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Name",s().createElement("input",{type:"text",value:a.get("Name"),readOnly:!0}))),s().createElement("div",{className:"small-8 columns end"},s().createElement("label",null,"Distribution Date",s().createElement("input",{className:"fdatepicker",onChange:this.onChange,name:"Date",type:"date",readOnly:!0,value:o}))),s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Select Auditor",s().createElement("input",{type:"text",defaultValue:a.get("AuditorName"),readOnly:!0}))),s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Email",s().createElement("input",{onChange:this.onChange,name:"Email",type:"text",defaultValue:a.get("Email")}))),s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Telephone",s().createElement("input",{onChange:this.onChange,name:"Telephone",type:"text",defaultValue:e}))),s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Telecommunications Operator",s().createElement("select",{defaultValue:t,onChange:this.onChange,name:"Operator"},s().createElement("option",{value:"@message.alltel.com"},"Alltel"),s().createElement("option",{value:"@txt.att.net"},"AT&T"),s().createElement("option",{value:"@messaging.nextel.com"},"Nextel"),s().createElement("option",{value:"@messaging.sprintpcs.com"},"Sprint"),s().createElement("option",{value:"@tms.suncom.com"},"SunCom"),s().createElement("option",{value:"@tmomail.net"},"T-mobile"),s().createElement("option",{value:"@voicestream.net"},"VoiceStream"),s().createElement("option",{value:"@vtext.com"},"Verizon(text only)"))))),s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"button-group float-right"},s().createElement("button",{type:"submit",className:"success button"},"Save"),s().createElement("a",{href:"javascript:;",className:"button",onClick:this.onClose},"Cancel"))),s().createElement("button",{onClick:this.onClose,className:"close-button","data-close":!0,"aria-label":"Close reveal",type:"button"},s().createElement("span",{"aria-hidden":"true"},"×")))}})},1952:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(6486)),l=a(3609),i=a.n(l),r=a(381),c=a.n(r),u=a(8896),m=a(594),p=a(4179);const d=s().createBackboneClass({mixins:[u.Z],componentWillMount:function(){},onUserSelected:function(e){this.setState({selectedUser:e})},onDbUserSelected:function(e){this.setState({selectedUser:e}),this.publish("monitor/dismiss",e)},onClose:function(){this.publish("showDialog")},onProcess:function(){this.state&&this.state.selectedUser&&this.publish("monitor/dismiss",this.state.selectedUser)},render:function(){return s().createElement("div",null,s().createElement("h5",null,"Dismiss back to Distribution Map"),s().createElement("span",null,"Assign to"),s().createElement(p.Z,{onSelect:this.onUserSelected,onDbSelect:this.onDbUserSelected,group:"distribution"}),s().createElement("div",{className:"float-right"},s().createElement("button",{className:"success button",onClick:this.onProcess},"Okay"),s().createElement("a",{href:"javascript:;",className:"button",onClick:this.onClose},"Cancel")))}});var h=a(9147);const g=s().createBackboneClass({mixins:[u.Z],menuKey:"monitor-menu-ddl-",getDefaultProps:function(){return{address:null,icon:null,name:null}},componentDidMount:function(){var e=this.menuKey;(0,o.each)(this.getModel().get("Tasks"),(function(t){i()("#"+e+t.Id).foundation()}))},onDismiss:function(e){e.preventDefault(),e.stopPropagation();var t=this,a=this.getModel();this.confirm("Are you sure you want to delete all selected Tasks?").then((function(){t.publish("showDialog",{view:d}),t.unsubscribe("monitor/dismiss"),t.subscribe("monitor/dismiss",(function(e){a.dismissToDMap(e,{success:function(e){e&&e.success?t.publish("monitor/refresh"):t.alert("something wrong")},complete:function(){t.publish("showDialog")}})}))}))},onFinished:function(e,t,a,n){n.preventDefault(),n.stopPropagation();var s=this;new m.Z({Id:e}).markFinished({success:function(e){e&&e.success?s.publish("monitor/refresh"):s.alert(e.error)}})},onOpenUploadFile:function(e){i()("#upload-file-"+e).click()},onImport:function(e,t){i()(t.currentTarget).closest(".dropdown-pane").foundation("close"),t.bubbles=!1;var a=t.currentTarget.files[0];if(0!=a.size){var n=new m.Z({Id:e}),s=this;n.importGtu(a,{success:function(t){i()("#upload-file-"+e).val(""),t&&t.success&&s.publish("monitor/refresh"),t&&t.error&&t.error.length>0&&s.alert(t.error.join("\r\n"))}})}else alert("please select an not empty file!")},onEdit:function(e,t){t.preventDefault(),t.stopPropagation(),i()(t.currentTarget).closest(".dropdown-pane").foundation("close");var a=new m.Z({Id:e}),n=this;a.fetch().then((function(){n.publish("showDialog",{view:h.Z,params:{model:a}})}))},onGotoMonitor:function(e,t,a){window.open("./#campaign/".concat(e,"/").concat(t,"/").concat(a,"/monitor"))},onOpenMoreMenu:function(e){e.preventDefault(),e.stopPropagation()},onCloseMoreMenu:function(e){i()("#".concat(this.menuKey).concat(e)).foundation("close")},renderMoreMenu:function(e){var t=this.menuKey+e;return s().createElement("span",null,s().createElement("button",{className:"button cirle","data-toggle":t,onClick:this.onOpenMoreMenu},s().createElement("i",{className:"fa fa-ellipsis-h"})),s().createElement("div",{id:t,className:"dropdown-pane bottom","data-dropdown":!0,"data-close-on-click":"true","data-auto-focus":"false",onClick:this.onCloseMoreMenu.bind(null,e)},s().createElement("ul",{className:"vertical menu"},s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onEdit.bind(null,e)},s().createElement("i",{className:"fa fa-edit"}),s().createElement("span",null,"Edit"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onOpenUploadFile.bind(null,e)},s().createElement("i",{className:"fa fa-cloud-upload"}),s().createElement("span",null,"Import"))),s().createElement("input",{type:"file",id:"upload-file-"+e,multiple:!0,style:{display:"none"},onChange:this.onImport.bind(null,e)}))))},onCompanyMonitor:function(e){window.open("./#campaign/".concat(e,"/monitor"))},render:function(){var e=this.getModel(),t=e.get("Date"),a=t?c()(t).format("MMM DD, YYYY"):"";return s().createElement("div",{className:"row scroll-list-item"},s().createElement("div",{className:"small-12 columns",onClick:this.onCompanyMonitor.bind(this,e.get("Id"))},s().createElement("div",{className:"hide-for-small-only medium-2 columns"},e.get("ClientName")),s().createElement("div",{className:"small-12 medium-5 columns"},e.get("ClientCode")),s().createElement("div",{className:"hide-for-small-only medium-2 columns"},a),s().createElement("div",{className:"small-12 medium-3 columns"},s().createElement("span",{className:"show-for-large"},e.get("AreaDescription")),s().createElement("div",{className:"float-right tool-bar"},s().createElement("a",{onClick:this.onDismiss,className:"button row-button"},s().createElement("i",{className:"fa fa-reply"}),s().createElement("small",null,"Dismiss"))))))}}),f=s().createBackboneClass({mixins:[u.Z],getInitialState:function(){return{orderByFiled:null,orderByAsc:!1,search:null,filterField:null,filterValues:[]}},componentDidMount:function(){var e=this;this.subscribe("monitor/refresh",(function(){e.getCollection().fetchForTask()})),this.subscribe("search",(function(t){e.setState({search:t,filterField:null,filterValues:[]})})),i()("#monitor-filter-ddl-ClientName, #monitor-filter-ddl-ClientCode, #monitor-filter-ddl-Date, #monitor-filter-ddl-AreaDescription").foundation()},onOrderBy:function(e,t){t.preventDefault(),t.stopPropagation(),this.state.orderByFiled==e?this.setState({orderByAsc:!this.state.orderByAsc}):this.setState({orderByFiled:e,orderByAsc:!0})},onFilter:function(e,t){t.preventDefault(),t.stopPropagation();var a=i()(":checked",t.currentTarget),n=(0,o.map)(a,(function(e){return i()(e).val()}));this.setState({filterField:n.length>0?e:null,filterValues:n.length>0?n:[],search:null}),i()("#monitor-filter-ddl-"+e).foundation("close")},onClearFilter:function(e,t){t.preventDefault(),t.stopPropagation(),i()("#monitor-filter-ddl-"+e).foundation("close"),i()(t.currentTarget).closest("form").get(0).reset(),this.setState({filterField:null,filterValues:[],search:null})},renderHeader:function(e,t){var a=this.getCollection(),n=null,l=null,i=null;if(a=a?a.toArray():[],n=this.state.orderByFiled==e?this.state.orderByAsc?s().createElement("i",{className:"fa fa-sort-up active"}):s().createElement("i",{className:"fa fa-sort-down active"}):s().createElement("i",{className:"fa fa-sort"}),n=s().createElement("a",{onClick:this.onOrderBy.bind(null,e)}," ",n),this.state.filterField&&this.state.filterField==e&&(l=s().createElement("a",{"data-toggle":"monitor-filter-ddl-"+e}," ",s().createElement("i",{className:"fa fa-filter active"}))),a){var r=(0,o.map)(a,(function(t){var a=t.get(e),n=c()(a,c().ISO_8601);return n.isValid()?n.format("MMM DD, YYYY"):a})),u=(0,o.uniq)(r).sort();i=s().createElement("div",{id:"monitor-filter-ddl-"+e,className:"dropdown-pane bottom",style:{width:"auto"},"data-dropdown":!0,"data-close-on-click":"true","data-auto-focus":"false"},s().createElement("form",{onSubmit:this.onFilter.bind(this,e)},s().createElement("ul",{className:"vertical menu"},u.map((function(t,a){return s().createElement("li",{key:e+a},s().createElement("input",{id:e+a,name:e,type:"checkbox",value:t}),s().createElement("label",{htmlFor:e+a},t))}))),s().createElement("button",{className:"button tiny success",type:"submit"},"Filter"),s().createElement("button",{className:"button tiny warning",type:"reset",onClick:this.onClearFilter.bind(this,e)},"Clear")))}return s().createElement("div",null,s().createElement("a",{"data-toggle":"monitor-filter-ddl-"+e},t),n,l,i)},getDataSource:function(){var e=this.getCollection();if(e=e?e.toArray():[],this.state.orderByFiled&&(e=(0,o.orderBy)(e,["attributes."+this.state.orderByFiled],[this.state.orderByAsc?"asc":"desc"])),this.state.search){var t=this.state.search.toLowerCase(),a=null,n=null,s=null;e=(0,o.filter)(e,(function(e){return a=(0,o.values)(e.attributes),n=(0,o.some)(a,(function(e){var a=c()(e,c().ISO_8601);return a.isValid()?a.format("MMM DD YYYY MMM DD, YYYY YYYY-MM-DD MM/DD/YYYY YYYY MM MMM DD").toLowerCase().indexOf(t)>-1:(0,o.toString)(e).toLowerCase().indexOf(t)>-1})),s=(0,o.values)(e.attributes.Tasks),(0,o.each)(s,(function(e){e.visiable=n||e.Name.toLowerCase().indexOf(t)>-1})),n||(0,o.some)(s,{visiable:!0})}))}else if(this.state.filterField&&this.state.filterValues){var l=this.state.filterField,i=this.state.filterValues;e=(0,o.filter)(e,(function(e){var t=e.get(l),a=c()(t,c().ISO_8601);return a.isValid()?(0,o.indexOf)(i,a.format("MMM DD, YYYY"))>-1:(0,o.indexOf)(i,t)>-1}))}return e},render:function(){var e=this.getDataSource();return s().createElement("div",{className:"section row"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"section-header"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 column"},s().createElement("h5",null,"GPS Monitor")),s().createElement("div",{className:"small-12 column"},s().createElement("nav",{"aria-label":"You are here:",role:"navigation"},s().createElement("ul",{className:"breadcrumbs"},s().createElement("li",null,s().createElement("a",{href:"#"},"Control Center")),s().createElement("li",null,s().createElement("span",{className:"show-for-sr"},"Current: ")," GPS Monitor")))))),s().createElement("div",{className:"scroll-list-section-body"},s().createElement("div",{className:"row scroll-list-header"},s().createElement("div",{className:"hide-for-small-only medium-2 columns"},this.renderHeader("ClientName","Client Name")),s().createElement("div",{className:"small-12 medium-5 columns"},this.renderHeader("ClientCode","Client Code")),s().createElement("div",{className:"hide-for-small-only medium-2 columns"},this.renderHeader("Date","Date")),s().createElement("div",{className:"small-12 medium-3 columns"},s().createElement("span",{className:"show-for-large"},this.renderHeader("AreaDescription","Type")))),e.map((function(e){return s().createElement(g,{key:e.get("Id"),model:e})})))))}})},9686:(e,t,a)=>{"use strict";a.d(t,{Z:()=>y}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(3609)),l=a.n(o),i=a(6486),r=a(4247),c=a(8896),u=a(8814),m=a(842);const p=s().createBackboneClass({mixins:[u.Z],onPenetrationColorsChanged:function(e){this.getModel().set("penetrationColors",e,{silent:!0})},render:function(){var e=this.getModel();return s().createElement("div",null,s().createElement("h3",null,"Print Options"),s().createElement("div",{className:"row collapse"},s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Target Method:",s().createElement("input",{type:"text",name:"targetMethod",defaultValue:e.get("targetMethod"),onChange:this.OnValueChanged})))),s().createElement("div",{className:"panel callout secondary"},s().createElement("h6",null,"Campaign Maps"),s().createElement("div",{className:"row medium-up-2 large-up-2 collapse"},s().createElement("div",{className:"column"},s().createElement("input",{id:"suppressCover",name:"suppressCover",type:"checkbox",checked:e.get("suppressCover"),onChange:this.OnValueChanged}),s().createElement("label",{htmlFor:"suppressCover"},"Suppress Cover")),s().createElement("div",{className:"column"},s().createElement("input",{id:"suppressCampaign",name:"suppressCampaign",type:"checkbox",checked:e.get("suppressCampaign"),onChange:this.OnValueChanged}),s().createElement("label",{htmlFor:"suppressCampaign"},"Suppress Campaign Page")),s().createElement("div",{className:"column"},s().createElement("input",{id:"suppressSubMap",name:"suppressSubMap",type:"checkbox",checked:e.get("suppressSubMap"),onChange:this.OnValueChanged}),s().createElement("label",{htmlFor:"suppressSubMap"},"Suppress Sub Maps")),s().createElement("div",{className:"column"},s().createElement("input",{id:"suppressCampaignSummary",name:"suppressCampaignSummary",type:"checkbox",checked:e.get("suppressCampaignSummary"),onChange:this.OnValueChanged}),s().createElement("label",{htmlFor:"suppressCampaignSummary"},"Suppress Sub Map Summary")),s().createElement("div",{className:"column"},s().createElement("input",{id:"suppressSubMapCountDetail",name:"suppressSubMapCountDetail",type:"checkbox",checked:e.get("suppressSubMapCountDetail"),onChange:this.OnValueChanged}),s().createElement("label",{htmlFor:"suppressSubMapCountDetail"},"Suppress Sub Map Croute Counts")),s().createElement("div",{className:"column"},s().createElement("input",{id:"suppressNDAInCampaign",name:"suppressNDAInCampaign",type:"checkbox",checked:e.get("suppressNDAInCampaign"),onChange:this.OnValueChanged}),s().createElement("label",{htmlFor:"suppressNDAInCampaign"},"Suppress non-deliverables for campaign map")),s().createElement("div",{className:"column"},s().createElement("input",{id:"suppressNDAInSubMap",name:"suppressNDAInSubMap",type:"checkbox",checked:e.get("suppressNDAInSubMap"),onChange:this.OnValueChanged}),s().createElement("label",{htmlFor:"suppressNDAInSubMap"},"Suppress non-deliverables for sub map")),s().createElement("div",{className:"column"},s().createElement("input",{id:"suppressLocations",name:"suppressLocations",type:"checkbox",checked:e.get("suppressLocations"),onChange:this.OnValueChanged}),s().createElement("label",{htmlFor:"suppressLocations"},"Suppress Locations")),s().createElement("div",{className:"column"},s().createElement("input",{id:"suppressRadii",name:"suppressRadii",type:"checkbox",checked:e.get("suppressRadii"),onChange:this.OnValueChanged}),s().createElement("label",{htmlFor:"suppressRadii"},"Suppress Radii"))),s().createElement("div",{className:"row small-up-1 collapse"},s().createElement("div",{className:"column"},s().createElement("input",{id:"showPenetrationColors",name:"showPenetrationColors",type:"checkbox",checked:e.get("showPenetrationColors"),onChange:this.OnValueChanged}),s().createElement("label",{htmlFor:"showPenetrationColors"},"Show Penetration Colors:")),s().createElement(m.Z,{colors:e.get("penetrationColors"),onChange:this.onPenetrationColorsChanged}))),s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"button-group float-right"},s().createElement("button",{className:"success button",onClick:this.onApply},"Apply"),s().createElement("button",{className:"button",onClick:this.onClose},"Cancel"))),s().createElement("button",{onClick:this.onClose,className:"close-button","data-close":!0,"aria-label":"Close reveal",type:"button"},s().createElement("span",{"aria-hidden":"true"},"×")))}});var d=a(2775),h=a(3250),g=a(7634),f=a(394),v=a(5635);const y=s().createBackboneClass({mixins:[c.Z],getInitialState:function(){return{options:new r.Z({suppressCover:!1,suppressCampaign:!1,suppressCampaignSummary:!1,suppressNDAInCampaign:!1,suppressSubMap:!1,suppressSubMapCountDetail:!1,suppressNDAInSubMap:!1,suppressDMap:!1,suppressGTU:!1,suppressNDAInDMap:!0,showPenetrationColors:!0,penetrationColors:[20,40,60,80],suppressLocations:!1,suppressRadii:!1})}},componentDidMount:function(){var e=this.getCollection(),t=this;this.subscribe("print.map.imageloaded",(function(){(0,i.some)(e.models,(function(e){var a=t.refs[e.get("key")];return a&&a.state&&!a.state.imageLoaded&&!1===a.state.imageLoading&&a.loadImage&&a.loadImage(),!(!a||!a.loadImage||a.state.imageLoaded)}))})),this.subscribe("print.map.options.changed",this.onApplyOptions),this.onOpenOptions({needTrigger:!0})},onOpenOptions:function(e){var t=this.state.options;t.get("DMaps")||(t.attributes.DMaps=this.getCollection().getDMaps());var a=(0,i.cloneDeep)(t),n=(0,i.extend)(e,{model:a});this.publish("showDialog",{view:p,params:n,options:{size:"large"}})},onApplyOptions:function(e){var t=["suppressNDAInCampaign","suppressNDAInSubMap","suppressNDAInDMap","showPenetrationColors","penetrationColors","suppressLocations","suppressRadii"],a=(0,i.pick)(this.state.options.attributes,t),n=(0,i.pick)(e.attributes,t);(0,i.eq)(a,n)||(0,i.each)(this.refs,(function(e){e.setState({imageLoaded:null,imageLoading:!1})})),this.setState({options:e}),this.publish("showDialog"),this.publish("print.map.imageloaded")},onPrint:function(){var e=this.getCollection(),t=e.getCampaignId(),a={campaignId:t,size:"A4",needFooter:"true",options:[]},n=this;(0,i.each)(e.models,(function(e){n.refs[e.get("key")]&&a.options.push(n.refs[e.get("key")].getExportParamters())})),e.exportPdf(a).then((function(e){var a="../api/pdf/download/"+t+"/"+e.sourceFile;0==l()("#downloadForm").size()?l()('<form id="downloadForm" action="'+a+'" method="GET"></form>').appendTo("body").get(0).submit():l()("#downloadForm").attr("action",a).get(0).submit()}))},render:function(){var e=this.getCollection(),t=this.state.options,a=(0,i.omit)(t.attributes,["DMaps"]),n=t.get("DMaps")||[],o=(0,i.map)(n.models,(function(e){return!0===e.get("Selected")?e.get("Id"):null}));return s().createElement("div",{className:"section"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center"},s().createElement("div",{className:"button-group print-toolbar"},s().createElement("button",{className:"button",onClick:this.onOpenOptions},s().createElement("i",{className:"fa fa-cog"}),"Options"),s().createElement("button",{className:"button",onClick:this.onPrint},s().createElement("i",{className:"fa fa-print"}),"Print")))),s().createElement("div",{className:"page-container A4"},e.map((function(e){var t=e.get("DMapId");if(t&&(0,i.indexOf)(o,t)>-1)return null;switch(e.get("type")){case"Cover":return a.suppressCover?null:s().createElement(d.Z,{ref:e.get("key"),key:e.get("key"),model:e,options:a});case"Campaign":return a.suppressCampaign?null:s().createElement(h.Z,{ref:e.get("key"),key:e.get("key"),model:e,options:a});case"CampaignSummary":return a.suppressCampaign||a.suppressCampaignSummary?null:s().createElement(g.Z,{ref:e.get("key"),key:e.get("key"),model:e,options:a});case"SubMap":return a.suppressSubMap?null:s().createElement(f.Z,{ref:e.get("key"),key:e.get("key"),model:e,options:a});case"SubMapDetail":return a.suppressSubMap||a.suppressSubMapCountDetail?null:s().createElement(v.Z,{ref:e.get("key"),key:e.get("key"),model:e,options:a});default:return null}}))))}})},3942:(e,t,a)=>{"use strict";a.d(t,{Z:()=>E}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(3609)),l=a.n(o),i=a(6486),r=a(4247),c=a(8896),u=a(8814),m=a(1666);const p=s().createBackboneClass({mixins:[u.Z],render:function(){var e=this.getModel();return s().createElement("div",null,s().createElement("h3",null,"Print Options"),s().createElement("div",{className:"panel callout secondary"},s().createElement("h6",null,"Distribution Maps"),s().createElement("div",{className:"row medium-up-1 large-up-2 collapse"},s().createElement("div",{className:"column"},s().createElement("input",{id:"suppressDMap",name:"suppressDMap",type:"checkbox",checked:e.get("suppressDMap"),onChange:this.OnValueChanged}),s().createElement("label",{htmlFor:"suppressDMap"},"Suppress Distribution Maps")),s().createElement("div",{className:"column"},s().createElement("input",{id:"suppressNDAInDMap",name:"suppressNDAInDMap",type:"checkbox",checked:e.get("suppressNDAInDMap"),onChange:this.OnValueChanged}),s().createElement("label",{htmlFor:"suppressNDAInDMap"},"Suppress non-deliverables for distribution map")))),s().createElement(m.Z,{collection:e.get("DMaps")}),s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"button-group float-right"},s().createElement("button",{className:"success button",onClick:this.onApply},"Apply"),s().createElement("button",{className:"button",onClick:this.onClose},"Cancel"))),s().createElement("button",{onClick:this.onClose,className:"close-button","data-close":!0,"aria-label":"Close reveal",type:"button"},s().createElement("span",{"aria-hidden":"true"},"×")))}});var d=a(2077),h=a.n(d),g=(a(381),a(4241)),f=a(2708);const v=s().createBackboneClass({mixins:[c.Z],getInitialState:function(){return{imageLoaded:null,imageLoading:!1}},componentDidMount:function(){this.publish("print.map.imageloaded")},scrollToPage:function(){this.getModel();var e=l()(this.refs.page).position().top;l()(".off-canvas-wrapper-inner").stop().animate({scrollTop:e},600)},preloadImage:function(e){var t=l().Deferred();return l()(new Image).one("load",(function(){t.resolve()})).attr("src",e),t},loadImage:function(){var e=this.getModel(),t=(e.get("key"),this);this.setState({imageLoaded:null,imageLoading:!0}),this.scrollToPage(),e.fetchMapImage(this.props.options).then((function(){var a=l().Deferred(),n=e.get("MapImage"),s=e.get("PolygonImage");return(0,i.isEmpty)(n)||(0,i.isEmpty)(s)?a.reject():l().when(t.preloadImage(n),t.preloadImage(s)).done((function(){a.resolve()})),a})).always((function(){t.setState({imageLoaded:!0,imageLoading:!1}),t.publish("print.map.imageloaded")}))},onReloadImage:function(e){e.stopPropagation(),this.setState({imageLoaded:null,imageLoading:!1}),this.publish("print.map.imageloaded")},onCreateDetailMap:function(e){var t=this.getModel(),a=t.collection,n=t.clone(),s=n.get("DMapId"),o=e.getNorthEast(),l=e.getSouthWest(),r=0,c=0,u=t.get("key")+"-"+o.lat()+"-"+o.lng()+"-"+l.lat()+"-"+l.lng();(0,i.each)(a.models,(function(e,t){e.get("DMapId")==s&&(c++,r=t)})),n.set({key:u,type:"DistributionDetail",TopRight:{lat:o.lat(),lng:o.lng()},BottomLeft:{lat:l.lat(),lng:l.lng()},Boundary:null,ImageStatus:"waiting",MapImage:null,PolygonImage:null,Serial:c}),a.add(n,{at:r+1}),this.publish("showDialog");var m=this;setTimeout((function(){m.publish("print.map.imageloaded")}),500)},onShowEditDialog:function(){var e=this.getModel(),t=this,a=l().Deferred();this.state.imageLoaded&&e.get("MapImage")&&e.get("PolygonImage")&&(this.publish("showLoading"),e.get("Boundary")?a.resolve():a=e.fetchBoundary({quite:!0}),a.done((function(){var a=e.get("Color"),n="distribution-"+e.get("DMapId");t.unsubscribe("print.mapzoom@"+n),t.subscribe("print.mapzoom@"+n,l().proxy(t.onCreateDetailMap,t)),t.publish("showDialog",{view:f.Z,params:{sourceKey:n,boundary:e.get("Boundary"),color:"rgb("+a.r+","+a.g+","+a.b+")"},options:{size:"full",customClass:"google-map-pop"}})})))},getExportParamters:function(){var e=this.getModel();return{type:"dmap",options:[{title:"DM MAP "+e.get("DMapId")+"("+e.get("Name")+")"},{list:[{key:"DM MAP #:",text:e.get("DMapId")+""},{key:"DISTRIBUTION MAP NAME:",text:e.get("Name")},{key:"TOTAL:",text:h()(e.get("Total")).format("0,0")}]},{title:e.get("DisplayName")+" - "+e.get("Name")},{map:e.get("PolygonImage"),bg:e.get("MapImage")}]}},render:function(){var e=this.getModel(),t=h()(e.get("Total")).format("0,0"),a=e.get("MapImage"),n=e.get("PolygonImage");if(this.state.imageLoaded)if(a&&n){var o={backgroundImage:"url("+a+")",backgroundRepeat:"no-repeat",backgroundSize:"100% auto",backgroundPosition:"0 0"};a=s().createElement("div",{style:o},s().createElement("img",{src:n}))}else a=s().createElement("button",{className:"button reload",onClick:this.onReloadImage},s().createElement("i",{className:"fa fa-2x fa-refresh"}));else a=s().createElement(g.Z,{text:this.state.imageLoading?"LOADING":"WAITING"});return s().createElement("div",{className:"page",ref:"page"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center title"},"DM MAP ",e.get("DMapId"),"(",e.get("Name"),")")),s().createElement("div",{className:"row list",role:"list"},s().createElement("div",{className:"small-4 columns"},"DM MAP #:"),s().createElement("div",{className:"small-8 columns"}," ",e.get("DMapId")),s().createElement("div",{className:"small-4 columns"},"DISTRIBUTION MAP NAME:"),s().createElement("div",{className:"small-8 columns"}," ",e.get("Name")),s().createElement("div",{className:"small-4 columns"},"TOTAL:"),s().createElement("div",{className:"small-8 columns"}," ",t)),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center title mapTitle"},e.get("DisplayName")," - ",e.get("Name"))),s().createElement("div",{className:"row collapse"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"map-container",onClick:this.onShowEditDialog},a))))}}),y=s().createBackboneClass({mixins:[c.Z],getInitialState:function(){return{imageLoaded:null,imageLoading:!1}},componentDidMount:function(){this.publish("print.map.imageloaded")},preloadImage:function(e){var t=l().Deferred();return l()(new Image).one("load",(function(){t.resolve()})).attr("src",e),t},scrollToPage:function(){this.getModel();var e=l()(this.refs.page).position().top;l()("body").stop().animate({scrollTop:e},600)},loadImage:function(){var e=this.getModel(),t=(e.get("key"),this);this.setState({imageLoaded:null,imageLoading:!0}),this.scrollToPage(),e.fetchMapImage(this.props.options).then((function(){var a=l().Deferred(),n=e.get("MapImage"),s=e.get("PolygonImage");return(0,i.isEmpty)(n)||(0,i.isEmpty)(s)?a.reject():l().when(t.preloadImage(n),t.preloadImage(s)).done((function(){a.resolve()})),a})).always((function(){t.setState({imageLoaded:!0,imageLoading:!1}),t.publish("print.map.imageloaded")}))},onReloadImage:function(){this.setState({imageLoaded:null}),this.publish("print.map.imageloaded")},onRemove:function(){var e=this.getModel(),t=e.get("DMapId"),a=e.get("Serial"),n=e.collection;n.remove(e),(0,i.each)(n.models,(function(e){var n=e.get("DMapId"),s=e.get("Serial");n==t&&s>a&&e.set("Serial",s-1)}))},getExportParamters:function(){var e=this.getModel();return{type:"dmap",options:[{title:"DM MAP "+e.get("DMapId")+"("+e.get("Name")+") -- "+e.get("Serial")},{list:[{key:"DM MAP #",text:e.get("DMapId")+""},{key:"DISTRIBUTION MAP NAME",text:e.get("Name")},{key:"TOTAL",text:h()(e.get("Total")).format("0,0")}]},{title:e.get("DisplayName")+" - "+e.get("Name")},{map:e.get("PolygonImage"),bg:e.get("MapImage")}]}},render:function(){var e=this.getModel(),t=h()(e.get("Total")).format("0,0"),a=e.get("MapImage"),n=e.get("PolygonImage");if(this.state.imageLoaded)if(a&&n){var o={backgroundImage:"url("+a+")",backgroundRepeat:"no-repeat",backgroundSize:"100% auto",backgroundPosition:"0 0"};a=s().createElement("div",{style:o},s().createElement("img",{src:n}))}else a=s().createElement("button",{className:"button reload",onClick:this.onReloadImage},s().createElement("i",{className:"fa fa-2x fa-refresh"}));else a=s().createElement(g.Z,{text:this.state.imageLoading?"LOADING":"WAITING"});return s().createElement("div",{className:"page",ref:"page"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center title"},"DM MAP ",e.get("DMapId"),"(",e.get("Name"),") -- ",e.get("Serial"),s().createElement("button",{className:"button float-right",onClick:this.onRemove},s().createElement("i",{className:"fa fa-delete"}),"Remove"))),s().createElement("div",{className:"row list",role:"list"},s().createElement("div",{className:"small-4 columns"},"DM MAP #:"),s().createElement("div",{className:"small-8 columns"}," ",e.get("DMapId")),s().createElement("div",{className:"small-4 columns"},"DISTRIBUTION MAP NAME:"),s().createElement("div",{className:"small-8 columns"}," ",e.get("Name")),s().createElement("div",{className:"small-4 columns"},"TOTAL:"),s().createElement("div",{className:"small-8 columns"}," ",t)),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center title mapTitle"},e.get("DisplayName")," - ",e.get("Name"))),s().createElement("div",{className:"row collapse"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"map-container"},a))))}}),E=s().createBackboneClass({mixins:[c.Z],getInitialState:function(){return{options:new r.Z({suppressCover:!0,suppressCampaign:!0,suppressCampaignSummary:!0,suppressNDAInCampaign:!0,suppressSubMap:!0,suppressSubMapCountDetail:!0,suppressNDAInSubMap:!0,suppressDMap:!1,suppressGTU:!0,suppressNDAInDMap:!0,suppressLocations:!0,suppressRadii:!0})}},componentDidMount:function(){var e=this.getCollection(),t=this;this.subscribe("print.map.imageloaded",(function(){(0,i.some)(e.models,(function(e){var a=t.refs[e.get("key")];return a&&a.state&&!a.state.imageLoaded&&0==a.state.imageLoading&&a.loadImage(),!(!a||!a.loadImage||a.state.imageLoaded)}))})),this.subscribe("print.map.options.changed",this.onApplyOptions),this.onOpenOptions({needTrigger:!0})},onOpenOptions:function(e){var t=this.state.options;t.get("DMaps")||(t.attributes.DMaps=this.getCollection().getDMaps());var a=(0,i.cloneDeep)(t),n=(0,i.extend)(e,{model:a});this.publish("showDialog",{view:p,params:n,options:{size:"large"}})},onApplyOptions:function(e){var t=this,a=["suppressDMap","suppressNDAInDMap"],n=(0,i.pick)(this.state.options.attributes,a),s=(0,i.pick)(e.attributes,a);(0,i.eq)(n,s)||(0,i.each)(this.refs,(function(e){e.setState({imageLoaded:null})})),this.setState({options:e},(function(){t.publish("showDialog"),t.publish("print.map.imageloaded")}))},onPrint:function(){var e=this.getCollection(),t=e.getCampaignId(),a={campaignId:t,size:"Distribute",needFooter:"false",options:[]},n=this;(0,i.each)(e.models,(function(e){n.refs[e.get("key")]&&a.options.push(n.refs[e.get("key")].getExportParamters())})),e.exportPdf(a).then((function(e){var a="../api/pdf/download/"+t+"/"+e.sourceFile;0==l()("#downloadForm").size()?l()('<form id="downloadForm" action="'+a+'" method="GET"></form>').appendTo("body").get(0).submit():l()("#downloadForm").attr("action",a).get(0).submit()}))},render:function(){var e=this.getCollection(),t=this.state.options,a=(0,i.omit)(t.attributes,["DMaps"]),n=t.get("DMaps")||[],o=(0,i.map)(n.models,(function(e){return!0===e.get("Selected")?e.get("Id"):null}));return s().createElement("div",{className:"section"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center"},s().createElement("div",{className:"button-group print-toolbar"},s().createElement("button",{className:"button",onClick:this.onOpenOptions},s().createElement("i",{className:"fa fa-cog"}),"Options"),s().createElement("button",{className:"button",onClick:this.onPrint},s().createElement("i",{className:"fa fa-print"}),"Print")))),s().createElement("div",{className:"page-container distribution-print"},e.map((function(e){var t=e.get("DMapId");if(t&&(0,i.indexOf)(o,t)>-1)return null;switch(e.get("type")){case"DistributionDetail":return s().createElement(y,{ref:e.get("key"),key:e.get("key"),model:e,options:a});default:return s().createElement(v,{ref:e.get("key"),key:e.get("key"),model:e,options:a})}}))))}})},2598:(t,a,n)=>{"use strict";n.d(a,{Z:()=>I}),n(2316);var s=n(7588),o=n.n(s),l=(n(456),n(3609)),i=n.n(l),r=n(6486),c=n(4247),u=n(8896),m=n(8814),p=n(842),d=n(1666);const h=o().createBackboneClass({mixins:[m.Z],onPenetrationColorsChanged:function(e){this.getModel().set("penetrationColors",e,{silent:!0})},render:function(){var e=this.getModel();return o().createElement("div",null,o().createElement("h3",null,"Print Options"),o().createElement("div",{className:"row collapse"},o().createElement("div",{className:"small-12 columns"},o().createElement("label",null,"Target Method:",o().createElement("input",{type:"text",name:"targetMethod",defaultValue:e.get("targetMethod"),onChange:this.OnValueChanged})))),o().createElement("div",{className:"panel callout secondary"},o().createElement("h6",null,"Campaign Maps"),o().createElement("div",{className:"row medium-up-2 large-up-2 collapse"},o().createElement("div",{className:"column"},o().createElement("input",{id:"suppressCover",name:"suppressCover",type:"checkbox",checked:e.get("suppressCover"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"suppressCover"},"Suppress Cover")),o().createElement("div",{className:"column"},o().createElement("input",{id:"suppressCampaign",name:"suppressCampaign",type:"checkbox",checked:e.get("suppressCampaign"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"suppressCampaign"},"Suppress Campaign Page")),o().createElement("div",{className:"column"},o().createElement("input",{id:"suppressSubMap",name:"suppressSubMap",type:"checkbox",checked:e.get("suppressSubMap"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"suppressSubMap"},"Suppress Sub Maps")),o().createElement("div",{className:"column"},o().createElement("input",{id:"suppressCampaignSummary",name:"suppressCampaignSummary",type:"checkbox",checked:e.get("suppressCampaignSummary"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"suppressCampaignSummary"},"Suppress Sub Map Summary")),o().createElement("div",{className:"column"},o().createElement("input",{id:"suppressSubMapCountDetail",name:"suppressSubMapCountDetail",type:"checkbox",checked:e.get("suppressSubMapCountDetail"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"suppressSubMapCountDetail"},"Suppress Sub Map Croute Counts")),o().createElement("div",{className:"column"},o().createElement("input",{id:"suppressNDAInCampaign",name:"suppressNDAInCampaign",type:"checkbox",checked:e.get("suppressNDAInCampaign"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"suppressNDAInCampaign"},"Suppress non-deliverables for campaign map")),o().createElement("div",{className:"column"},o().createElement("input",{id:"suppressNDAInSubMap",name:"suppressNDAInSubMap",type:"checkbox",checked:e.get("suppressNDAInSubMap"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"suppressNDAInSubMap"},"Suppress non-deliverables for sub map")),o().createElement("div",{className:"column"},o().createElement("input",{id:"suppressLocations",name:"suppressLocations",type:"checkbox",checked:e.get("suppressLocations"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"suppressLocations"},"Suppress Locations")),o().createElement("div",{className:"column"},o().createElement("input",{id:"suppressRadii",name:"suppressRadii",type:"checkbox",checked:e.get("suppressRadii"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"suppressRadii"},"Suppress Radii"))),o().createElement("div",{className:"row small-up-1 collapse"},o().createElement("div",{className:"column"},o().createElement("input",{id:"showPenetrationColors",name:"showPenetrationColors",type:"checkbox",checked:e.get("showPenetrationColors"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"showPenetrationColors"},"Show Penetration Colors:")),o().createElement(p.Z,{colors:e.get("penetrationColors"),onChange:this.onPenetrationColorsChanged}))),o().createElement("div",{className:"panel callout secondary"},o().createElement("h6",null,"GTU Reports"),o().createElement("div",{className:"row medium-up-1 large-up-2 collapse"},o().createElement("div",{className:"column"},o().createElement("input",{id:"suppressGTU",name:"suppressGTU",type:"checkbox",checked:e.get("suppressGTU"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"suppressGTU"},"Suppress GTU Tracking")))),o().createElement("div",{className:"panel callout secondary"},o().createElement("h6",null,"Distribution Maps"),o().createElement("div",{className:"row medium-up-1 large-up-2 collapse"},o().createElement("div",{className:"column"},o().createElement("input",{id:"suppressDMap",name:"suppressDMap",type:"checkbox",checked:e.get("suppressDMap"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"suppressDMap"},"Suppress Distribution Maps")),o().createElement("div",{className:"column"},o().createElement("input",{id:"suppressNDAInDMap",name:"suppressNDAInDMap",type:"checkbox",checked:e.get("suppressNDAInDMap"),onChange:this.OnValueChanged}),o().createElement("label",{htmlFor:"suppressNDAInDMap"},"Suppress non-deliverables for distribution map")))),o().createElement(d.Z,{collection:e.get("DMaps")}),o().createElement("div",{className:"small-12 columns"},o().createElement("div",{className:"button-group float-right"},o().createElement("button",{className:"success button",onClick:this.onApply},"Apply"),o().createElement("button",{className:"button",onClick:this.onClose},"Cancel"))),o().createElement("button",{onClick:this.onClose,className:"close-button","data-close":!0,"aria-label":"Close reveal",type:"button"},o().createElement("span",{"aria-hidden":"true"},"×")))}});var g=n(2775),f=n(3250),v=n(7634),y=n(394),E=n(5635),b=n(2077),M=n.n(b),N=n(4241),C=n(5676),w=n(2708);const k=o().createBackboneClass({mixins:[u.Z],getInitialState:function(){return{imageLoaded:null,imageLoading:!1}},componentDidMount:function(){this.publish("print.map.imageloaded")},scrollToPage:function(){this.getModel();var e=i()(this.refs.page).position().top;i()("body").stop().animate({scrollTop:e},600)},preloadImage:function(e){var t=i().Deferred();return i()(new Image).one("load",(function(){t.resolve()})).attr("src",e),t},loadImage:function(){var e=this.getModel(),t=(e.get("key"),this);this.setState({imageLoaded:null,imageLoading:!0}),this.scrollToPage(),e.fetchMapImage(this.props.options).then((function(){var a=i().Deferred(),n=e.get("MapImage"),s=e.get("PolygonImage");return(0,r.isEmpty)(n)||(0,r.isEmpty)(s)?a.reject():i().when(t.preloadImage(n),t.preloadImage(s)).done((function(){a.resolve()})),a})).always((function(){t.setState({imageLoaded:!0,imageLoading:!1}),t.publish("print.map.imageloaded")}))},onReloadImage:function(e){e.stopPropagation(),this.setState({imageLoaded:null,imageLoading:!1}),this.publish("print.map.imageloaded")},onShowEditDialog:function(){var e=this.getModel(),t=this,a=i().Deferred();this.state.imageLoaded&&e.get("MapImage")&&e.get("PolygonImage")&&(this.publish("showLoading"),e.get("Boundary")?a.resolve():a=e.fetchBoundary({quite:!0}),a.done((function(){var a=e.get("Color"),n="dmap-"+e.get("DMapId");t.unsubscribe("print.mapzoom@"+n),t.subscribe("print.mapzoom@"+n,i().proxy(t.onCreateDetailMap,t)),t.publish("showDialog",{view:w.Z,params:{sourceKey:n,boundary:e.get("Boundary"),color:"rgb("+a.r+","+a.g+","+a.b+")"},options:{size:"full",customClass:"google-map-pop"}})})))},onCreateDetailMap:function(e){var t=this,a=this.getModel(),n=a.collection,s=a.clone(),o=s.get("DMapId"),l=e.getNorthEast(),i=e.getSouthWest(),c=0,u=0,m=a.get("key")+"-"+l.lat()+"-"+l.lng()+"-"+i.lat()+"-"+i.lng();(0,r.each)(n.models,(function(e,t){e.get("DMapId")==o&&(u++,c=t)})),s.set({key:m,type:"DMapDetailMap",TopRight:{lat:l.lat(),lng:l.lng()},BottomLeft:{lat:i.lat(),lng:i.lng()},ImageStatus:"waiting",MapImage:null,PolygonImage:null,Serial:u}),n.add(s,{at:c+1}),this.publish("showDialog"),setTimeout((function(){t.publish("print.map.imageloaded")}),500)},getExportParamters:function(){var e=this.getModel();return{type:"dmap",options:[{title:"DM MAP "+e.get("DMapId")+"("+e.get("Name")+")"},{list:[{key:"DM MAP #:",text:e.get("DMapId")+""},{key:"DISTRIBUTION MAP NAME:",text:e.get("Name")},{key:"TOTAL:",text:M()(e.get("Total")).format("0,0")}]},{title:e.get("DisplayName")+" - "+e.get("Name")},{map:e.get("PolygonImage"),bg:e.get("MapImage"),legend:!0}]}},render:function(){var e=this.getModel(),t=M()(e.get("Total")).format("0,0"),a=e.get("MapImage"),n=e.get("PolygonImage");if(this.state.imageLoaded)if(a&&n){var s={backgroundImage:"url("+a+")",backgroundRepeat:"no-repeat",backgroundSize:"100% auto",backgroundPosition:"0 0"};a=o().createElement("div",{style:s},o().createElement("img",{src:n}))}else a=o().createElement("button",{className:"button reload",onClick:this.onReloadImage},o().createElement("i",{className:"fa fa-2x fa-refresh"}));else a=o().createElement(N.Z,{text:this.state.imageLoading?"LOADING":"WAITING"});return o().createElement("div",{key:"DMAP-".concat(e.get("DMapId")),className:"page",ref:"page"},o().createElement("div",{className:"row"},o().createElement("div",{className:"small-12 columns text-center title"},"DM MAP ",e.get("DMapId"),"(",e.get("Name"),")")),o().createElement("div",{className:"row list",role:"list"},o().createElement("div",{className:"small-4 columns"},"DM MAP #:"),o().createElement("div",{className:"small-8 columns"}," ",e.get("DMapId")),o().createElement("div",{className:"small-4 columns"},"DISTRIBUTION MAP NAME:"),o().createElement("div",{className:"small-8 columns"}," ",e.get("Name")),o().createElement("div",{className:"small-4 columns"},"TOTAL:"),o().createElement("div",{className:"small-8 columns"}," ",t)),o().createElement("div",{className:"row"},o().createElement("div",{className:"small-12 columns text-center title"},e.get("DisplayName")," - ",e.get("Name"))),o().createElement("div",{className:"row collapse"},o().createElement("div",{className:"small-12 columns"},o().createElement("div",{className:"map-container",onClick:this.onShowEditDialog},a),o().createElement("div",{className:"small-12 columns"},o().createElement("div",{className:"color-legend"}),o().createElement("div",{className:"direction-legend"})))),o().createElement(C.Z,{model:e.get("Footer")}))}}),D=o().createBackboneClass({mixins:[u.Z],getInitialState:function(){return{imageLoaded:null,imageLoading:!1}},componentDidMount:function(){this.publish("print.map.imageloaded")},scrollToPage:function(){this.getModel();var e=i()(this.refs.page).position().top;i()("body").stop().animate({scrollTop:e},600)},preloadImage:function(e){var t=i().Deferred();return i()(new Image).one("load",(function(){t.resolve()})).attr("src",e),t},loadImage:function(){var e=this.getModel(),t=(e.get("key"),this);this.setState({imageLoaded:null,imageLoading:!0}),this.scrollToPage(),e.fetchMapImage(this.props.options).then((function(){var a=i().Deferred(),n=e.get("MapImage"),s=e.get("PolygonImage");return(0,r.isEmpty)(n)||(0,r.isEmpty)(s)?a.reject():i().when(t.preloadImage(n),t.preloadImage(s)).done((function(){a.resolve()})),a})).always((function(){t.setState({imageLoaded:!0,imageLoading:!1}),t.publish("print.map.imageloaded")}))},onReloadImage:function(){e.stopPropagation(),this.setState({imageLoaded:null,imageLoading:!1}),this.publish("print.map.imageloaded")},onRemove:function(){var e=this.getModel(),t=e.get("DMapId"),a=e.get("Serial"),n=e.collection;n.remove(e),(0,r.each)(n.models,(function(e){var n=e.get("DMapId"),s=e.get("Serial");n==t&&s>a&&e.set("Serial",s-1)}))},getExportParamters:function(){var e=this.getModel();return{type:"dmap",options:[{title:"DM MAP "+e.get("DMapId")+"("+e.get("Name")+") -- "+e.get("Serial")},{list:[{key:"DM MAP #:",text:e.get("DMapId")+""},{key:"DISTRIBUTION MAP NAME:",text:e.get("Name")},{key:"TOTAL:",text:M()(e.get("Total")).format("0,0")}]},{title:e.get("DisplayName")+" - "+e.get("Name")},{map:e.get("PolygonImage"),bg:e.get("MapImage"),legend:!0}]}},render:function(){var e=this.getModel(),t=M()(e.get("Total")).format("0,0"),a=e.get("MapImage"),n=e.get("PolygonImage");if(this.state.imageLoaded)if(a&&n){var s={backgroundImage:"url("+a+")",backgroundRepeat:"no-repeat",backgroundSize:"100% auto",backgroundPosition:"0 0"};a=o().createElement("div",{style:s},o().createElement("img",{src:n}))}else a=o().createElement("button",{className:"button reload",onClick:this.onReloadImage},o().createElement("i",{className:"fa fa-2x fa-refresh"}));else a=o().createElement(N.Z,{text:this.state.imageLoading?"LOADING":"WAITING"});return o().createElement("div",{className:"page",ref:"page"},o().createElement("div",{className:"row"},o().createElement("div",{className:"small-12 columns text-center title"},"DM MAP ",e.get("DMapId"),"(",e.get("Name"),") -- ",e.get("Serial"),o().createElement("button",{className:"button float-right",onClick:this.onRemove},o().createElement("i",{className:"fa fa-delete"}),"Remove"))),o().createElement("div",{className:"row list",role:"list"},o().createElement("div",{className:"small-4 columns"},"DM MAP #:"),o().createElement("div",{className:"small-8 columns"}," ",e.get("DMapId")),o().createElement("div",{className:"small-4 columns"},"DISTRIBUTION MAP NAME:"),o().createElement("div",{className:"small-8 columns"}," ",e.get("Name")),o().createElement("div",{className:"small-4 columns"},"TOTAL:"),o().createElement("div",{className:"small-8 columns"}," ",t)),o().createElement("div",{className:"row"},o().createElement("div",{className:"small-12 columns text-center title"},e.get("DisplayName")," - ",e.get("Name"))),o().createElement("div",{className:"row collapse"},o().createElement("div",{className:"small-12 columns"},o().createElement("div",{className:"map-container"},a),o().createElement("div",{className:"small-12 columns"},o().createElement("div",{className:"color-legend"}),o().createElement("div",{className:"direction-legend"})))),o().createElement(C.Z,{model:e.get("Footer")}))}}),I=o().createBackboneClass({mixins:[u.Z],getInitialState:function(){return{options:new c.Z({suppressCover:!1,suppressCampaign:!1,suppressCampaignSummary:!1,suppressNDAInCampaign:!1,suppressSubMap:!1,suppressSubMapCountDetail:!1,suppressNDAInSubMap:!1,suppressDMap:!1,suppressGTU:!1,suppressNDAInDMap:!0,showPenetrationColors:!0,penetrationColors:[20,40,60,80],suppressLocations:!1,suppressRadii:!1})}},componentDidMount:function(){var e=this.getCollection(),t=this;this.subscribe("print.map.imageloaded",(function(){(0,r.some)(e.models,(function(e){var a=t.refs[e.get("key")];if(a&&a.state&&!a.state.imageLoaded&&!1===a.state.imageLoading&&a.loadImage)return a.loadImage(),!0}))})),this.subscribe("print.map.options.changed",this.onApplyOptions),this.onOpenOptions({needTrigger:!0})},onOpenOptions:function(e){var t=this.state.options;t.get("DMaps")||(t.attributes.DMaps=this.getCollection().getDMaps());var a=(0,r.cloneDeep)(t),n=(0,r.extend)(e,{model:a});this.publish("showDialog",{view:h,params:n,options:{size:"large"}})},onApplyOptions:function(e){var t=this,a=["suppressNDAInCampaign","suppressNDAInSubMap","suppressNDAInDMap","showPenetrationColors","penetrationColors","suppressLocations","suppressRadii"],n=(0,r.pick)(this.state.options.attributes,a),s=(0,r.pick)(e.attributes,a);(0,r.eq)(n,s)||(0,r.each)(this.refs,(function(e){e.setState({imageLoaded:null})})),this.setState({options:e},(function(){t.publish("showDialog"),t.publish("print.map.imageloaded")}))},onPrint:function(){var e=this.getCollection(),t=e.getCampaignId(),a={campaignId:t,size:"A4",needFooter:"true",options:[]},n=this;(0,r.each)(e.models,(function(e){n.refs[e.get("key")]&&a.options.push(n.refs[e.get("key")].getExportParamters())})),e.exportPdf(a).then((function(e){var a="../api/pdf/download/"+t+"/"+e.sourceFile;0==i()("#downloadForm").size()?i()('<form id="downloadForm" action="'+a+'" method="GET"></form>').appendTo("body").get(0).submit():i()("#downloadForm").attr("action",a).get(0).submit()}))},render:function(){var e=this.getCollection(),t=this.state.options,a=(0,r.omit)(t.attributes,["DMaps"]),n=t.get("DMaps")||[],s=(0,r.map)(n.models,(function(e){return!0===e.get("Selected")?e.get("Id"):null}));return o().createElement("div",{className:"section"},o().createElement("div",{className:"row"},o().createElement("div",{className:"small-12 columns text-center"},o().createElement("div",{className:"button-group print-toolbar"},o().createElement("button",{className:"button",onClick:this.onOpenOptions},o().createElement("i",{className:"fa fa-cog"}),"Options"),o().createElement("button",{className:"button",onClick:this.onPrint},o().createElement("i",{className:"fa fa-print"}),"Print")))),o().createElement("div",{className:"page-container A4"},e.map((function(e){switch(e.get("type")){case"Cover":return a.suppressCover?null:o().createElement(g.Z,{ref:e.get("key"),key:e.get("key"),model:e,options:a});case"Campaign":return a.suppressCampaign?null:o().createElement(f.Z,{ref:e.get("key"),key:e.get("key"),model:e,options:a});case"CampaignSummary":return a.suppressCampaign||a.suppressCampaignSummary?null:o().createElement(v.Z,{ref:e.get("key"),key:e.get("key"),model:e,options:a});case"SubMap":return a.suppressSubMap?null:o().createElement(y.Z,{ref:e.get("key"),key:e.get("key"),model:e,options:a});case"SubMapDetail":return a.suppressSubMap||a.suppressSubMapCountDetail?null:o().createElement(E.Z,{ref:e.get("key"),key:e.get("key"),model:e,options:a});case"DMap":return a.suppressDMap||(0,r.indexOf)(s,e.get("DMapId"))>-1?null:o().createElement(k,{ref:e.get("key"),key:e.get("key"),model:e,options:a});case"DMapDetailMap":return a.suppressDMap||(0,r.indexOf)(s,e.get("DMapId"))>-1?null:o().createElement(D,{ref:e.get("key"),key:e.get("key"),model:e,options:a});default:return null}}))))}})},3250:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(3609)),l=a.n(o),i=a(2077),r=a.n(i),c=a(6486),u=a(8896),m=a(4241),p=a(5676);const d=s().createBackboneClass({mixins:[u.Z],getInitialState:function(){return{imageLoaded:null,imageLoading:!1}},componentDidMount:function(){this.publish("print.map.imageloaded")},scrollToPage:function(){this.getModel();var e=l()(this.refs.page).position().top;l()(".off-canvas-wrapper-inner").stop().animate({scrollTop:e},600)},preloadImage:function(e){var t=l().Deferred();return l()(new Image).one("load",(function(){t.resolve()})).attr("src",e),t},loadImage:function(){var e=this.getModel(),t=(e.get("key"),this);this.setState({imageLoaded:null,imageLoading:!0}),this.scrollToPage(),e.fetchMapImage(this.props.options).then((function(){var a=l().Deferred(),n=e.get("MapImage"),s=e.get("PolygonImage");return(0,c.isEmpty)(n)||(0,c.isEmpty)(s)?a.reject():l().when(t.preloadImage(n),t.preloadImage(s)).done((function(){a.resolve()})),a})).always((function(){t.setState({imageLoaded:!0,imageLoading:!1}),t.publish("print.map.imageloaded")}))},onReloadImage:function(){this.setState({imageLoaded:null,imageLoading:!1}),this.publish("print.map.imageloaded")},formatePenetrationColor:function(e){var t=["Blue","Green","Yellow","Orange","Red"],a=[0].concat(e),n=0,o=[];a.push(100);for(var l=0;l<a.length-1;l++)n>=a[l+1]||(o.push(s().createElement("i",{key:"i"+l,className:t[l].toLowerCase()})),o.push(s().createElement("label",{key:"l"+l},t[l]+"("+a[l]+"%-"+a[l+1]+"%)")),n=a[l+1]);return s().createElement("div",{className:"color-legend"},s().createElement("div",{key:"tips",className:"tips"},"COLOR LEGEND"),s().createElement("div",{key:"legend"},o.map((function(e){return e}))))},getExportParamters:function(){var e=this.getModel(),t=this.props&&this.props.options||{};return{type:"campaign",options:[{title:"Campaign Summary"},{list:[{key:"MASTER CAMPAIGN #:",text:e.get("DisplayName")},{key:"CLIENT NAME:",text:e.get("ClientName")},{key:"CONTACT NAME:",text:e.get("ContactName")},{key:"TARGETING METHOD:",text:t.targetMethod||""},{key:"TOTAL HOUSEHOLDS:",text:r()(e.get("TotalHouseHold")).format("0,0")},{key:"TARGET HOUSEHOLDS:",text:r()(e.get("TargetHouseHold")).format("0,0")},{key:"PENETRATION:",text:r()(e.get("Penetration")).format("0.00%")}]},{title:"Campaign Summary Map"},{map:e.get("PolygonImage"),bg:e.get("MapImage"),legend:"true"}]}},render:function(){var e=this.getModel(),t=this.props&&this.props.options?this.props.options:{},a=t.targetMethod||"",n=r()(e.get("TotalHouseHold")).format("0,0"),o=r()(e.get("TargetHouseHold")).format("0,0"),l=r()(e.get("Penetration")).format("0.00%"),i=e.get("MapImage"),c=e.get("PolygonImage");if(t.showPenetrationColors)var u=this.formatePenetrationColor(t.penetrationColors);else u=null;if(this.state.imageLoaded)if(i&&c){var d={backgroundImage:"url("+i+")",backgroundRepeat:"no-repeat",backgroundSize:"100% auto",backgroundPosition:"0 0"};i=s().createElement("div",{style:d},s().createElement("img",{src:c}))}else i=s().createElement("button",{className:"button reload",onClick:this.onReloadImage},s().createElement("i",{className:"fa fa-2x fa-refresh"}));else i=s().createElement(m.Z,{text:this.state.imageLoading?"LOADING":"WAITING"});return s().createElement("div",{className:"page campaign",ref:"page"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center title"},e.get("ClientName"))),s().createElement("div",{className:"row list",role:"list"},s().createElement("div",{className:"small-4 columns"},"MASTER CAMPAIGN #:"),s().createElement("div",{className:"small-8 columns"}," ",e.get("DisplayName")),s().createElement("div",{className:"small-4 columns"},"CLIENT NAME:"),s().createElement("div",{className:"small-8 columns"}," ",e.get("ClientName")),s().createElement("div",{className:"small-4 columns"},"CONTACT NAME:"),s().createElement("div",{className:"small-8 columns"}," ",e.get("ContactName")),s().createElement("div",{className:"small-4 columns"},"TARGETING METHOD:"),s().createElement("div",{className:"small-8 columns"}," ",a),s().createElement("div",{className:"small-4 columns"},"TOTAL HOUSEHOLDS:"),s().createElement("div",{className:"small-8 columns"}," ",n),s().createElement("div",{className:"small-4 columns"},"TARGET HOUSEHOLDS:"),s().createElement("div",{className:"small-8 columns"}," ",o),s().createElement("div",{className:"small-4 columns"},"PENETRATION:"),s().createElement("div",{className:"small-8 columns"}," ",l)),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center title"},"Campaign Summary Map")),s().createElement("div",{className:"row collapse"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"map-container",ref:e.get("key")},i),s().createElement("div",{className:"small-12 columns"},u,s().createElement("div",{className:"direction-legend"})))),s().createElement(p.Z,{model:e.get("Footer")}))}})},7634:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(2077)),l=a.n(o),i=a(8896),r=a(5676);const c=s().createBackboneClass({mixins:[i.Z],getExportParamters:function(){return{type:"campaign-summary",options:[{title:"Summary of Sub Maps"},{table:"submap-list"}]}},render:function(){var e=this.getModel(),t=e.get("SubMaps");return s().createElement("div",{className:"page campaign-summary"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center title"},"Summary of Sub Maps")),s().createElement("div",{className:"row collapse"},s().createElement("div",{className:"small-12 columns"},s().createElement("table",null,s().createElement("thead",null,s().createElement("tr",null,s().createElement("th",null,"#"),s().createElement("th",null,"SUB MAP NAME"),s().createElement("th",null,"TOTAL H/H"),s().createElement("th",null,"TARGET H/H"),s().createElement("th",null,"PENETRATION"))),s().createElement("tbody",null,t.map((function(e,t){var a=e.TotalHouseHold,n=e.TargetHouseHold,o=e.Penetration,i=a?l()(a).format("0,0"):"",r=n?l()(n).format("0,0"):"",c=o?l()(o).format("0.00%"):"";return s().createElement("tr",{key:e.OrderId},s().createElement("td",null,e.OrderId),s().createElement("td",null,e.Name),s().createElement("td",null,i),s().createElement("td",null,r),s().createElement("td",null,c))})))))),s().createElement(r.Z,{model:e.get("Footer")}))}})},2775:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(381)),l=a.n(o),i=a(8896),r=a(5676);const c=s().createBackboneClass({mixins:[i.Z],getExportParamters:function(){var e=this.getModel();return{type:"cover",options:[{title:"This Custom Campaign is Presented to:"},{key:"",image:e.get("Logo")||"",height:"80",align:"center",top:"40",bottom:"40"},{key:"Client Name:",text:e.get("ClientName")},{key:"Created for:",text:e.get("ContactName")},{key:"Created on:",text:e.get("Date")?l()(e.get("Date")).format("MMM DD, YYYY"):""},{key:" ",text:" "},{key:"Presented by:",image:"images/vargainc-logo.png",height:"40",align:"center",top:"10",bottom:"10"},{key:"Master Campaign #:",text:e.get("DisplayName")},{key:"Created by:",text:e.get("CreatorName")}]}},render:function(){var e=this.getModel(),t=e.get("Date")?l()(e.get("Date")).format("MMM DD, YYYY"):"";if(e.get("Logo"))var a=s().createElement("img",{className:"client-logo",src:e.get("Logo")});else a=s().createElement("div",{className:"client-logo"});return s().createElement("div",{className:"page cover"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center title"},s().createElement("span",{className:"editable",role:"title"},"This Custom Campaign is Presented to:"))),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center"},a)),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center"},"Client Name:"),s().createElement("div",{className:"small-12 columns text-center"},e.get("ClientName"))),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center"},"Created for:"),s().createElement("div",{className:"small-12 columns text-center"},e.get("ContactName"))),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center"},"Created on:"),s().createElement("div",{className:"small-12 columns text-center"},t)),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center"}," "),s().createElement("div",{className:"small-12 columns text-center"}," ")),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center"},"Presented by:"),s().createElement("div",{className:"small-12 columns text-center"},s().createElement("div",{className:"vargainc-log"}))),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center"},"Master Campaign #:"),s().createElement("div",{className:"small-12 columns text-center"},e.get("DisplayName"))),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center"},"Created by:"),s().createElement("div",{className:"small-12 columns text-center"},e.get("CreatorName"))),s().createElement(r.Z,{model:e.get("Footer")}))}})},5676:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(381)),l=a.n(o),i=a(8896);const r=s().createBackboneClass({mixins:[i.Z],render:function(){var e=this.getModel(),t=e.get("Date")?l()(e.get("Date")).format("MMM DD, YYYY"):"";return s().createElement("div",{className:"footer"},s().createElement("div",{className:"left"},s().createElement("div",{className:"vargainc-logo"})),s().createElement("div",{className:"center"},s().createElement("ul",{className:"no-bullet"},s().createElement("li",null,s().createElement("span",null,"MC#:"+e.get("DisplayName")),s().createElement("span",null,"www.vargainc.com")),s().createElement("li",null,s().createElement("span",null,"Created on:"+t),s().createElement("span",null,"PH:949-768-1500")),s().createElement("li",null,s().createElement("span",null,"Created for:"+e.get("ContactName")),s().createElement("span",null,"FX:949-768-1501")),s().createElement("li",null,s().createElement("span",null,"Created by:"+e.get("CreatorName")),s().createElement("span",null,"&copyright;2010 Varga Media Solutions,Inc.All rights reserved.")))),s().createElement("div",{className:"right"},s().createElement("div",{className:"timm-logo"})))}})},2708:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d}),a(2316);var n,s,o=a(7588),l=a.n(o),i=(a(456),a(3609)),r=a.n(i),c=a(6486),u=a(8896),m=a(8300),p=[];const d=l().createClass({displayName:"mapZoom",mixins:[u.Z,m.Z],getInitialState:function(){return{disableDefaultUI:!0,activeButton:"EnterMapDraw",activeMap:"ROADMAP",mapStyle:{visibility:"hidden",position:"fixed",width:"100%",height:"100%",left:"0",top:"0",right:"0",bottom:"0"}}},getDefaultProps:function(){return{boundary:[],color:"#000",sourceKey:null,mapType:"ROADMAP"}},componentDidMount:function(){r()(document).one("open.zf.reveal",r().proxy(this.initGoogleMap,this)),r()(document).one("closed.zf.reveal",r().proxy(this.clearMap,this))},clearMap:function(){console.log("mapZoom clearMap");var e=this.getGoogleMap();try{(0,c.each)(p,(function(e){e&&e.setMap&&e.setMap(null)})),n&&n.setMap&&n.setMap(null),s&&s.setMap&&s.setMap(null),google.maps.event.clearInstanceListeners(e),n=null,s=null}catch(e){console.log("mapZoom componentWillUnmount error",e)}this.hideMap()},initGoogleMap:function(){console.log("init google map");var e=this.getGoogleMap();this.showMap();var t=this.props.boundary,a=this.props.color,o=new google.maps.LatLngBounds,l=new google.maps.Polygon({paths:t,strokeColor:"#000",strokeOpacity:1,strokeWeight:6,fillColor:a,fillOpacity:.1,map:e});p.push(l),(0,c.each)(t,(function(e){var t=new google.maps.LatLng(e.lat,e.lng);o.extend(t)})),e.fitBounds(o),(s=new google.maps.drawing.DrawingManager({drawingMode:google.maps.drawing.OverlayType.MARKER,drawingControl:!1,drawingControlOptions:{position:google.maps.ControlPosition.TOP_CENTER,drawingModes:[google.maps.drawing.OverlayType.RECTANGLE],rectangleOptions:{strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.6}}})).setMap(e),s.setDrawingMode(google.maps.drawing.OverlayType.RECTANGLE),google.maps.event.addListener(s,"rectanglecomplete",(function(t){n&&n.setMap(null),n=new google.maps.Rectangle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:1,fillColor:"#FF0000",fillOpacity:.35,map:e,bounds:t.getBounds()}),t.setMap(null)})),p.push(s),this.publish("hideLoading")},onReset:function(){var e=this.getGoogleMap(),t=this.props.boundary,a=this.props.color,n=new google.maps.LatLngBounds,s=new google.maps.Polygon({paths:t,strokeColor:"#000",strokeOpacity:1,strokeWeight:6,fillColor:a,fillOpacity:.1,map:e});p.push(s),(0,c.each)(t,(function(e){var t=new google.maps.LatLng(e.lat,e.lng);n.extend(t)})),console.log("fitBounds",n.getCenter().lat(),n.getCenter().lng(),e.getZoom()),e.fitBounds(n)},onZoomIn:function(){var e=this.getGoogleMap();e.setZoom(e.getZoom()+1)},onZoomOut:function(){var e=this.getGoogleMap();e.setZoom(e.getZoom()-1)},onExistMapDraw:function(){this.setState({activeButton:"ExistMapDraw"}),s.setDrawingMode(null)},onEnterMapDraw:function(){this.setState({activeButton:"EnterMapDraw"}),s.setDrawingMode(google.maps.drawing.OverlayType.RECTANGLE)},onSwitchMapType:function(e){var t=this.getGoogleMap();t&&google.maps.MapTypeId&&google.maps.MapTypeId[e]&&t.setMapTypeId(google.maps.MapTypeId[e]),this.setState({activeMap:e})},onFinish:function(){if(n){var e=n.getBounds();this.publish("print.mapzoom@"+this.props.sourceKey,e,this.state.activeMap)}},onClose:function(){this.publish("showDialog")},render:function(){return l().createElement("div",{className:"google_map_container"},l().createElement("button",{onClick:this.onClose,className:"close-button","data-close":!0,"aria-label":"Close reveal",type:"button"},l().createElement("span",{"aria-hidden":"true"},"×")),l().createElement("div",{className:"pop-tool-bar button-group text-center"},l().createElement("button",{className:"EnterMapDraw"==this.state.activeButton?"button active":"button",onClick:this.onEnterMapDraw},l().createElement("i",{className:"fa fa-crop"})),l().createElement("button",{className:"ExistMapDraw"==this.state.activeButton?"button active":"button",onClick:this.onExistMapDraw},l().createElement("i",{className:"fa fa-arrows"})),l().createElement("button",{className:"ROADMAP"==this.state.activeMap?"button active":"button",onClick:this.onSwitchMapType.bind(null,"ROADMAP")},l().createElement("i",{className:"fa fa-map-o"})),l().createElement("button",{className:"HYBRID"==this.state.activeMap?"button active":"button",onClick:this.onSwitchMapType.bind(null,"HYBRID")},l().createElement("i",{className:"fa fa-map"})),l().createElement("button",{className:"button",onClick:this.onZoomIn},l().createElement("i",{className:"fa fa-search-plus"})),l().createElement("button",{className:"button",onClick:this.onZoomOut},l().createElement("i",{className:"fa fa-search-minus"})),l().createElement("button",{className:"button",onClick:this.onReset},l().createElement("i",{className:"fa fa-refresh"})),l().createElement("button",{className:"button",onClick:this.onFinish},l().createElement("i",{className:"fa fa-image"}))))}})},8814:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o}),a(2316),a(7588),a(456);var n=a(6486),s=a(8896);define(["underscore","views/base"],(function(e,t){}));const o=(0,n.extend)({},s.Z,{onClose:function(){this.publish("showDialog"),this.props.needTrigger&&this.publish("print.map.options.changed",this.getModel())},onApply:function(e){e.preventDefault(),e.stopPropagation(),this.publish("print.map.options.changed",this.getModel())},OnValueChanged:function(e){var t=this.getModel(),a=$(e.currentTarget),n=a.attr("name"),s=a.is("input:checkbox")?a.prop("checked"):a.val();t.set(n,s)}})},1666:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(6486),a(8896));const l=s().createBackboneClass({mixins:[o.Z],onSelectAll:function(e){var t=this.getCollection(),a=e.currentTarget.checked;t.each((function(e){e.set("Selected",a)})),this.forceUpdate()},onItemSelect:function(e,t){e.set("Selected",t.currentTarget.checked),this.forceUpdate()},render:function(){var e=this.getCollection(),t=e.every({Selected:!0}),a=this;return s().createElement("div",{className:"panel callout primary"},s().createElement("input",{id:"btnCheckAllDMap",className:"btnCheckAllDMap",type:"checkbox",checked:t,onChange:this.onSelectAll}),s().createElement("label",{htmlFor:"btnCheckAllDMap"},"Suppress All Distribute Maps"),s().createElement("div",{className:"row small-up-1 medium-up-2 large-up-4 collapse"},e.map((function(e){return s().createElement("div",{className:"column",key:"optionDmap-"+e.get("Id")},s().createElement("input",{id:"optionDmap-"+e.get("Id"),name:e.get("Id"),type:"checkbox",checked:e.get("Selected"),onChange:a.onItemSelect.bind(null,e)}),s().createElement("label",{htmlFor:"optionDmap-"+e.get("Id")},e.get("Name")))}))))}})},842:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(3609)),l=a.n(o),i=a(8896);const r=s().createBackboneClass({mixins:[i.Z],getDefaultProps:function(){return{colors:[20,40,60,80]}},componentWillUnmount:function(){l()(this.refs.colorSlider).slider("destroy")},componentDidMount:function(){var e=this;l()(this.refs.colorSlider).slider({step:1,min:0,max:100,values:this.props.colors,slide:function(t,a){var n=["Blue","Green","Yellow","Orange","Red"],s=[0].concat(a.values),o=[],i=0;s.push(100);for(var r=0;r<s.length-1;r++)i>=s[r+1]||(i=s[r+1],o.push(n[r]+" ("+s[r]+"% - "+s[r+1]+"%) "));l()(this).parents("label").find("span").eq(0).text(o.join("  ")),e.props.onChange&&e.props.onChange(a.values)}})},onReset:function(){l()(this.refs.colorSlider).slider("values",[20,40,60,80]),self.props.onChange&&self.props.onChange([20,40,60,80])},render:function(){return s().createElement("div",{className:"column"},s().createElement("div",{className:"row"},s().createElement("div",{className:"custom-colors small-10 columns"},s().createElement("label",null,s().createElement("span",null,"Blue (0% - 20%) Green (20% - 40%) Yellow (40% - 60%) Orange (60% - 80%) Red (80% - 100%) "),s().createElement("div",{className:"slider",ref:"colorSlider"}))),s().createElement("div",{className:"small-2 columns"},s().createElement("button",{className:"button tiny alert",onClick:this.onReset},"Reset"))))}})},394:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(3609)),l=a.n(o),i=a(2077),r=a.n(i),c=a(8896),u=a(4241),m=a(5676);const p=s().createBackboneClass({mixins:[c.Z],getInitialState:function(){return{imageLoaded:null,imageLoading:!1}},componentDidMount:function(){this.publish("print.map.imageloaded")},scrollToPage:function(){this.getModel();var e=l()(this.refs.page).position().top;l()("body").stop().animate({scrollTop:e},600)},preloadImage:function(e){var t=l().Deferred();return l()(new Image).one("load",(function(){t.resolve()})).attr("src",e),t},loadImage:function(){var e=this.getModel(),t=(e.get("key"),this);this.setState({imageLoaded:null,imageLoading:!0}),this.scrollToPage(),e.fetchMapImage(this.props.options).then((function(){var a=l().Deferred(),n=e.get("MapImage"),s=e.get("PolygonImage");return _.isEmpty(n)||_.isEmpty(s)?a.reject():l().when(t.preloadImage(n),t.preloadImage(s)).done((function(){a.resolve()})),a})).always((function(){t.setState({imageLoaded:!0,imageLoading:!1}),t.publish("print.map.imageloaded")}))},onReloadImage:function(){this.setState({imageLoaded:null,imageLoading:!1}),this.publish("print.map.imageloaded")},formatePenetrationColor:function(e){var t=["Blue","Green","Yellow","Orange","Red"],a=[0].concat(e),n=0,o=[];a.push(100);for(var l=0;l<a.length-1;l++)n>=a[l+1]||(o.push(s().createElement("i",{key:"i"+l,className:t[l].toLowerCase()})),o.push(s().createElement("label",{key:"l"+l},t[l]+"("+a[l]+"%-"+a[l+1]+"%)")),n=a[l+1]);return s().createElement("div",{className:"color-legend"},s().createElement("div",{key:"tips",className:"tips"},"COLOR LEGEND"),s().createElement("div",{key:"legend"},o.map((function(e){return e}))))},getExportParamters:function(){var e=this.getModel(),t=this.props&&this.props.options||{};return{type:"submap",options:[{title:"SUB MAP "+e.get("OrderId")+"("+e.get("Name")+")"},{list:[{key:"SUB MAP #:",text:e.get("OrderId")},{key:"SUB MAP NAME:",text:e.get("Name")},{key:"TARGETING METHOD:",text:t.targetMethod||""},{key:"TOTAL HOUSEHOLDS:",text:r()(e.get("TotalHouseHold")).format("0,0")},{key:"TARGET HOUSEHOLDS:",text:r()(e.get("TargetHouseHold")).format("0,0")},{key:"PENETRATION:",text:r()(e.get("Penetration")).format("0.00%")}]},{title:"Map"},{map:e.get("PolygonImage"),bg:e.get("MapImage"),legend:"true",color:t.showPenetrationColors?t.penetrationColors:null}]}},render:function(){var e=this.getModel(),t=this.props&&this.props.options?this.props.options:{},a=t.targetMethod||"",n=r()(e.get("TotalHouseHold")).format("0,0"),o=r()(e.get("TargetHouseHold")).format("0,0"),l=r()(e.get("Penetration")).format("0.00%"),i=e.get("MapImage"),c=e.get("PolygonImage");if(t.showPenetrationColors)var p=this.formatePenetrationColor(t.penetrationColors);else p=null;if(this.state.imageLoaded)if(i&&c){var d={backgroundImage:"url("+i+")",backgroundRepeat:"no-repeat",backgroundSize:"100% auto",backgroundPosition:"0 0"};i=s().createElement("div",{style:d},s().createElement("img",{src:c}))}else i=s().createElement("button",{className:"button reload",onClick:this.onReloadImage},s().createElement("i",{className:"fa fa-2x fa-refresh"}));else i=s().createElement(u.Z,{text:this.state.imageLoading?"LOADING":"WAITING"});return s().createElement("div",{key:"SUBMAP-".concat(e.get("SubMapId")),className:"page submap",ref:"page"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center title"},"SUB MAP ",e.get("OrderId"),"(",e.get("Name"),")")),s().createElement("div",{className:"row list",role:"list"},s().createElement("div",{className:"small-4 columns"},"SUB MAP #:"),s().createElement("div",{className:"small-8 columns"}," ",e.get("OrderId")),s().createElement("div",{className:"small-4 columns"},"SUB MAP NAME:"),s().createElement("div",{className:"small-8 columns"}," ",e.get("Name")),s().createElement("div",{className:"small-4 columns"},"TARGETING METHOD:"),s().createElement("div",{className:"small-8 columns"}," ",a),s().createElement("div",{className:"small-4 columns"},"TOTAL HOUSEHOLDS:"),s().createElement("div",{className:"small-8 columns"}," ",n),s().createElement("div",{className:"small-4 columns"},"TARGET HOUSEHOLDS:"),s().createElement("div",{className:"small-8 columns"}," ",o),s().createElement("div",{className:"small-4 columns"},"PENETRATION:"),s().createElement("div",{className:"small-8 columns"}," ",l)),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center title"},"Map")),s().createElement("div",{className:"row collapse"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"map-container",ref:e.get("key")},i),s().createElement("div",{className:"small-12 columns"},p,s().createElement("div",{className:"direction-legend"})))),s().createElement(m.Z,{model:e.get("Footer")}))}})},5635:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(2077)),l=a.n(o),i=a(8896),r=a(5676);const c=s().createBackboneClass({mixins:[i.Z],componentDidMount:function(){this.getModel().fetchBySubMap({quite:!0})},getExportParamters:function(){var e=this.getModel();return{type:"submapDetail",options:[{title:"CARRIER ROUTES CONTAINED IN SUB-MAP "+e.get("OrderId")+" ("+e.get("Name")+")"},{table:"submap-detail",submapId:e.get("SubMapId")}]}},render:function(){var e=this.getModel(),t=e.get("CRoutes")?e.get("CRoutes"):[];return s().createElement("div",{className:"page submap-detail"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns text-center title"},"CARRIER ROUTES CONTAINED IN SUB-MAP ",e.get("OrderId")," (",e.get("Name"),")")),s().createElement("div",{className:"row collapse"},s().createElement("div",{className:"small-12 columns"},s().createElement("table",null,s().createElement("thead",null,s().createElement("tr",null,s().createElement("th",null,"#"),s().createElement("th",null,"CARRIER ROUTE #"),s().createElement("th",null,"TOTAL H/H"),s().createElement("th",null,"TARGET H/H"),s().createElement("th",null,"PENETRATION"))),s().createElement("tbody",null,t.map((function(e,t){return s().createElement("tr",{key:"".concat(e.Name,"-").concat(t)},s().createElement("td",null,t),s().createElement("td",null,e.Name),s().createElement("td",null,l()(e.TotalHouseHold).format("0,0")),s().createElement("td",null,l()(e.TargetHouseHold).format("0,0")),s().createElement("td",null,l()(e.Penetration).format("0.00%")))})))))),s().createElement(r.Z,{model:e.get("Footer")}))}})},8664:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(381)),l=a.n(o),i=a(3609),r=a.n(i),c=a(6486),u=a(8896),m=a(594);const p=s().createBackboneClass({mixins:[u.Z],menuKey:"report-menu-ddl-",getDefaultProps:function(){return{address:null,icon:null,name:null,scrollToTaskId:null}},componentDidMount:function(){r()(".has-tip").foundation();var e=this.props.scrollToTaskId;e&&this.refs[e]&&(this.scrollTop(this.refs[e]),this.props.scrollToTaskId=null)},onReOpenTask:function(e){var t=this;this.confirm("Do you really want to move report back to GPS Montor?").then((function(){new m.Z({Id:e}).reOpen({success:function(e){e&&e.success?t.publish("report/refresh"):t.alert(e.error)}})}))},onGotoReport:function(e){window.location.hash="frame/ReportsTask.aspx?tid="+e},onGotoReview:function(e,t,a){window.open("index.html#campaign/".concat(e,"/").concat(t,"/").concat(a,"/edit"))},onCloseMoreMenu:function(e){r()("#"+this.menuKey+e).foundation("close")},renderMoreMenu:function(e){var t=this.menuKey+e;return s().createElement("span",null,s().createElement("button",{className:"button cirle","data-toggle":t},s().createElement("i",{className:"fa fa-ellipsis-h"})),s().createElement("div",{id:t,className:"dropdown-pane bottom","data-dropdown":!0,"data-close-on-click":"true","data-auto-focus":"false",onClick:this.onCloseMoreMenu.bind(null,e)},s().createElement("ul",{className:"vertical menu"},s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onEdit},s().createElement("i",{className:"fa fa-edit"}),s().createElement("span",null,"Edit"))),s().createElement("li",null,s().createElement("a",{href:"javascript:;",onClick:this.onOpenUploadFile.bind(null,e)},s().createElement("i",{className:"fa fa-cloud-upload"}),s().createElement("span",null,"Import"))),s().createElement("input",{type:"file",id:"upload-file-"+e,multiple:!0,style:{display:"none"},onChange:this.onImport.bind(null,e)}))))},render:function(){var e=this,t=this.getModel(),a=t.get("Date"),n=a?l()(a).format("MMM DD, YYYY"):"";return s().createElement("div",{className:"row scroll-list-item"},s().createElement("div",{className:"hide-for-small-only medium-2 columns"},t.get("ClientName")),s().createElement("div",{className:"small-10 medium-5 columns"},t.get("ClientCode")),s().createElement("div",{className:"small-2 medium-2 columns"},n),s().createElement("div",{className:"small-2 medium-3 columns"},s().createElement("span",{className:"show-for-large"},t.get("AreaDescription")),s().createElement("div",{className:"float-right tool-bar"},s().createElement("a",{className:"button row-button",href:"#frame/handler/PhantomjsPrintHandler.ashx?campaignId="+t.get("Id")+"&type=print"},s().createElement("i",{className:"fa fa-print"}),s().createElement("small",null,"Print")))),s().createElement("div",{className:"small-12 columns"},s().createElement("table",{className:"hover"},s().createElement("colgroup",null,s().createElement("col",null),s().createElement("col",{style:{width:"160px"}})),s().createElement("tbody",null,t.get("Tasks").map((function(a){if(!1===a.visiable)return null;var n=t.get("Id"),o=a.Name;return s().createElement("tr",{key:a.Id,ref:a.Id},s().createElement("td",{onClick:e.onGotoReview.bind(null,n,o,a.Id)},a.Name),s().createElement("td",null,s().createElement("div",{className:"float-right tool-bar"},s().createElement("a",{className:"button row-button",onClick:e.onGotoReport.bind(null,a.Id)},s().createElement("i",{className:"fa fa-file-text-o"}),s().createElement("small",null,"Report")),s().createElement("button",{onClick:e.onReOpenTask.bind(null,a.Id),className:"button has-tip top",title:"dismiss","data-tooltip":!0,"aria-haspopup":"true","data-disable-hover":"false",tabIndex:"1"},s().createElement("i",{className:"fa fa-reply"})))))}))))))}}),d=s().createBackboneClass({mixins:[u.Z],getInitialState:function(){return{orderByFiled:null,orderByAsc:!1,search:null,filterField:null,filterValues:[]}},componentDidMount:function(){var e=this;this.subscribe("report/refresh",(function(){e.getCollection().fetchForReport()})),this.subscribe("search",(function(t){e.setState({search:t,filterField:null,filterValues:[]})})),r()("#report-filter-ddl-ClientName, #report-filter-ddl-ClientCode, #report-filter-ddl-Date, #report-filter-ddl-AreaDescription").foundation()},onOrderBy:function(e,t){t.preventDefault(),t.stopPropagation(),this.state.orderByFiled==e?this.setState({orderByAsc:!this.state.orderByAsc}):this.setState({orderByFiled:e,orderByAsc:!0})},onFilter:function(e,t){t.preventDefault(),t.stopPropagation();var a=r()(":checked",t.currentTarget),n=(0,c.map)(a,(function(e){return r()(e).val()}));this.setState({filterField:n.length>0?e:null,filterValues:n.length>0?n:[],search:null}),r()("#report-filter-ddl-"+e).foundation("close")},onClearFilter:function(e,t){t.preventDefault(),t.stopPropagation(),this.setState({filterField:null,filterValues:[],search:null}),r()("#report-filter-ddl-"+e).foundation("close"),r()(t.currentTarget).closest("form").get(0).reset()},renderHeader:function(e,t){var a=this.getCollection(),n=null,o=null,i=null;if(a=a?a.toArray():[],n=this.state.orderByFiled==e?this.state.orderByAsc?s().createElement("i",{className:"fa fa-sort-up active"}):s().createElement("i",{className:"fa fa-sort-down active"}):s().createElement("i",{className:"fa fa-sort"}),n=s().createElement("a",{onClick:this.onOrderBy.bind(null,e)}," ",n),this.state.filterField&&this.state.filterField==e&&(o=s().createElement("a",{"data-toggle":"report-filter-ddl-"+e}," ",s().createElement("i",{className:"fa fa-filter active"}))),a){var r=(0,c.map)(a,(function(t){var a=t.get(e),n=l()(a,l().ISO_8601);return n.isValid()?n.format("MMM DD, YYYY"):a})),u=(0,c.uniq)(r).sort();i=s().createElement("div",{id:"report-filter-ddl-"+e,className:"dropdown-pane bottom",style:{width:"auto"},"data-dropdown":!0,"data-close-on-click":"true","data-auto-focus":"false"},s().createElement("form",{onSubmit:this.onFilter.bind(this,e)},s().createElement("ul",{className:"vertical menu"},u.map((function(t,a){return s().createElement("li",{key:e+a},s().createElement("input",{id:e+a,name:e,type:"checkbox",value:t}),s().createElement("label",{htmlFor:e+a},t))}))),s().createElement("button",{className:"button tiny success",type:"submit"},"Filter"),s().createElement("button",{className:"button tiny warning",type:"reset",onClick:this.onClearFilter.bind(this,e)},"Clear")))}return s().createElement("div",null,s().createElement("a",{"data-toggle":"report-filter-ddl-"+e},t),n,o,i)},getDataSource:function(){var e=this.getCollection();if(e=e?e.toArray():[],this.state.orderByFiled&&(e=(0,c.orderBy)(e,["attributes."+this.state.orderByFiled],[this.state.orderByAsc?"asc":"desc"])),this.state.search){var t=this.state.search.toLowerCase(),a=null,n=null,s=null;e=(0,c.filter)(e,(function(e){return a=(0,c.values)(e.attributes),n=(0,c.some)(a,(function(e){var a=l()(e,l().ISO_8601);return a.isValid()?a.format("MMM DD YYYY MMM DD, YYYY YYYY-MM-DD MM/DD/YYYY YYYY MM MMM DD").toLowerCase().indexOf(t)>-1:(0,c.toString)(e).toLowerCase().indexOf(t)>-1})),s=(0,c.values)(e.attributes.Tasks),(0,c.each)(s,(function(e){e.visiable=n||e.Name.toLowerCase().indexOf(t)>-1})),n||(0,c.some)(s,{visiable:!0})}))}else if(this.state.filterField&&this.state.filterValues){var o=this.state.filterField,i=this.state.filterValues;e=(0,c.filter)(e,(function(e){var t=e.get(o),a=l()(t,l().ISO_8601);return a.isValid()?(0,c.indexOf)(i,a.format("MMM DD, YYYY"))>-1:(0,c.indexOf)(i,t)>-1}))}return e},render:function(){var e=this.getDataSource(),t=this.props.taskId;return s().createElement("div",{className:"section row"},s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"section-header"},s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 column"},s().createElement("h5",null,"Reports")),s().createElement("div",{className:"small-12 column"},s().createElement("nav",{"aria-label":"You are here:",role:"navigation"},s().createElement("ul",{className:"breadcrumbs"},s().createElement("li",null,s().createElement("a",{href:"#"},"Control Center")),s().createElement("li",null,s().createElement("span",{className:"show-for-sr"},"Current: ")," Reports")))))),s().createElement("div",{className:"scroll-list-section-body"},s().createElement("div",{className:"row scroll-list-header"},s().createElement("div",{className:"hide-for-small-only medium-2 columns"},this.renderHeader("ClientName","Client Name")),s().createElement("div",{className:"small-10 medium-5 columns"},this.renderHeader("ClientCode","Client Code")),s().createElement("div",{className:"hide-for-small-only medium-2 columns"},this.renderHeader("Date","Date")),s().createElement("div",{className:"small-2 medium-3 columns"},s().createElement("span",{className:"show-for-large"},this.renderHeader("AreaDescription","Type")))),e.map((function(e){return s().createElement(p,{key:e.get("Id"),model:e,scrollToTaskId:t})})))))}})},4179:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(8896)),l=new(a(6079).Z);const i=s().createBackboneClass({mixins:[o.Z],getDefaultProps:function(){return{collection:l,group:null,onSelect:null}},getInitialState:function(){return{selected:null}},componentWillMount:function(){this.props.group&&this.getCollection().fetchInGroup(this.props.group)},onSelected:function(e){var t=this.getCollection().get(e);this.props.onSelect&&this.props.onSelect(t),this.setState({selected:t})},onDbSelected:function(e){var t=this.getCollection().get(e);this.props.onDbSelect&&this.props.onDbSelect(t),this.setState({selected:t})},render:function(){var e=this.getCollection(),t=this;return e=e||[],s().createElement("ul",{className:"vertical menu list-group"},e.map((function(e){var a,n,o,l=e.get("Id"),i=t.state.selected&&t.state.selected==e?"list-group-item active":"list-group-item";return s().createElement("li",(a={className:i,key:l,onClick:t.onSelected.bind(t,l)},n="onClick",o=t.onDbSelected.bind(t,l),n in a?Object.defineProperty(a,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[n]=o,a),e.get("UserName"))})))}})},3821:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l}),a(2316);var n=a(7588),s=a.n(n),o=(a(456),a(8896));const l=s().createBackboneClass({mixins:[o.Z],componentDidMount:function(){var e=this;this.getModel(),$("#birthdayDatePicker").fdatepicker({format:"yyyy-mm-dd"}).on("changeDate",(function(t){e.getModel().set("DateOfBirth",t.date)})),$(this.refs.companySelector).select2(),$("form").foundation()},componentWillUnmount:function(){var e=$(this.refs.companySelector);e&&e.select2&&e.select2("destroy"),$("#birthdayDatePicker").off("changeDate").fdatepicker("remove")},onSave:function(e){e.preventDefault(),e.stopPropagation();var t=this.getModel(),a=this.refs.employeePicture.files.length>0?this.refs.employeePicture.files[0]:null,n=this;t.set("CompanyId",$(this.refs.companySelector).val()),t.addEmployee(a).done((function(){n.publish("showDialog")}))},onClose:function(){this.publish("showDialog")},onChange:function(e){this.getModel().set(e.currentTarget.name,e.currentTarget.value)},render:function(){var e=!(!this.state||!this.state.error),t=e?this.state.error:"";return s().createElement("form",{"data-abide":!0,onSubmit:this.onSave},s().createElement("h3",null,"Add Employee"),s().createElement("div",{"data-abide-error":!0,className:"alert callout",style:{display:e?"block":"none"}},s().createElement("p",null,s().createElement("i",{className:"fa fa-exclamation-circle"})," ",t)),s().createElement("div",{className:"row"},s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Distributor"),s().createElement("select",{ref:"companySelector"},this.props.company.models.map((function(e){return s().createElement("option",{key:e.get("Id"),value:e.get("Id")},e.get("Name"))}))),s().createElement("span",{className:"form-error"},"it is required.")),s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Full Name",s().createElement("input",{onChange:this.onChange,name:"FullName",type:"text",required:!0}))),s().createElement("fieldset",{className:"small-12 columns"},s().createElement("label",null,"Role"),s().createElement("input",{type:"radio",onChange:this.onChange,name:"Role",value:"Walker",id:"walker"}),s().createElement("label",{htmlFor:"walker"},"Walker"),s().createElement("input",{type:"radio",onChange:this.onChange,name:"Role",value:"Driver",id:"driver"}),s().createElement("label",{htmlFor:"driver"},"Driver"),s().createElement("input",{type:"radio",onChange:this.onChange,name:"Role",value:"Auditor",id:"autitor"}),s().createElement("label",{htmlFor:"autitor"},"Auditor")),s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Cell Phone",s().createElement("input",{onChange:this.onChange,name:"CellPhone",type:"text"}))),s().createElement("div",{className:"small-12 medium-12 large-4 columns end"},s().createElement("label",null,"Birthday",s().createElement("input",{id:"birthdayDatePicker",className:"fdatepicker",onChange:this.onChange,name:"DateOfBirth",type:"date",readOnly:!0}))),s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Photo",s().createElement("input",{ref:"employeePicture",name:"picture",type:"file"}))),s().createElement("div",{className:"small-12 columns"},s().createElement("label",null,"Notes",s().createElement("textarea",{onChange:this.onChange,name:"Notes"})))),s().createElement("div",{className:"small-12 columns"},s().createElement("div",{className:"button-group float-right"},s().createElement("button",{type:"submit",className:"success button"},"Save"),s().createElement("a",{href:"javascript:;",className:"button",onClick:this.onClose},"Cancel"))),s().createElement("button",{onClick:this.onClose,className:"close-button","data-close":!0,"aria-label":"Close reveal",type:"button"},s().createElement("span",{"aria-hidden":"true"},"×")))}})},6700:(e,t,a)=>{var n={"./af":2786,"./af.js":2786,"./ar":867,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":5671,"./ar-tn.js":5671,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bn":8905,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-nz":9245,"./en-nz.js":9245,"./eo":2915,"./eo.js":2915,"./es":5655,"./es-do":5251,"./es-do.js":5251,"./es.js":5655,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./ko":3730,"./ko.js":3730,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":1793,"./ru.js":1793,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./th":9041,"./th.js":9041,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./uk":7691,"./uk.js":7691,"./uz":6791,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-tw":4152,"./zh-tw.js":4152};function s(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=o,e.exports=s,s.id=6700},2300:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var n=a(2316),s=a.n(n),o=a(1149),l=(a(6624),a(6486));const i=s().Collection.extend({model:o.Z,urlRoot:"campaign",fetchForDistribution:function(e){var t={url:this.urlRoot+"/distribution"};return t=(0,l.extend)(e,t),this.fetch(t)},fetchForTask:function(e){var t={url:this.urlRoot+"/monitor"};return t=(0,l.extend)(e,t),this.fetch(t)},fetchForReport:function(e){var t={url:this.urlRoot+"/report"};return t=(0,l.extend)(e,t),this.fetch(t)}})},5724:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var n=a(2316),s=a.n(n),o=a(6624),l=a.n(o),i=a(6486);const r=s().Model.extend({idAttribute:"id"}),c=s().Collection.extend({model:r,fetchByZipcode:function(e){var t=this;return new(l())(((a,n)=>{$.ajax({url:`//api.mapbox.com/geocoding/v5/mapbox.places/${e}.json`,method:"GET",data:{country:"us",types:"postcode",access_token:"pk.eyJ1IjoiZ2hvc3R1eiIsImEiOiJjaXczc2tmc3cwMDEyMm9tb29pdDRwOXUzIn0.KPSiOO6DWTY59x1zHdvYSA"}}).then((e=>{var n=[],s={type:"FeatureCollection",features:[]};(0,i.each)(e.features,((e,t)=>{n.push({id:e.id,place:e.place_name,text:e.text,latlng:e.geometry.coordinates}),s.features.push({type:"Feature",geometry:e.geometry,properties:{id:e.id,text:e.text,serial:t+1}})})),t.set(n),a(s)}))}))},fetchByAddress:function(e){var t=this;return new(l())(((a,n)=>{$.ajax({url:`//api.mapbox.com/geocoding/v5/mapbox.places/${e}.json`,method:"GET",data:{country:"us",access_token:"pk.eyJ1IjoiZ2hvc3R1eiIsImEiOiJjaXczc2tmc3cwMDEyMm9tb29pdDRwOXUzIn0.KPSiOO6DWTY59x1zHdvYSA"}}).then((e=>{var n=[],s={type:"FeatureCollection",features:[]};(0,i.each)(e.features,((e,t)=>{n.push({id:e.id,place:e.place_name,text:e.text,latlng:e.geometry.coordinates}),s.features.push({type:"Feature",geometry:e.geometry,properties:{id:e.id,text:e.text,serial:t+1}})})),t.set(n),a(s)}))}))}})},8552:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var n=a(2316),s=a.n(n),o=(a(6624),a(6486));const l=s().Model.extend({urlRoot:"gtu",idAttribute:"Id",defaults:{Id:null,ShortUniqueID:null,UserColor:null},assignGTUToTask:function(e,t){var a=this,n={url:a.urlRoot+"/task/assign/",method:"PUT",data:e,processData:!0,success:function(e){e&&e.success&&a.set(e.data)}};return n=(0,o.extend)(t,n),(this.sync||s().sync).call(this,"update",this,n)},unassignGTUFromTask:function(e,t){var a=this,n={url:a.urlRoot+"/task/"+e+"/unassign/"+a.get("Id"),method:"DELETE",success:function(e){e&&e.success&&a.set({IsAssign:!1,UserColor:null,Company:null,Auditor:null,Role:null,TaskId:null,AuditorId:null})}};return n=(0,o.extend)(t,n),(this.sync||s().sync).call(this,"update",this,n)},getTrack:function(e,t){var a=this,n=a.get("lastUpdateTime"),l=a.urlRoot+"/task/"+e+"/track/"+a.get("Id");n&&(l+="/"+n);var i={url:l,method:"GET",success:e=>{if(e){a.set("lastUpdateTime",e.lastUpdateTime);var t=a.get("track")||[];a.set("track",(0,o.concat)(t,(0,o.map)(e.data,(e=>({lat:parseFloat(e.lat),lng:parseFloat(e.lng)})))))}}};return i=(0,o.extend)(t,i),(this.sync||s().sync).call(this,"",this,i)}}),i=s().Collection.extend({model:l,urlRoot:"gtu",fetchByTask:function(e,t){var a={url:"task/"+e+"/gtu"};return a=(0,o.extend)(t,a),this.fetch(a)},fetchGtuWithStatusByTask:function(e,t){var a={url:this.urlRoot+"/task/"+e};return a=(0,o.extend)(t,a),this.fetch(a)},fetchGtuLocation:function(e,t){var a=this,n={url:a.urlRoot+"/task/"+e+"/online/",method:"GET",success:e=>{e&&(0,o.each)(e,(e=>{var t=a.get(e.Id);if(t){var n=null;e.Location&&e.Location.lat&&e.Location.lng&&(n={lat:parseFloat(e.Location.lat),lng:parseFloat(e.Location.lng)}),t.set({IsOnline:e.IsOnline,Location:n,OutOfBoundary:e.OutOfBoundary})}}))}};return(0,o.extend)(n,t),(this.sync||s().sync).call(this,"",this,n)}})},1474:(e,t,a)=>{"use strict";a.d(t,{Z:()=>v});var n=a(2316),s=a.n(n),o=a(3609),l=a.n(o),i=(a(6624),a(6486)),r=a(7315);const c=r.Z.extend({defaults:{DisplayName:null,Date:null,ContactName:null,CreatorName:null}}),u=r.Z.extend({idAttribute:"key",defaults:{Id:null,ClientName:null,ContactName:null,DisplayName:null,CreatorName:null,Date:null,Logo:null}}),m=r.Z.extend({urlRoot:"map",idAttribute:"key",defaults:{Id:null,Name:null,Total:null,DisplayName:null,MapImage:null,PolygonImage:null,ImageStatus:"waiting"},fetchMapImage:function(e){var t=this,a=l().extend({mapType:"ROADMAP"},e,{campaignId:t.get("CampaignId")}),n={quite:!0,url:t.urlRoot+"/campaign/",method:"POST",processData:!0,data:l().param(a),success:function(e){var a=null,n=null;e&&e.success&&(a=e.tiles,n=e.geometry),t.set("MapImage",a,{silent:!0}),t.set("PolygonImage",n,{silent:!0})}};return(this.sync||s().sync).call(this,"update",this,n)}}),p=r.Z.extend({urlRoot:"map",idAttribute:"key",defaults:{Id:null,Name:null,Total:null,DisplayName:null,MapImage:null,PolygonImage:null,ImageStatus:"waiting"},fetchMapImage:function(e){var t=this,a=l().extend({mapType:"HYBRID"},e,{campaignId:t.get("CampaignId"),submapId:t.get("SubMapId")}),n={quite:!0,url:t.urlRoot+"/submap/",method:"POST",processData:!0,data:l().param(a),success:e=>{var a=null,n=null;e&&e.success&&(a=e.tiles,n=e.geometry),t.set("MapImage",a,{silent:!0}),t.set("PolygonImage",n,{silent:!0})}};return(this.sync||s().sync).call(this,"update",this,n)}}),d=r.Z.extend({urlRoot:"print",defaults:{Name:null,TotalHouseHold:null,TargetHouseHold:null,Penetration:null},fetchBySubMap:function(e){var t=this,a=t.get("CampaignId"),n=t.get("SubMapId"),o={url:t.urlRoot+"/campaign/"+a+"/submap/"+n+"/record",success:function(e){t.set("CRoutes",e.record)}};return(0,i.extend)(o,e),(this.sync||s().sync).call(this,"read",this,o)}});var h=a(1859);const g=r.Z.extend({urlRoot:"map",idAttribute:"key",defaults:{Id:null,Name:null,Total:null,DisplayName:null,MapImage:null,PolygonImage:null,ImageStatus:"waiting"},fetchMapImage:function(e){var t=this,a=l().extend({mapType:"HYBRID"},e,{campaignId:t.get("CampaignId"),submapId:t.get("SubMapId"),dmapId:t.get("DMapId")}),n={quite:!0,url:t.urlRoot+"/distribution/",method:"POST",processData:!0,data:l().param(a),success:e=>{var a=null,n=null;e&&e.success&&(a=e.tiles,n=e.geometry),t.set("MapImage",a,{silent:!0}),t.set("PolygonImage",n,{silent:!0})}};return t.get("TopRight")&&t.get("BottomLeft")&&(n.data=l().param(l().extend(a,{topRightLat:t.get("TopRight").lat,topRightLng:t.get("TopRight").lng,bottomLeftLat:t.get("BottomLeft").lat,bottomLeftLng:t.get("BottomLeft").lng}))),(this.sync||s().sync).call(this,"update",this,n)},fetchBoundary:function(e){var t=this,a={url:"print/campaign/"+t.get("CampaignId")+"/submap/"+t.get("SubMapId")+"/dmap/"+t.get("DMapId")+"/boundary/",method:"GET",success:e=>{t.set({Boundary:e.boundary,Color:e.color})}};return(0,i.extend)(a,e),(this.sync||s().sync).call(this,"update",this,a)}});s().Collection.extend({model:p});var f=s().Collection.extend({model:h.Z});const v=s().Collection.extend({model:r.Z,urlRoot:"print",dmaps:[],campaignId:null,fetchForCampaignMap:function(e,t){var a=this,n={url:a.urlRoot+"/campaign/"+e,success:t=>{t.DisplayName;var n=new c({DisplayName:t.DisplayName,Date:t.Date,ContactName:t.ContactName,CreatorName:t.CreatorName});a.campaignId=e,a.submaps=[],a.dmaps=[],a.add(new u({type:"Cover",key:"cover",ClientName:t.ClientName,ContactName:t.ContactName,DisplayName:t.DisplayName,CreatorName:t.CreatorName,Date:t.Date,Logo:t.Logo,Footer:n})),a.add(new m({type:"Campaign",key:"campaign",CampaignId:e,ClientName:t.ClientName,ContactName:t.ContactName,DisplayName:t.DisplayName,CreatorName:t.CreatorName,TotalHouseHold:t.TotalHouseHold,TargetHouseHold:t.TargetHouseHold,Penetration:t.Penetration,Date:t.Date,Logo:t.Logo,Footer:n})),a.add(new m({type:"CampaignSummary",key:"campaign-summary",CampaignId:e,SubMaps:a.submaps,Footer:n})),(0,i.each)(t.SubMaps,(t=>{a.submaps.push({Name:t.Name,OrderId:t.OrderId,TotalHouseHold:t.TotalHouseHold,TargetHouseHold:t.TargetHouseHold,Penetration:t.Penetration}),a.add(new p({type:"SubMap",key:e+"-"+t.Id,CampaignId:e,SubMapId:t.Id,Name:t.Name,OrderId:t.OrderId,TotalHouseHold:t.TotalHouseHold,TargetHouseHold:t.TargetHouseHold,Penetration:t.Penetration,Footer:n})),a.add(new d({type:"SubMapDetail",key:"detail-"+e+"-"+t.Id,CampaignId:e,SubMapId:t.Id,Name:t.Name,OrderId:t.OrderId,Footer:n}))}))}};return n=(0,i.extend)(t,n),(this.sync||s().sync).call(this,"read",this,n)},fetchForDistributionMap:function(e,t){var a=this,n={url:a.urlRoot+"/campaign/"+e,success:t=>{a.campaignId=e,a.dmaps=[];var n=t.DisplayName;(0,i.each)(t.SubMaps,(function(t){(0,i.each)(t.DMaps,(function(s){a.dmaps.push({Selected:!1,Id:s.Id,Name:s.Name}),a.add(new g({key:e+"-"+t.Id+"-"+s.Id,CampaignId:e,SubMapId:t.Id,DMapId:s.Id,Name:s.Name,Total:s.Total,DisplayName:n,ImageStatus:"waiting"}))}))}))}};return n=(0,i.extend)(t,n),(this.sync||s().sync).call(this,"read",this,n)},fetchForReportMap:function(e,t){var a=this,n={url:a.urlRoot+"/campaign/"+e,success:t=>{var n=t.DisplayName,s=new c({DisplayName:t.DisplayName,Date:t.Date,ContactName:t.ContactName,CreatorName:t.CreatorName});a.campaignId=e,a.submaps=[],a.dmaps=[],a.add(new u({type:"Cover",key:"cover",ClientName:t.ClientName,ContactName:t.ContactName,DisplayName:t.DisplayName,CreatorName:t.CreatorName,Date:t.Date,Logo:t.Logo,Footer:s})),a.add(new m({type:"Campaign",key:"campaign",CampaignId:e,ClientName:t.ClientName,ContactName:t.ContactName,DisplayName:t.DisplayName,CreatorName:t.CreatorName,TotalHouseHold:t.TotalHouseHold,TargetHouseHold:t.TargetHouseHold,Penetration:t.Penetration,Date:t.Date,Logo:t.Logo,Footer:s})),a.add(new m({type:"CampaignSummary",key:"campaign-summary",CampaignId:e,SubMaps:a.submaps,Footer:s})),(0,i.each)(t.SubMaps,(function(t){a.submaps.push({Name:t.Name,OrderId:t.OrderId,TotalHouseHold:t.TotalHouseHold,TargetHouseHold:t.TargetHouseHold,Penetration:t.Penetration}),a.add(new p({type:"SubMap",key:e+"-"+t.Id,CampaignId:e,SubMapId:t.Id,Name:t.Name,OrderId:t.OrderId,TotalHouseHold:t.TotalHouseHold,TargetHouseHold:t.TargetHouseHold,Penetration:t.Penetration,Footer:s})),a.add(new d({type:"SubMapDetail",key:"detail-"+e+"-"+t.Id,CampaignId:e,SubMapId:t.Id,Name:t.Name,OrderId:t.OrderId,Footer:s}))})),(0,i.each)(t.SubMaps,(function(t){(0,i.each)(t.DMaps,(function(o){a.dmaps.push({Selected:!1,Id:o.Id,Name:o.Name}),a.add(new h.Z({type:"DMap",key:e+"-"+t.Id+"-"+o.Id,CampaignId:e,SubMapId:t.Id,DMapId:o.Id,Name:o.Name,Total:o.Total,DisplayName:n,Footer:s}))}))}))}};return n=(0,i.extend)(t,n),(this.sync||s().sync).call(this,"read",this,n)},getCampaignId:function(){return this.campaignId},getDMaps:function(){return new f(this.dmaps)},exportPdf:function(e,t){var a={url:"pdf/build/",method:"POST",processData:!0,data:l().param({options:JSON.stringify(e)}),success:function(e){return e}};return a=(0,i.extend)(t,a),(this.sync||s().sync).call(this,"read",this,a)}})},6079:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var n=a(2316),s=a.n(n),o=a(189),l=(a(6624),a(6486));const i=s().Collection.extend({model:o.Z,url:"user",fetchInGroup:function(e,t){var a={url:this.url+"/group/"+e,type:"GET"};return(0,l.extend)(a,t),this.fetch(a)},fetchForGtu:function(e){var t={url:this.url+"/gtu/",type:"GET"};return(0,l.extend)(t,e),this.fetch(t)},fetchCompany:function(e){var t={url:this.url+"/company/",type:"GET"};return(0,l.extend)(t,e),this.fetch(t)}})},8573:(e,t,a)=>{"use strict";a.d(t,{Z:()=>u});var n=a(4566),s=a.n(n),o=a(3609),l=a.n(o);r.prototype=new google.maps.OverlayView,r.prototype.addMarker=function(e){this._markers.push(e),this.draw()},r.prototype.removeMarker=function(e){var t=this._markers.indexOf(e);t>-1&&(1==this._markers.length?(this._markers=[],console.log("FastMarker remove last one")):this._markers=this._markers.slice(t,t+1)),this.draw()},r.prototype.onAdd=function(){var e=this.getMap(),t=this.getPanes(),a=this.getProjection(),n=t.overlayLayer,o=l()(".fastMarkerLayer",n);if(e.overlayMapTypes.insertAt(0,this),a&&t&&n&&o&&o.size&&0==o.size()){var i=a.fromLatLngToDivPixel(e.getCenter());this.width=2*i.x,this.height=2*i.y,o=s().select(n).append("svg").attr("style","position:absolute; top: 0; left: 0;").attr("class","fastMarkerLayer"),this.markerLayer=o}},r.prototype.onRemove=function(){this.getMap();var e=this.getPanes().overlayLayer;l()(".fastMarkerLayer",e).remove()},r.prototype.drawTimeout=null,r.prototype.draw=function(){window.clearTimeout(this.drawTimeout),this.drawTimeout=window.setTimeout(l().proxy(this._draw,this),500)},r.prototype._draw=function(){console.log("FastMarker _draw");var e=this.getProjection(),t=this.markerLayer,a={x:null,y:null},n={x:null,y:null};if(t&&e)t.selectAll("*").remove(),console.log("FastMarker draw",this._markers.length),l().each(this._markers,(function(){var t=e.fromLatLngToDivPixel(this.options.position);a.x=null==a.x||a.x>t.x?t.x:a.x,a.y=null==a.y||a.y>t.y?t.y:a.y,n.x=null==n.x||n.x<t.x?t.x:n.x,n.y=null==n.y||n.y<t.y?t.y:n.y})),a.x-=50,a.y-=50,n.x+=50,n.y+=50,t.attr("width",Math.abs(n.x-a.x)).attr("height",Math.abs(n.y-a.y)).attr("style","position:absolute; left: "+a.x+"px; top: "+a.y+"px;"),l().each(this._markers,(function(){var n=e.fromLatLngToDivPixel(this.options.position);t.append("path").attr("d",this.options.icon.path).attr("fill",this.options.icon.fillColor).style("opacity",this.options.icon.fillOpacity).attr("stroke",this.options.icon.strokeColor).style("stroke-opacity",this.options.icon.strokeOpacity).attr("transform",(function(e){return"translate("+(n.x-a.x)+", "+(n.y-a.y)+")"}))}));else{console.log("FastMarker not ready need redraw.");var s=this;window.setTimeout((function(){s._draw.call(s)}),5e3)}},c.prototype.setMap=function(e){var t;null!=e?(i.has(e)?t=i.get(e):(t=new r(e),i.set(e,t)),this.Layer=t,this.Map=e,t.addMarker.call(this.Layer,this)):this.Layer&&this.Map&&(this.Layer.removeMarker.call(this.Layer,this),this.Map=null)};var i={keys:[],values:{},set:function(e,t){var a=this.keys.indexOf(e);a>-1?this.values[a+""]=t:(this.keys.push(e),this.values[this.keys.length-1+""]=t)},get:function(e){var t=this.keys.indexOf(e);return t>-1?this.values[t+""]:null},has:function(e){return this.keys.indexOf(e)>-1},delete:function(e){var t=this.keys.indexOf(e);t>-1&&(this.keys=this.keys.splice(t,1),delete this.values[t+""])}};function r(e){this.setMap(e),this._markers=[]}function c(e){if(this.options=e,this.options&&this.options.position&&(this.options.position=new google.maps.LatLng(this.options.position.lat,this.options.position.lng)),e&&e.map){var t=e.map;this.setMap(t)}}const u=c},8481:(e,t,a)=>{"use strict";var n=a(3609),s=a.n(n),o=a(2316),l=a.n(o),i=a(7588),r=a.n(i),c=a(3935),u=a.n(c),m=a(3360),p=a.n(m),d=a(6486),h=a(6624),g=a.n(h);const f=l().Router.extend({routes:{campaign:"defaultAction",distribution:"distributionAction",monitor:"monitorAction","campaign/:campaignId/monitor":"campaignMonitorAction","driver/:campaignId":"driverMonitorAction",report:"reportAction","report/:taskId":"reportAction",admin:"adminAction","admin/gtu":"availableGTUAction","print/:campaignId/:printType":"printAction","campaign/:campaignId/:taskName/:taskId/edit":"gtuEditAction","campaign/:campaignId/:taskName/:taskId/monitor":"gtuMonitorAction","campaign/import":"importCampaign","frame/:page":"frameAction","frame/*page?*queryString":"frameAction","*actions":"defaultAction"},defaultAction:function(){var e=a(2300).Z,t=a(4018).Z,n=new e;n.fetch().then((()=>{p().publish({channel:"View",topic:"loadView",data:{view:t,params:{collection:n}}})}))},frameAction:function(e,t){var a="../"+e;t&&(a+="?"+t),window.open(a,"_blank","resizable=yes,status=yes,toolbar=no,scrollbars=yes,menubar=no,location=no"),l().history.history.back(-2)},distributionAction:function(){let e=a(2300).Z,t=a(3321).Z,n=new e;n.fetchForDistribution().then((()=>{p().publish({channel:"View",topic:"loadView",data:{view:t,params:{collection:n}}})}))},monitorAction:function(){let e=a(2300).Z,t=a(1952).Z,n=new e;n.fetchForTask().then((()=>{p().publish({channel:"View",topic:"loadView",data:{view:t,params:{collection:n}}})}))},gtuMonitorAction:function(e,t,n){let s=a(594).Z,o=a(1859).Z,l=a(8552).Z,i=a(3179).Z,r=new l,c=new s({Id:n});c.fetch().then((()=>{let e=new o({CampaignId:c.get("CampaignId"),SubMapId:c.get("SubMapId"),DMapId:c.get("DMapId")});g().all([e.fetchBoundary(),e.fetchAllGtu(),r.fetchGtuWithStatusByTask(n)]).then((()=>{let t=`GTU Monitor - ${c.get("ClientName")}, ${c.get("ClientCode")}: ${c.get("Name")}`;p().publish({channel:"View",topic:"loadView",data:{view:i,params:{dmap:e,gtu:r,task:c}},options:{showMenu:!1,showUser:!1,showSearch:!1,pageTitle:t}})}))}))},driverMonitorAction:function(e){var t=a(3709).Z,n=a(1149).Z,s=a(5724).Z,o=new n,l=new s;o.loadWithAllTask(e).then((()=>new(g())(((e,t)=>{let a=!0;if(o.get("Tasks").each((e=>{if(0==e.get("IsFinished"))return a=!1,!1})),a)throw new OperationalError("task is closed");return e()})).then((()=>{p().publish({channel:"View",topic:"loadView",data:{view:t,params:{model:o,geo:l},options:{showMenu:!1,showUser:!1,showSearch:!1,pageTitle:"GTU Campaign Monitor"}}})})).catch((e=>{let t=a(6211).Z;p().publish({channel:"View",topic:"loadView",data:{view:t,options:{showMenu:!1,showUser:!1,showSearch:!1,pageTitle:"GTU Campaign Monitor"}}})}))))},campaignMonitorAction:function(e){var t=a(7269).Z,n=a(1149).Z,s=a(5724).Z,o=new n,l=new s;o.loadWithAllTask(e).then((()=>{p().publish({channel:"View",topic:"loadView",data:{view:t,params:{model:o,geo:l},options:{showMenu:!1,showUser:!0,showSearch:!1,pageTitle:"GTU Campaign Monitor"}}})}))},reportAction:function(e){a(1149).Z;let t=a(2300).Z,n=a(8664).Z,s=new t;s.fetchForReport().then((()=>{p().publish({channel:"View",topic:"loadView",data:{view:n,params:{collection:s,taskId:e}}})}))},adminAction:function(){let e=a(7434).Z;p().publish({channel:"View",topic:"loadView",data:{view:e}})},importCampaign:function(){let e=a(2300).Z,t=a(2413).Z;p().publish({channel:"View",topic:"loadView",data:{view:t,params:{collection:new e}}})},printAction:function(e,t){switch(t){case"campaign":var n=a(1474).Z,s=a(9686).Z;(o=new n).fetchForCampaignMap(e).then((()=>{p().publish({channel:"View",topic:"loadView",data:{view:s,params:{collection:o},options:{showMenu:!1,showUser:!1,showSearch:!1,pageTitle:"Timm Print Preview"}}})}));break;case"distribution":n=a(1474).Z,s=a(3942).Z,(o=new n).fetchForDistributionMap(e).then((()=>{p().publish({channel:"View",topic:"loadView",data:{view:s,params:{collection:o},options:{showMenu:!1,showUser:!1,showSearch:!1,pageTitle:"Timm Print Preview"}}})}));break;case"report":var o;n=a(1474).Z,s=a(2598).Z,(o=new n).fetchForReportMap(e).then((()=>{p().publish({channel:"View",topic:"loadView",data:{view:s,params:{collection:o},options:{showMenu:!1,showUser:!1,showSearch:!1,pageTitle:"Timm Print Preview"}}})}))}},gtuEditAction:function(e,t,n){let s=a(594).Z,o=a(1859).Z,l=a(8552).Z,i=a(5230).Z,r=new l,c=new s({Id:n});c.fetch().then((()=>{let e=new o({CampaignId:c.get("CampaignId"),SubMapId:c.get("SubMapId"),DMapId:c.get("DMapId")});g().all([e.fetchBoundary(),e.fetchGtuForEdit(),r.fetchByTask(n)]).then((()=>{p().publish({channel:"View",topic:"loadView",data:{view:i,params:{dmap:e,gtu:r,task:c}}})}))}))},availableGTUAction:function(){let e=a(8552).Z,t=a(9522).Z,n=new e;n.fetch().then((()=>{p().publish({channel:"View",topic:"loadView",data:{view:t,params:{collection:n},options:{showSearch:!1}}})}))}});var v=a(189),y=(a(456),a(4184)),E=a.n(y),b=a(8896);function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var N=r().createClass({displayName:"MenuItem",mixins:[b.Z],getInitialState:function(){return{active:!1}},getDefaultProps:function(){return{address:null,icon:null,name:null}},render:function(){return r().createElement("li",null,r().createElement("a",{className:this.state.active?"active":"",href:"#"+this.props.address},r().createElement("i",{className:this.props.icon}),r().createElement("span",{className:"menu-text"}," ",this.props.name)))}});const C=r().createClass({displayName:"menu",mixins:[b.Z],getInitialState:function(){return{open:!1}},getDefaultProps:function(){return{menu:[{key:"campaign",icon:"fa fa-trophy",address:"campaign",name:"Campaign"},{key:"distribution",icon:"fa fa-map",address:"distribution",name:"Distribution Maps"},{key:"monitor",icon:"fa fa-truck",address:"monitor",name:"GPS Monitor"},{key:"report",icon:"fa fa-file-pdf-o",address:"report",name:"Reports"}]}},closeMenu:function(){this.setState({open:!1})},switch:function(){this.setState({open:!this.state.open})},render:function(){var e=E()({sidebar:!0,"off-canvas":!0,"position-left":!0,"is-open":this.state.open});return r().createElement("div",{className:e,"data-off-canvas":!0,"data-position":"left"},r().createElement("ul",{className:"menu vertical",onClick:this.closeMenu},this.props.menu.map((function(e){return r().createElement(N,M({key:e.key},e))})),r().createElement("li",null,r().createElement("a",{href:"#admin"},r().createElement("i",{className:"fa fa-gear"}),r().createElement("span",{className:"menu-text"},"  Administration")),r().createElement("ul",{className:"submenu menu vertical"},r().createElement("li",null,r().createElement("a",{href:"#frame/Users.aspx"},r().createElement("span",{className:"menu-text"},"User Management"))),r().createElement("li",null,r().createElement("a",{href:"#frame/NonDeliverables.aspx"},r().createElement("span",{className:"menu-text"},"Non-Deliverables"))),r().createElement("li",null,r().createElement("a",{href:"#frame/GtuAdmin.aspx?AssignNameToGTUFlag=true"},r().createElement("span",{className:"menu-text"},"GTU Management"))),r().createElement("li",null,r().createElement("a",{href:"#frame/AvailableGTUList.aspx"},r().createElement("span",{className:"menu-text"},"GTU Available List"))),r().createElement("li",null,r().createElement("a",{href:"#frame/AdminGtuToBag.aspx"},r().createElement("span",{className:"menu-text"},"GTU bag Management "))),r().createElement("li",null,r().createElement("a",{href:"#frame/AdminGtuBagToAuditor.aspx"},r().createElement("span",{className:"menu-text"},"Assign GTU-Bags to Auditors"))),r().createElement("li",null,r().createElement("a",{href:"#frame/AdminDistributorCompany.aspx"},r().createElement("span",{className:"menu-text"},"Distributor Management")))))))}}),w=r().createBackboneClass({mixins:[b.Z],componentDidMount:function(){$("#userMenu").foundation()},onLogout:function(){this.getModel().logout().always((function(){window.location.reload(!0)}))},render:function(){return this.getModel(),r().createElement("div",{className:"title-bar-right"},r().createElement("a",{href:"javascript:;",onClick:this.onLogout},r().createElement("span",{className:"hide-for-small-only"},r().createElement("small",null,"Welcome, ",this.getModel().get("FullName"),"  ")),r().createElement("i",{className:"fa fa-sign-out",style:{position:"relative",top:"2px"}})))}});var k=a(4241);const D=r().createBackboneClass({mixins:[b.Z,r().BackboneMixin("user","change:FullName")],getInitialState:function(){return{mainView:null,mainParams:null,dialogView:null,dialogParams:null,dialogSize:"small",dialogCustomClass:"",dialogModalView:null,dialogModalParams:null,dialogModalSize:"small",dialogModalCustomClass:"",loading:!1,pageTitle:"TIMM System",showMenu:null,showSearch:null,showUser:null,fullTextSearchTimeout:null}},componentDidMount:function(){var e=this;this.subscribe("loadView",(function(t){e.setState({mainView:t.view,mainParams:t.params});var a=t.options;e.setState({pageTitle:(0,d.has)(a,"pageTitle")?a.pageTitle:"TIMM System",showMenu:!(0,d.has)(a,"showMenu")||a.showMenu,showSearch:!(0,d.has)(a,"showSearch")||a.showSearch,showUser:!(0,d.has)(a,"showUser")||a.showUser})})),this.subscribe("showDialog",(function(t){if(t){e.setState({dialogView:t.view,dialogParams:t.params});var a=t.options;e.setState({dialogSize:(0,d.has)(a,"size")?a.size:"small",dialogCustomClass:(0,d.has)(a,"customClass")?a.customClass:""})}else e.setState({dialogView:null,dialogParams:null,dialogSize:null,dialogCustomClass:null})})),this.subscribe("showDialogModal",(function(t){if(t){e.setState({dialogModalView:t.view,dialogModalParams:t.params});var a=t.options;e.setState({dialogModalSize:(0,d.has)(a,"size")?a.size:"small",dialogModalCustomClass:(0,d.has)(a,"customClass")?a.customClass:""})}else e.setState({dialogModalView:null,dialogModalParams:null,dialogModalSize:null,dialogModalCustomClass:null})}));var t=0,a=null;this.subscribe("showLoading",(function(){t++,window.clearTimeout(a),a=window.setTimeout((function(){e.setState({loading:!0})}),500)})),this.subscribe("hideLoading",(function(){t--,window.setTimeout((function(){t<=0&&(window.clearTimeout(a),e.setState({loading:!1}),t=0)}),300)})),s()(window).on("resize",(function(){s()(".off-canvas-wrapper-inner").height(s()(window).height()),e.publish("Global.Window.Resize",{width:s()(window).width(),height:s()(window).height()})})),s()(window).trigger("resize"),s()(window).on("click",(function(){e.publish("Global.Window.Click")}))},componentDidUpdate:function(e,t){var a=!1;this.state.dialogView&&Foundation?(s()(".dialog").foundation(),s()(".dialog").foundation("open"),a=!0):(s()(".dialog").foundation(),s()(".dialog").foundation("close")),this.state.dialogModalView&&Foundation?(s()(".dialogModal").foundation(),s()(".dialogModal").foundation("open"),a=!0):(s()(".dialogModal").foundation(),s()(".dialogModal").foundation("close")),a||s()("body").removeClass("is-reveal-open"),s()("iframe").height(s()(window).height())},fullTextSearch:function(e){var t=this;clearTimeout(this.state.fullTextSearchTimeout);var a=e.currentTarget.value;this.state.fullTextSearchTimeout=setTimeout((function(){t.publish({channel:"View",topic:"search",data:a})}),500)},menuSwitch:function(){this.refs.sideMenu&&this.refs.sideMenu.switch()},getMainView:function(){return this.state.mainView?r().isValidElement(this.state.mainView)?this.state.mainView:r().createFactory(this.state.mainView)(this.state.mainParams):null},onCloseDialog:function(){this.publish("showDialog")},onCloseDialogModal:function(){this.publish("showDialogModal")},getDialogView:function(e,t,a){if(e){if((0,d.isString)(e)){var n=e;return r().createElement("div",{className:"row"},r().createElement("div",{className:"small-12 columns"},r().createElement("p",null," "),r().createElement("h5",null,n),r().createElement("p",null," ")),r().createElement("div",{className:"small-12 columns"},r().createElement("div",{className:"button-group float-right"},r().createElement("a",{href:"javascript:;",className:"button tiny",onClick:a},"Okay"))),r().createElement("button",{onClick:a,className:"close-button","data-close":!0,"aria-label":"Close reveal",type:"button"},r().createElement("span",{"aria-hidden":"true"},"×")))}return r().isValidElement(e)?e:r().createFactory(e)((0,d.extend)(t,{ref:"DialogView"}))}return null},render:function(){this.getModel();var e=this.getMainView(),t=this.getDialogView(this.state.dialogView,this.state.dialogParams,this.onCloseDialog),a=E()("reveal dialog ".concat(this.state.dialogSize," ").concat(this.state.dialogCustomClass),{hide:null==t}),n=this.getDialogView(this.state.dialogModalView,this.state.dialogModalParams,this.onCloseDialogModal),s=E()("reveal dialogModal ".concat(this.state.dialogModalSize," ").concat(this.state.dialogModalCustomClass),{hide:null==n});if(!0===this.state.showMenu)var o="left-menu",l=r().createElement(C,{ref:"sideMenu"});else o="",l=null;if(!0===this.state.showSearch)var i=r().createElement("span",{className:"title-bar-center"},r().createElement("div",{className:"topSearchBar hide-for-small-only"},r().createElement("input",{type:"text",placeholder:"Search",onChange:this.fullTextSearch})));else i=null;if(!0===this.state.showUser)var c=r().createElement(w,{model:this.props.user});else c=null;var u=this.state.loading?"block":"none";return r().createElement("div",null,l,r().createElement("div",{className:"main off-canvas-content "+o,"data-off-canvas-content":!0},r().createElement("div",{className:"title-bar"},r().createElement("div",{className:"title-bar-left"},r().createElement("button",{"aria-expanded":"true",className:"menu-icon",type:"button",onClick:this.menuSwitch}),r().createElement("span",{className:"title-text"},this.state.pageTitle)),c,i),e,r().createElement("div",{id:"google-map-wrapper"},r().createElement("div",{id:"google-map",className:"google-map"}))),r().createElement("div",{key:"dialog",className:a,"data-reveal":!0,"data-options":"closeOnClick: false; closeOnEsc: false;"},t),r().createElement("div",{key:"dialogModal",className:s,"data-reveal":!0,"data-options":"closeOnClick: false; closeOnEsc: false;"},n),r().createElement("div",{className:"overlayer",style:{display:u}},r().createElement(k.Z,null)))}});s()(document).ajaxSend((function(e,t,a){!0!==a.quite&&p().publish({channel:"View",topic:"showLoading"})})),s()(document).ajaxComplete((function(e,t,a){!0!==a.quite&&p().publish({channel:"View",topic:"hideLoading"})}));var I=l().sync;l().sync=function(e,t,a){return a.url||(a.url=(0,d.isFunction)(t.url)?t.url():t.url),a.url||(a.url=t.urlRoot),a.url="../api/"+a.url,"undefined"!=typeof RELEASE_VERSION&&(a.url="//timm.vargainc.com/"+RELEASE_VERSION+"/api/"+a.url),I(e,t,a)},new f;var S=new v.Z;S.fetchCurrentUser().then((function(e){if(!e&&!(0,d.startsWith)(window.location.hash,"#driver"))return window.location="../login.html",g().reject();var t=r().createFactory(D)({user:S});return u().render(t,document.getElementById("main-container")),(new f).on("route",(function(){})),l().history.start(),g().resolve()}))},1149:(e,t,a)=>{"use strict";a.d(t,{Z:()=>u});var n=a(2316),s=a.n(n),o=a(3609),l=a.n(o),i=(a(6624),a(6486)),r=a(594);const c=s().Collection.extend({model:r.Z}),u=s().Model.extend({urlRoot:"campaign",idAttribute:"Id",defaults:{AreaDescription:null,ClientCode:null,ClientName:null,ContactName:null,CreatorName:null,CustemerName:null,Date:null,Description:null,Id:null,Name:null,Sequence:0,UserName:null},getDisplayName:function(){return this.get("ClientCode")+"-"+this.get("CreatorName")+"-"+this.get("AreaDescription")},copy:function(e){var t={method:"POST",url:this.urlRoot+"/copy/"+this.get("Id")};return(0,i.extend)(t,e),(this.sync||s().sync).call(this,"create",this,t)},publishToDMap:function(e,t){var a={url:this.urlRoot+"/"+this.get("Id")+"/publish/",method:"PUT",processData:!0,data:l().param({"":e.get("Id")})};return a=(0,i.extend)(t,a),(this.sync||s().sync).call(this,"update",this,a)},dismissToCampaign:function(e,t){var a={url:this.urlRoot+"/"+this.get("Id")+"/dismiss/",method:"PUT",processData:!0,data:l().param({"":e.get("Id")})};return a=(0,i.extend)(t,a),(this.sync||s().sync).call(this,"update",this,a)},publishToMonitor:function(e,t){var a={url:this.urlRoot+"/"+this.get("Id")+"/monitor/",method:"PUT",processData:!0,data:l().param({"":e.get("Id")})};return a=(0,i.extend)(t,a),(this.sync||s().sync).call(this,"update",this,a)},dismissToDMap:function(e,t){var a={url:this.urlRoot+"/"+this.get("Id")+"/dismiss/",method:"PUT",processData:!0,data:l().param({"":e.get("Id")})};return a=(0,i.extend)(t,a),(this.sync||s().sync).call(this,"update",this,a)},loadWithAllTask:function(e){var t=this;return(this.sync||s().sync).call(this,"read",this,{url:`campaign/${e}/tasks/all`}).then((e=>{var a=new c;a.set(e.Tasks),e.Tasks=a,t.set(e)}))}})},7315:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var n=a(2316);const s=a.n(n)().Model.extend({})},1859:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var n=a(2316),s=a.n(n),o=a(7315),l=a(3609),i=a.n(l),r=(a(6624),a(6486));const c=o.Z.extend({urlRoot:"map",idAttribute:"key",defaults:{Id:null,Name:null,Total:null,DisplayName:null,MapImage:null,PolygonImage:null,ImageStatus:"waiting"},fetchMapImage:function(e){var t=this,a=i().extend({mapType:"HYBRID"},e,{campaignId:t.get("CampaignId"),submapId:t.get("SubMapId"),dmapId:t.get("DMapId")}),n={quite:!0,url:t.urlRoot+"/dmap/",method:"POST",processData:!0,data:i().param(a),success:function(e){var a=null,n=null;e&&e.success&&(a=e.tiles,n=e.geometry),t.set("MapImage",a,{silent:!0}),t.set("PolygonImage",n,{silent:!0})}};return t.get("TopRight")&&t.get("BottomLeft")&&(n.data=i().param(i().extend(a,{topRightLat:t.get("TopRight").lat,topRightLng:t.get("TopRight").lng,bottomLeftLat:t.get("BottomLeft").lat,bottomLeftLng:t.get("BottomLeft").lng}))),(this.sync||s().sync).call(this,"update",this,n)},fetchBoundary:function(e){var t=this,a={url:"print/campaign/"+t.get("CampaignId")+"/submap/"+t.get("SubMapId")+"/dmap/"+t.get("DMapId")+"/boundary/",method:"GET",success:e=>{t.set({Boundary:e.boundary,Color:e.color})}};return(0,r.extend)(a,e),(this.sync||s().sync).call(this,"read",this,a)},fetchGtu:function(e){var t=this,a={url:"print/campaign/"+t.get("CampaignId")+"/submap/"+t.get("SubMapId")+"/dmap/"+t.get("DMapId")+"/gtu/",method:"GET",success:function(e){for(var a=[],n=0;n<e.pointsColors.length;n++)e.points[n]&&e.points[n].length>0&&a.push({gtuId:e.points[n][0].Id,color:e.pointsColors[n],points:e.points[n]});t.set({Gtu:a,lastUpdateTime:e.lastUpdateTime})}};return(0,r.extend)(a,e),(this.sync||s().sync).call(this,"read",this,a)},fetchGtuForEdit:function(e){var t=this,a={url:"print/campaign/"+t.get("CampaignId")+"/submap/"+t.get("SubMapId")+"/dmap/"+t.get("DMapId")+"/gtu/foredit",method:"GET",success:function(e){for(var a=[],n=0;n<e.pointsColors.length;n++)e.points[n]&&e.points[n].length>0&&a.push({gtuId:e.points[n][0].Id,color:e.pointsColors[n],points:e.points[n]});t.set({Gtu:a,lastUpdateTime:e.lastUpdateTime})}};return(0,r.extend)(a,e),(this.sync||s().sync).call(this,"read",this,a)},fetchAllGtu:function(e){var t=this,a={url:"print/campaign/"+t.get("CampaignId")+"/submap/"+t.get("SubMapId")+"/dmap/"+t.get("DMapId")+"/gtu/all/",method:"GET",success:function(e){for(var a=[],n=0;n<e.pointsColors.length;n++)e.points[n]&&e.points[n].length>0&&a.push({gtuId:e.points[n][0].Id,color:e.pointsColors[n],points:e.points[n]});t.set({Gtu:a,lastUpdateTime:e.lastUpdateTime})}};return(0,r.extend)(a,e),(this.sync||s().sync).call(this,"read",this,a)},updateGtuAfterTime:function(e,t){var a=this,n=e?e.utc().format("YYYYMMDDTHHmmss[Z]"):a.get("lastUpdateTime"),o={url:"print/campaign/"+a.get("CampaignId")+"/submap/"+a.get("SubMapId")+"/dmap/"+a.get("DMapId")+"/gtu/all/"+n,method:"GET",success:function(e){for(var t=a.get("Gtu")||[],n=0;n<e.pointsColors.length;n++){var s=(0,r.find)(t,{color:e.pointsColors[n]});s?s.points=(0,r.concat)(s.points,e.points[n]):t.push({color:e.pointsColors[n],points:e.points[n]})}a.set({lastUpdateTime:e.lastUpdateTime})}};return(0,r.extend)(o,t),(this.sync||s().sync).call(this,"read",this,o)}})},4247:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n}),a(2316);const n=a(7315).Z.extend({urlRoot:"map",defaults:{suppressCover:!0,suppressCampaign:!0,suppressCampaignSummary:!0,suppressNDAInCampaign:!0,suppressSubMap:!0,suppressSubMapCountDetail:!0,suppressNDAInSubMap:!0,suppressDMap:!1,suppressGTU:!0,suppressNDAInDMap:!0,customSubMapPenetrationColors:!1,suppressLocations:!0,suppressRadii:!0}})},594:(e,t,a)=>{"use strict";a.d(t,{Z:()=>u});var n=a(2316),s=a.n(n),o=a(3609),l=a.n(o),i=a(6624),r=a.n(i),c=a(6486);const u=s().Model.extend({urlRoot:"task",idAttribute:"Id",defaults:{Id:null,Name:null,Date:null,Status:null,Telephone:null,Email:null,DistributionMapId:null,AuditorId:null,AuditorName:null,DistributionMapId:null},markFinished:function(e){var t={url:this.urlRoot+"/"+this.get("Id")+"/finish/",method:"PUT"};return t=(0,c.extend)(e,t),(this.sync||s().sync).call(this,"update",this,t)},reOpen:function(e){var t={url:this.urlRoot+"/"+this.get("Id")+"/reopen/",method:"PUT"};return t=(0,c.extend)(e,t),(this.sync||s().sync).call(this,"update",this,t)},importGtu:function(e,t){var a=this,n={url:"../api/"+a.urlRoot+"/"+a.get("Id")+"/import/",method:"PUT"};n=(0,c.extend)(t,n);var s=new XMLHttpRequest,o=new FormData;s.open(n.method,n.url,!0),s.onreadystatechange=()=>{4==s.readyState&&200==s.status&&n.success&&n.success.call(a,JSON.parse(s.responseText))},o.append("gtuFile",e),s.send(o)},addGtuDots:function(e,t){var a={url:this.urlRoot+"/"+this.get("Id")+"/dots/",method:"POST",data:e,data:l().param({"":e})};return a=(0,c.extend)(t,a),(this.sync||s().sync).call(this,"",this,a).then((e=>e&&e.success?r().resolve():r().reject()))},removeGtuDots:function(e,t){var a={url:this.urlRoot+"/"+this.get("Id")+"/dots/",method:"PUT",data:l().param({"":e})};return a=(0,c.extend)(t,a),(this.sync||s().sync).call(this,"",this,a).then((e=>e&&e.success?r().resolve():r().reject()))},setStart:function(e){var t=this,a={url:t.urlRoot+"/"+t.get("Id")+"/start/",method:"PUT",success:function(e){e&&e.success&&t.set({Status:e.status})}};return a=(0,c.extend)(e,a),(this.sync||s().sync).call(this,"update",this,a)},setPause:function(e){var t=this,a={url:t.urlRoot+"/"+t.get("Id")+"/pause/",method:"PUT",success:e=>{e&&e.success&&t.set({Status:e.status})}};return a=(0,c.extend)(e,a),(this.sync||s().sync).call(this,"update",this,a)},setStop:function(e){var t=this,a={url:t.urlRoot+"/"+t.get("Id")+"/stop/",method:"PUT",success:function(e){e&&e.success&&t.set({Status:e.status})}};return a=(0,c.extend)(e,a),(this.sync||s().sync).call(this,"update",this,a)},mergeFrom:function(e){var t={url:`${this.urlRoot}/merge/${e}/to/${this.get("Id")}`,method:"GET"};return(this.sync||s().sync).call(this,"",this,t).then((e=>e&&e.success?r().resolve():r().reject()))}})},189:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var n=a(2316),s=a.n(n),o=(a(3609),a(6624)),l=a.n(o),i=a(6486);const r=s().Model.extend({urlRoot:"user",idAttribute:"Id",defaults:{Id:null,UserCode:null,UserName:null,FullName:null,Emai:null,Token:null},fetchCurrentUser:function(e){var t=this,a={url:t.urlRoot+"/info",type:"GET"};return(0,i.extend)(a,e),new(l())(((e,n)=>(this.sync||s().sync).call(this,"read",this,a).then((a=>a&&a.success?(t.set(a.data),e(!0)):e(!1)))))},addEmployee:function(e,t){var a=this,n={url:"../api/"+a.urlRoot+"/employee/",method:"POST"};return n=(0,i.extend)(t,n),new(l())(((t,s)=>{var o=new XMLHttpRequest,l=new FormData;o.open(n.method,n.url,!0),o.onreadystatechange=()=>{if(4==o.readyState){if(200==o.status){var e=JSON.parse(o.responseText);return a.set(e),n.success&&n.success.call(a,e),t()}return s(new Error("xhr states not OK"))}},l.append("Picture",e),l.append("CompanyId",a.get("CompanyId")),l.append("Role",a.get("Role")),l.append("FullName",a.get("FullName")),l.append("CellPhone",a.get("CellPhone")),l.append("DateOfBirth",a.get("DateOfBirth")),l.append("Notes",a.get("Notes")),o.send(l)}))},logout:function(e){var t={url:this.urlRoot+"/logout",type:"POST"};return(0,i.extend)(t,e),(this.sync||s().sync).call(this,null,this,t)}})},8300:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var n=a(3609),s=a.n(n),o=a(6486),l=(a(8573),window.GoogleMap),i=window.GoogleItems||[];const r={getGoogleMap:function(){return l},getGoogleItems:function(){return i},showMap:function(){s()("#google-map-wrapper").css({visibility:"visible"}),google.maps.event.trigger(l,"resize")},hideMap:function(){s()("#google-map-wrapper").css({visibility:"hidden"}),google.maps.event.trigger(l,"resize")},setMapHeight:function(e){s()("#google-map-wrapper").height(e),google.maps.event.trigger(l,"resize")},componentWillUnmount:function(){console.log("map base clearMap");try{(0,o.each)(i,(function(e){e&&e.setMap&&e.setMap(null)})),google.maps.event.clearInstanceListeners(l)}catch(e){console.log("google map clear error",e)}s()("#google-map-wrapper").css({visibility:"hidden"})},componentDidMount:function(){console.log("init google map");var e=this.state.mapType&&google.maps.MapTypeId[this.state.mapType]?google.maps.MapTypeId[this.state.mapType]:google.maps.MapTypeId.ROADMAP,t=!!(0,o.has)(this.state,"disableDefaultUI")&&this.state.disableDefaultUI,a=!(0,o.has)(this.state,"scrollwheel")||this.state.scrollwheel,n=!!(0,o.has)(this.state,"disableDoubleClickZoom")&&this.state.disableDoubleClickZoom;this.state.mapStyle?s()("#google-map-wrapper").css(this.state.mapStyle):s()("#google-map-wrapper").css({visibility:"visible",position:"",width:"",height:"",left:"",top:"",right:"",bottom:""}),l?(l.setMapTypeId(e),l.setOptions({disableDefaultUI:t,streetViewControl:!1,scrollwheel:a,disableDoubleClickZoom:n,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP}})):l=new google.maps.Map(s()("#google-map")[0],{center:new google.maps.LatLng(40.744556,-73.987378),zoom:18,disableDefaultUI:t,streetViewControl:!1,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},scrollwheel:a,disableDoubleClickZoom:n,mapTypeId:e}),google.maps.event.trigger(l,"resize")}}},3609:e=>{"use strict";e.exports=jQuery}},e=>{"use strict";e.O(0,[216],(()=>(8481,e(e.s=8481)))),e.O()}]);